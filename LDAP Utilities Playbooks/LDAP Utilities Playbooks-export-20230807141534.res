{"action_order": [], "actions": [], "apps": [], "automatic_tasks": [], "export_date": 1691432134970, "export_format_version": 2, "export_type": null, "fields": [{"export_key": "incident/internal_customizations_field", "id": 0, "input_type": "text", "internal": true, "name": "internal_customizations_field", "read_only": true, "text": "Customizations Field (internal)", "type_id": 0, "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"}], "functions": [], "geos": null, "groups": null, "id": 34, "inbound_destinations": [], "inbound_mailboxes": null, "incident_artifact_types": [], "incident_types": [{"update_date": 1691432132864, "create_date": 1691432132864, "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0", "description": "Customization Packages (internal)", "export_key": "Customization Packages (internal)", "name": "Customization Packages (internal)", "enabled": false, "system": false, "parent_id": null, "hidden": false, "id": 0}], "industries": null, "layouts": [], "locale": null, "message_destinations": [], "notifications": null, "overrides": null, "phases": [], "playbooks": [{"activation_type": "manual", "content": {"content_version": 1, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d\" isExecutable=\"true\" name=\"playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_1dftxtl</outgoing></startEvent><serviceTask id=\"ServiceTask_1\" name=\"LDAP Utilities: Search\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"892075c1-64ba-46c9-aba1-f1f1aa040bb7\">{\"inputs\":{},\"pre_processing_script\":\"\\\"\\\"\\\"\\nThis LDAP Script is used to search a single domain LDAP. If you have more than 1 domain set the following variable:\\ninputs.ldap_domain_name = '&lt;DomainName in Config&gt;'\\n\\nYou will also need to set the ldap_search_base to the domain of your LDAP server (I have a template of how that should look already).\\n\\nIf you want to add any LDAP Attributes to your list you will need to add them as well as any additional filters.\\n\\\"\\\"\\\"\\n\\ninputs.ldap_search_param = artifact.value\\ninputs.ldap_search_attributes = 'SamAccountName,cn,title,department,mail,physicalDeliveryOfficeName,manager'\\ninputs.ldap_search_base = 'DC=Domain,DC=Com'\\ninputs.ldap_search_filter = '(&amp;(objectclass=user)(|(SamAccountName=%ldap_param%)(mail=%ldap_param%)))'\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"search_output\"}</resilient:function></extensionElements><incoming>Flow_1dftxtl</incoming><outgoing>Flow_0a7sujd</outgoing></serviceTask><serviceTask id=\"ServiceTask_2\" name=\"LDAP Utilities: Set Password\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"b75c2ee2-759b-4d01-9649-6ec46f6a646e\">{\"inputs\":{},\"pre_processing_script\":\"# Once the LDAP Utilities: Search completes, get the DN of the first entry\\n# which will be the DN of the account you want to set a Set a New Password for\\n\\ninputs.ldap_dn = playbook.functions.results.search_output.content[0][\\\"dn\\\"]\\ninputs.ldap_new_password = playbook.inputs.ldap_user_new_password\\ninputs.ldap_new_auto_password_len = playbook.inputs.ldap_new_auto_password_length\\ninputs.ldap_return_new_password = playbook.inputs.ldap_return_new_password\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"password_output\"}</resilient:function></extensionElements><incoming>Flow_06hw6fn</incoming><outgoing>Flow_1567wuc</outgoing></serviceTask><exclusiveGateway default=\"Flow_1ww79nh\" id=\"ConditionPoint_3\" resilient:documentation=\"Search Success\"><extensionElements/><incoming>Flow_0a7sujd</incoming><outgoing>Flow_06hw6fn</outgoing><outgoing>Flow_1ww79nh</outgoing></exclusiveGateway><sequenceFlow id=\"Flow_1dftxtl\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/><sequenceFlow id=\"Flow_0a7sujd\" sourceRef=\"ServiceTask_1\" targetRef=\"ConditionPoint_3\"/><endEvent id=\"EndPoint_4\" resilient:documentation=\"End point\"><incoming>Flow_1ww79nh</incoming><incoming>Flow_18zw2es</incoming></endEvent><scriptTask id=\"ScriptTask_5\" name=\"Password Output Parser\"><extensionElements><resilient:script uuid=\"a6bd6035-fc1e-498b-b7ce-421f2ce67157\"/></extensionElements><incoming>Flow_1567wuc</incoming><outgoing>Flow_18zw2es</outgoing><script>script</script></scriptTask><sequenceFlow id=\"Flow_1567wuc\" sourceRef=\"ServiceTask_2\" targetRef=\"ScriptTask_5\"/><sequenceFlow id=\"Flow_18zw2es\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_4\"/><sequenceFlow id=\"Flow_06hw6fn\" name=\"Search Successful\" sourceRef=\"ConditionPoint_3\" targetRef=\"ServiceTask_2\"><extensionElements><resilient:condition label=\"Search Successful\" order=\"0\"/></extensionElements><conditionExpression language=\"resilient-conditions\" xsi:type=\"tFormalExpression\">{\"conditions\":[{\"evaluation_id\":null,\"field_name\":null,\"method\":\"script\",\"type\":null,\"value\":{\"script_text\":\"# One line example:\\n#\\n# result = incident.employee_involved = True\\n#\\n# Multi-line example:\\n#\\n# certificate_expired = playbook.functions.results.certificate_results.is_expired\\n# if (incident.employee_involved == True and certificate_expired):\\n#     result = True\\n# else:\\n#     result = False\\n\\nif playbook.functions.results.search_output['success']:\\n  result = True\\nelse:\\n  result = False\\n\",\"final_expression_text\":\"result\",\"final_expression_only_boolean\":true,\"language\":\"python3\"}}],\"logic_type\":\"all\",\"script_language\":null}</conditionExpression></sequenceFlow><sequenceFlow id=\"Flow_1ww79nh\" name=\"Else\" sourceRef=\"ConditionPoint_3\" targetRef=\"EndPoint_4\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_1dftxtl\" id=\"Flow_1dftxtl_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"228\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0a7sujd\" id=\"Flow_0a7sujd_di\"><omgdi:waypoint x=\"721\" y=\"312\"/><omgdi:waypoint x=\"721\" y=\"404\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_06hw6fn\" id=\"Flow_06hw6fn_di\"><omgdi:waypoint x=\"721\" y=\"456\"/><omgdi:waypoint x=\"721\" y=\"598\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"27\" width=\"58\" x=\"721\" y=\"524\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1ww79nh\" id=\"Flow_1ww79nh_di\"><omgdi:waypoint x=\"843\" y=\"430\"/><omgdi:waypoint x=\"970\" y=\"430\"/><omgdi:waypoint x=\"970\" y=\"960\"/><omgdi:waypoint x=\"787\" y=\"960\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"14\" width=\"22\" x=\"974\" y=\"692\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1567wuc\" id=\"Flow_1567wuc_di\"><omgdi:waypoint x=\"721\" y=\"682\"/><omgdi:waypoint x=\"721\" y=\"758\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_18zw2es\" id=\"Flow_18zw2es_di\"><omgdi:waypoint x=\"721\" y=\"842\"/><omgdi:waypoint x=\"721\" y=\"934\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"228\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ConditionPoint_3\" id=\"ConditionPoint_3_di\" isMarkerVisible=\"true\"><omgdc:Bounds height=\"52\" width=\"245.017\" x=\"598\" y=\"404\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_2\" id=\"ServiceTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"598\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_4\" id=\"EndPoint_4_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"934\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"758\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1666932219939, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d", "description": {"format": "text", "content": "Playbook used to Reset a users password with either the password provided by the analyst or a randomly generated one."}, "display_name": "LDAP: Reset Password", "export_key": "ldap_reset_password", "field_type_handle": "playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d", "fields_type": {"actions": [], "display_name": "LDAP: Reset Password", "export_key": "playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d", "fields": {"ldap_new_auto_password_length": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d/ldap_new_auto_password_length", "hide_notification": false, "id": 1247, "input_type": "number", "internal": false, "is_tracked": false, "name": "ldap_new_auto_password_length", "operation_perms": {}, "operations": [], "placeholder": "12", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "LDAP New Auto Password Length", "tooltip": "Length of auto generated password", "type_id": 1085, "uuid": "cb679b37-de13-48f4-a35d-a6419995403a", "values": []}, "ldap_return_new_password": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d/ldap_return_new_password", "hide_notification": false, "id": 1248, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "ldap_return_new_password", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "LDAP Return New Password", "tooltip": "", "type_id": 1085, "uuid": "e321df87-f6cd-4a72-bfa6-7faf12e78a6e", "values": []}, "ldap_user_new_password": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d/ldap_user_new_password", "hide_notification": false, "id": 1249, "input_type": "text", "internal": false, "is_tracked": false, "name": "ldap_user_new_password", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "LDAP User New Password", "tooltip": "If this field is empty password will be autogenerated", "type_id": 1085, "uuid": "bf4c042f-b87a-49f9-b9d2-ad65e8465bff", "values": []}}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d", "uuid": "32e0561e-32e5-4194-b04e-57a389775844"}, "has_logical_errors": false, "id": 48, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1666932691808, "local_scripts": [{"actions": [], "created_date": 1666932661298, "description": "Script used for parsing the output of the Set Password Function.", "enabled": false, "export_key": "Password Output Parser", "id": 49, "language": "python3", "last_modified_by": "john_doe@company.com", "last_modified_time": 1666932661343, "name": "Password Output Parser", "object_type": "artifact", "playbook_handle": "ldap_reset_password", "programmatic_name": "ldap_reset_password_password_output_parser", "script_text": "results = playbook.functions.results.password_output\n\n# If the function is successful in changing the users password,\n# a note is added to the incident\n\nif (results.success):\n  noteText = \"\"\"<br><i style=\"color: #979ca3\"> LDAP MultiDomain Utilities: Set Password workflow <u>complete</u>:</i>\n                    A New Password has been set for:\n                    <b>Email:</b> <u style=\"color: #7fb0ff\">{}</u>\n                    <b>DN:</b> '{}'\n                    <b>New password:</b> '{}'\"\"\".format(artifact.value, results.inputs.ldap_dn, results.inputs.ldap_new_password)\n\n  incident.addNote(helper.createRichText(noteText))\n  ", "tags": [], "uuid": "a6bd6035-fc1e-498b-b7ce-421f2ce67157"}], "manual_settings": {"activation_conditions": {"conditions": [{"evaluation_id": null, "field_name": "artifact.type", "method": "in", "type": null, "value": ["Email Sender", "Email Recipient", "User Account"]}], "logic_type": "all"}, "view_items": [{"content": "bf4c042f-b87a-49f9-b9d2-ad65e8465bff", "element": "field_uuid", "field_type": "playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "cb679b37-de13-48f4-a35d-a6419995403a", "element": "field_uuid", "field_type": "playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "e321df87-f6cd-4a72-bfa6-7faf12e78a6e", "element": "field_uuid", "field_type": "playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d", "show_if": null, "show_link_header": false, "step_label": null}]}, "name": "ldap_reset_password", "object_type": "artifact", "status": "draft", "tag": {"display_name": "Playbook_3e43a58e-e6f6-4e1c-91a5-1661fba03e4d", "id": 85, "name": "playbook_3e43a58e_e6f6_4e1c_91a5_1661fba03e4d", "type": "playbook", "uuid": "3878a706-e8ba-485a-bd3f-2f850c0e4958"}, "tags": [], "type": "default", "uuid": "3e43a58e-e6f6-4e1c-91a5-1661fba03e4d", "version": 5}, {"activation_type": "manual", "content": {"content_version": 1, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_acf62b62_8ae7_4166_ab41_139bcf70f1f7\" isExecutable=\"true\" name=\"playbook_acf62b62_8ae7_4166_ab41_139bcf70f1f7\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_1whb2pv</outgoing></startEvent><serviceTask id=\"ServiceTask_1\" name=\"LDAP Utilities: Search\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"892075c1-64ba-46c9-aba1-f1f1aa040bb7\">{\"inputs\":{},\"pre_processing_script\":\"\\\"\\\"\\\"\\nThis LDAP Script is used to search a single domain LDAP. If you have more than 1 domain set the following variable:\\ninputs.ldap_domain_name = '&lt;DomainName in Config&gt;'\\n\\nYou will also need to set the ldap_search_base to the domain of your LDAP server (I have a template of how that should look already).\\n\\nIf you want to add any LDAP Attributes to your list you will need to add them as well as any additional filters.\\n\\\"\\\"\\\"\\n\\ninputs.ldap_search_param = artifact.value\\ninputs.ldap_search_attributes = 'SamAccountName,cn,title,department,mail,physicalDeliveryOfficeName,manager'\\ninputs.ldap_search_base = 'DC=Domain,DC=Com'\\ninputs.ldap_search_filter = '(&amp;(objectclass=user)(|(SamAccountName=%ldap_param%)(mail=%ldap_param%)))'\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"search_output\"}</resilient:function></extensionElements><incoming>Flow_1whb2pv</incoming><outgoing>Flow_1wiisgl</outgoing></serviceTask><sequenceFlow id=\"Flow_1whb2pv\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/><serviceTask id=\"ServiceTask_2\" name=\"LDAP Utilities: Toggle Access\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"b912c17d-5be2-4dfa-9c8d-2d2b5d9abb08\">{\"inputs\":{\"c276dce4-c3c6-420e-8430-85ba7e388cf8\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"aa0f6b18-30f9-4e15-ac83-9fce34525947\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"938bd462-d9e0-4887-8ef1-670120e419ad\"}},\"bf1fbfd3-3b2d-4919-a4e2-0a22449d0921\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}}},\"pre_processing_script\":\"# Once the LDAP Utilities: Search completes, get the DN of the first entry\\n# which will be the DN of the account you want to set a Toggle Access for\\ninputs.ldap_domain_name = playbook.functions.results.search_output.inputs.ldap_domain_name\\ninputs.ldap_dn = playbook.functions.results.search_output.content[0][\\\"dn\\\"]\\ninputs.ldap_toggle_access = playbook.inputs.ldap_toggle_access\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"toggle_output\"}</resilient:function></extensionElements><incoming>Flow_1k2oq0w</incoming><outgoing>Flow_0s62be4</outgoing></serviceTask><exclusiveGateway default=\"Flow_1dala91\" id=\"ConditionPoint_3\" resilient:documentation=\"Search Success\"><extensionElements/><incoming>Flow_1wiisgl</incoming><outgoing>Flow_1k2oq0w</outgoing><outgoing>Flow_1dala91</outgoing></exclusiveGateway><endEvent id=\"EndPoint_4\" resilient:documentation=\"End point\"><incoming>Flow_1mj1xrz</incoming><incoming>Flow_1dala91</incoming></endEvent><scriptTask id=\"ScriptTask_5\" name=\"Toggle Output Parser\"><extensionElements><resilient:script uuid=\"cb053362-e551-4700-a76b-a89329e4d35b\"/></extensionElements><incoming>Flow_0s62be4</incoming><outgoing>Flow_1mj1xrz</outgoing><script>script</script></scriptTask><sequenceFlow id=\"Flow_0s62be4\" sourceRef=\"ServiceTask_2\" targetRef=\"ScriptTask_5\"/><sequenceFlow id=\"Flow_1mj1xrz\" sourceRef=\"ScriptTask_5\" targetRef=\"EndPoint_4\"/><sequenceFlow id=\"Flow_1wiisgl\" sourceRef=\"ServiceTask_1\" targetRef=\"ConditionPoint_3\"/><sequenceFlow id=\"Flow_1k2oq0w\" name=\"Search Successful\" sourceRef=\"ConditionPoint_3\" targetRef=\"ServiceTask_2\"><extensionElements><resilient:condition label=\"Search Successful\" order=\"0\"/></extensionElements><conditionExpression language=\"resilient-conditions\" xsi:type=\"tFormalExpression\">{\"conditions\":[{\"evaluation_id\":null,\"field_name\":null,\"method\":\"script\",\"type\":null,\"value\":{\"script_text\":\"# One line example:\\n#\\n# result = incident.employee_involved = True\\n#\\n# Multi-line example:\\n#\\n# certificate_expired = playbook.functions.results.certificate_results.is_expired\\n# if (incident.employee_involved == True and certificate_expired):\\n#     result = True\\n# else:\\n#     result = False\\n\\nif playbook.functions.results.search_output['success']:\\n  result = True\\nelse:\\n  result = False\\n\",\"final_expression_text\":\"result\",\"final_expression_only_boolean\":true,\"language\":\"python3\"}}],\"logic_type\":\"all\",\"script_language\":null}</conditionExpression></sequenceFlow><sequenceFlow id=\"Flow_1dala91\" name=\"Else\" sourceRef=\"ConditionPoint_3\" targetRef=\"EndPoint_4\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_acf62b62_8ae7_4166_ab41_139bcf70f1f7\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_1whb2pv\" id=\"Flow_1whb2pv_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"218\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0s62be4\" id=\"Flow_0s62be4_di\"><omgdi:waypoint x=\"721\" y=\"652\"/><omgdi:waypoint x=\"721\" y=\"718\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1mj1xrz\" id=\"Flow_1mj1xrz_di\"><omgdi:waypoint x=\"721\" y=\"802\"/><omgdi:waypoint x=\"721\" y=\"884\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1wiisgl\" id=\"Flow_1wiisgl_di\"><omgdi:waypoint x=\"721\" y=\"302\"/><omgdi:waypoint x=\"721\" y=\"404\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1k2oq0w\" id=\"Flow_1k2oq0w_di\"><omgdi:waypoint x=\"721\" y=\"456\"/><omgdi:waypoint x=\"721\" y=\"568\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"27\" width=\"58\" x=\"721\" y=\"496\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1dala91\" id=\"Flow_1dala91_di\"><omgdi:waypoint x=\"843\" y=\"430\"/><omgdi:waypoint x=\"960\" y=\"430\"/><omgdi:waypoint x=\"970\" y=\"910\"/><omgdi:waypoint x=\"787\" y=\"910\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"14\" width=\"22\" x=\"970\" y=\"667\"/></bpmndi:BPMNLabel></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"218\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_4\" id=\"EndPoint_4_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"884\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_5\" id=\"ScriptTask_5_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"718\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_2\" id=\"ServiceTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"568\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ConditionPoint_3\" id=\"ConditionPoint_3_di\" isMarkerVisible=\"true\"><omgdc:Bounds height=\"52\" width=\"245.017\" x=\"598\" y=\"404\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1666931271398, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_acf62b62_8ae7_4166_ab41_139bcf70f1f7", "description": {"format": "text", "content": "Playbook used to Toggle a users access on and off based on the analysts selection."}, "display_name": "LDAP: Toggle User Access", "export_key": "ldap_toggle_user_access", "field_type_handle": "playbook_acf62b62_8ae7_4166_ab41_139bcf70f1f7", "fields_type": {"actions": [], "display_name": "LDAP: Toggle User Access", "export_key": "playbook_acf62b62_8ae7_4166_ab41_139bcf70f1f7", "fields": {"ldap_toggle_access": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_acf62b62_8ae7_4166_ab41_139bcf70f1f7/ldap_toggle_access", "hide_notification": false, "id": 1246, "input_type": "select", "internal": false, "is_tracked": false, "name": "ldap_toggle_access", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "required": "always", "rich_text": false, "tags": [], "templates": [], "text": "LDAP Toggle Access", "tooltip": "", "type_id": 1084, "uuid": "616377ac-3904-400a-af52-61c51d8f4253", "values": [{"default": true, "enabled": true, "hidden": false, "label": "Disable", "properties": null, "uuid": "d28b5f02-c375-46de-9dad-f2d8fffbd55a", "value": 492}, {"default": false, "enabled": true, "hidden": false, "label": "Enable", "properties": null, "uuid": "5061cc8a-b038-4e83-8ca9-12048f90c856", "value": 493}]}}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_acf62b62_8ae7_4166_ab41_139bcf70f1f7", "uuid": "bce89d26-4fec-42ed-a4d9-e017a76945fe"}, "has_logical_errors": false, "id": 47, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1666932008531, "local_scripts": [{"actions": [], "created_date": 1666931755289, "description": "Script used to Parse the output from the Toggle Function.", "enabled": false, "export_key": "Toggle Output Parser", "id": 48, "language": "python3", "last_modified_by": "john_doe@company.com", "last_modified_time": 1666931755305, "name": "Toggle Output Parser", "object_type": "artifact", "playbook_handle": "ldap_toggle_user_access", "programmatic_name": "ldap_toggle_user_access_toggle_output_parser", "script_text": "results = playbook.functions.results.toggle_output\n\n# If the function is successful in updating users access rights,\n# a note is added to the incident\n\nif (results.success):\n  color = \"#45bc27\" #green\n  if (results.inputs.ldap_toggle_access.get(\"name\") == \"Disable\"):\n    color = \"#ff402b\" #red\n  noteText = \"\"\"<br><i style=\"color: #979ca3\"> LDAP Utilities: Toggle Access workflow <u>complete</u>:</i>\n                    <b>Email:</b> <u style=\"color: #7fb0ff\">{}</u>\n                    <b>Status:</b> <b style=\"color: {}\">{}</b>\n                    <b>DN:</b> '{}'\"\"\".format(artifact.value, color, results.inputs.ldap_toggle_access.name, results.inputs.ldap_dn)\n\n  incident.addNote(helper.createRichText(noteText))\n", "tags": [], "uuid": "cb053362-e551-4700-a76b-a89329e4d35b"}], "manual_settings": {"activation_conditions": {"conditions": [{"evaluation_id": null, "field_name": "artifact.type", "method": "in", "type": null, "value": ["Email Sender", "Email Recipient", "User Account"]}], "logic_type": "all"}, "view_items": [{"content": "616377ac-3904-400a-af52-61c51d8f4253", "element": "field_uuid", "field_type": "playbook_acf62b62_8ae7_4166_ab41_139bcf70f1f7", "show_if": null, "show_link_header": false, "step_label": null}]}, "name": "ldap_toggle_user_access", "object_type": "artifact", "status": "draft", "tag": {"display_name": "Playbook_acf62b62-8ae7-4166-ab41-139bcf70f1f7", "id": 84, "name": "playbook_acf62b62_8ae7_4166_ab41_139bcf70f1f7", "type": "playbook", "uuid": "671be21b-050a-49ae-96ef-b7747494956f"}, "tags": [], "type": "default", "uuid": "acf62b62-8ae7-4166-ab41-139bcf70f1f7", "version": 5}, {"activation_type": "manual", "content": {"content_version": 5, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_62a9259b_6c15_49e9_ac6a_9279e82bb873\" isExecutable=\"true\" name=\"playbook_62a9259b_6c15_49e9_ac6a_9279e82bb873\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_0l9miq3</outgoing></startEvent><serviceTask id=\"ServiceTask_1\" name=\"LDAP Utilities: Search\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"892075c1-64ba-46c9-aba1-f1f1aa040bb7\">{\"inputs\":{},\"pre_processing_script\":\"\\\"\\\"\\\"\\nThis LDAP Script is used to search a single domain LDAP. If you have more than 1 domain set the following variable:\\ninputs.ldap_domain_name = '&lt;DomainName in Config&gt;'\\n\\nYou will also need to set the ldap_search_base to the domain of your LDAP server (I have a template of how that should look already).\\n\\nIf you want to add any LDAP Attributes to your list you will need to add them as well as any additional filters.\\n\\\"\\\"\\\"\\n\\ninputs.ldap_search_param = artifact.value\\ninputs.ldap_search_attributes = 'SamAccountName,cn,title,department,mail,physicalDeliveryOfficeName,manager'\\ninputs.ldap_search_base = 'DC=computer-lab,DC=net'\\ninputs.ldap_search_filter = '(&amp;(objectclass=user)(SamAccountName=%ldap_param%))'\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"ldap_output\"}</resilient:function></extensionElements><incoming>Flow_0l9miq3</incoming><outgoing>Flow_0or5ozn</outgoing></serviceTask><sequenceFlow id=\"Flow_0l9miq3\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/><scriptTask id=\"ScriptTask_2\" name=\"LDAP Output Script\"><extensionElements><resilient:script uuid=\"d8753f80-d270-4a95-bcc4-46fe1e836dd9\"/></extensionElements><incoming>Flow_0or5ozn</incoming><outgoing>Flow_1hgjyk8</outgoing><script>script</script></scriptTask><sequenceFlow id=\"Flow_0or5ozn\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_1hgjyk8</incoming></endEvent><sequenceFlow id=\"Flow_1hgjyk8\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_62a9259b_6c15_49e9_ac6a_9279e82bb873\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_1hgjyk8\" id=\"Flow_1hgjyk8_di\"><omgdi:waypoint x=\"721\" y=\"522\"/><omgdi:waypoint x=\"721\" y=\"664\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0or5ozn\" id=\"Flow_0or5ozn_di\"><omgdi:waypoint x=\"721\" y=\"312\"/><omgdi:waypoint x=\"721\" y=\"438\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0l9miq3\" id=\"Flow_0l9miq3_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"228\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"228\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"438\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"664\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1666930298200, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_62a9259b_6c15_49e9_ac6a_9279e82bb873", "description": {"format": "text", "content": "LDAP Playbook used to lookup User Information display it in a datatable."}, "display_name": "LDAP: User Lookup", "export_key": "ldap_user_lookup", "field_type_handle": "playbook_62a9259b_6c15_49e9_ac6a_9279e82bb873", "fields_type": {"actions": [], "display_name": "LDAP: User Lookup", "export_key": "playbook_62a9259b_6c15_49e9_ac6a_9279e82bb873", "fields": {}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_62a9259b_6c15_49e9_ac6a_9279e82bb873", "uuid": "24fbf725-7f64-4119-b1fc-fc8b17607ecb"}, "has_logical_errors": false, "id": 46, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1684336472647, "local_scripts": [{"actions": [], "created_date": 1666931091859, "description": "Script used to parse out the output of the LDAP Search Function.", "enabled": false, "export_key": "LDAP Output Script", "id": 47, "language": "python3", "last_modified_by": "john_doe@company.com", "last_modified_time": 1666931091877, "name": "LDAP Output Script", "object_type": "artifact", "playbook_handle": "ldap_user_lookup", "programmatic_name": "ldap_user_lookup_ldap_output_script", "script_text": "import re\n\nldap_output = playbook.functions.results.ldap_output\n\n##  LDAP Utilities: Search - post-processing script ##\n# Example of expected results\n\"\"\"\n'entries': [{u'dn': u'CN=Isaac Newton,OU=IBMResilient,DC=ibm,DC=resilient,DC=com',\n              u'telephoneNumber': u'314-159-2653', u'cn': u'Isaac Newton',\n              u'mail': u'einstein@resilient.ibm.com', u'sn': u'Newton'}]\n\"\"\"\n\n#  Globals\n\"\"\"\nBuild the below dictionary out with the Key being the LDAP Attribute and the Value being the DataTable Column API Name.\n\"\"\"\nENTRY_TO_DATATABLE_MAP = {\n   \"sAMAccountName\": \"dt_username\",\n   \"cn\": \"dt_user_name\",\n   \"mail\": \"dt_email\",\n   \"title\": \"dt_job_title\",\n   \"department\": \"dt_department\",\n   \"physicalDeliveryOfficeName\": \"dt_location\",\n   \"manager\": \"dt_manager\"\n}\n\nregex = re.compile(r'CN=(\\S+ \\S+),CN')\n\n\n# Processing if the function is a success\nif(ldap_output.success):\n  for entry in ldap_output.entries:\n    # Add Row\n    \"\"\"\n    Set the below variable to the DataTable API Name which will be receiving the output of the function.\n    \"\"\"\n    row = incident.addRow(\"ldap_data\")\n    for k in ENTRY_TO_DATATABLE_MAP:\n        try:\n          # If 'entry[k]' is empty\n          if not len(entry[k]):\n            row[ENTRY_TO_DATATABLE_MAP[k]] = \"N/A\"\n          # Handle for OpenLdap\n          else:\n            if k == 'manager':\n              manager = re.match(regex,entry[k]).groups()[0]\n              row[ENTRY_TO_DATATABLE_MAP[k]] = manager\n            else:\n              row[ENTRY_TO_DATATABLE_MAP[k]] = entry[k]\n        except IndexError:\n          row[ENTRY_TO_DATATABLE_MAP[k]] = \"N/A\"\n", "tags": [], "uuid": "d8753f80-d270-4a95-bcc4-46fe1e836dd9"}], "manual_settings": {"activation_conditions": {"conditions": [{"evaluation_id": null, "field_name": "artifact.type", "method": "in", "type": null, "value": ["User Account"]}], "logic_type": "all"}, "view_items": []}, "name": "ldap_user_lookup", "object_type": "artifact", "status": "enabled", "tag": {"display_name": "Playbook_62a9259b-6c15-49e9-ac6a-9279e82bb873", "id": 83, "name": "playbook_62a9259b_6c15_49e9_ac6a_9279e82bb873", "type": "playbook", "uuid": "b106c28e-0110-4ef0-8f6a-19d75fdd2462"}, "tags": [], "type": "default", "uuid": "62a9259b-6c15-49e9-ac6a-9279e82bb873", "version": 9}], "regulators": null, "roles": [], "scripts": [], "server_version": {"build_number": 8131, "major": 46, "minor": 0, "version": "46.0.8131"}, "tags": [], "task_order": [], "timeframes": null, "types": [{"actions": [], "display_name": "LDAP Data", "export_key": "ldap_data", "fields": {"dt_department": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "ldap_data/dt_department", "hide_notification": false, "id": 1250, "input_type": "text", "internal": false, "is_tracked": false, "name": "dt_department", "operation_perms": {}, "operations": [], "order": 3, "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "short_text": "", "tags": [], "templates": [], "text": "Department", "tooltip": "", "type_id": 1086, "uuid": "25f339a7-50e0-4219-962f-a9e7bd425439", "values": [], "width": 228}, "dt_email": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "ldap_data/dt_email", "hide_notification": false, "id": 1251, "input_type": "text", "internal": false, "is_tracked": false, "name": "dt_email", "operation_perms": {}, "operations": [], "order": 4, "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "short_text": "", "tags": [], "templates": [], "text": "Email", "tooltip": "", "type_id": 1086, "uuid": "06225f19-c476-4e33-aa09-9ba6c4869904", "values": [], "width": 354}, "dt_job_title": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "ldap_data/dt_job_title", "hide_notification": false, "id": 1252, "input_type": "text", "internal": false, "is_tracked": false, "name": "dt_job_title", "operation_perms": {}, "operations": [], "order": 2, "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "short_text": "", "tags": [], "templates": [], "text": "Job title", "tooltip": "", "type_id": 1086, "uuid": "6abfefbf-c787-4183-b154-4d6f6ab6f160", "values": [], "width": 216}, "dt_location": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "ldap_data/dt_location", "hide_notification": false, "id": 1253, "input_type": "text", "internal": false, "is_tracked": false, "name": "dt_location", "operation_perms": {}, "operations": [], "order": 5, "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "short_text": "", "tags": [], "templates": [], "text": "Location", "tooltip": "", "type_id": 1086, "uuid": "37805014-034b-4c23-bbd5-87d1d6bfd401", "values": [], "width": 171}, "dt_manager": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "ldap_data/dt_manager", "hide_notification": false, "id": 1254, "input_type": "text", "internal": false, "is_tracked": false, "name": "dt_manager", "operation_perms": {}, "operations": [], "order": 6, "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "short_text": "", "tags": [], "templates": [], "text": "Manager", "tooltip": "", "type_id": 1086, "uuid": "dd38ed20-3653-4f52-beb8-4afcec0ea950", "values": [], "width": 230}, "dt_user_name": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "ldap_data/dt_user_name", "hide_notification": false, "id": 1255, "input_type": "text", "internal": false, "is_tracked": false, "name": "dt_user_name", "operation_perms": {}, "operations": [], "order": 1, "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "short_text": "", "tags": [], "templates": [], "text": "Name", "tooltip": "", "type_id": 1086, "uuid": "121a4989-f5d8-4121-9493-784470d89088", "values": [], "width": 245}, "dt_username": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "ldap_data/dt_username", "hide_notification": false, "id": 1256, "input_type": "text", "internal": false, "is_tracked": false, "name": "dt_username", "operation_perms": {}, "operations": [], "order": 0, "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "short_text": "", "tags": [], "templates": [], "text": "Username", "tooltip": "", "type_id": 1086, "uuid": "3a993a59-7db8-4892-8b15-142487feee03", "values": [], "width": 124}}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["incident"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 8, "type_name": "ldap_data", "uuid": "9b5bd9e8-097a-48ad-b01d-57a543c38270"}], "workflows": [], "workspaces": []}