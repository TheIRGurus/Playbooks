{"action_order": [], "actions": [], "apps": [], "automatic_tasks": [], "export_date": 1693929574952, "export_format_version": 2, "export_type": null, "fields": [{"export_key": "incident/internal_customizations_field", "id": 0, "input_type": "text", "internal": true, "name": "internal_customizations_field", "read_only": true, "text": "Customizations Field (internal)", "type_id": 0, "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"}], "functions": [], "geos": null, "groups": null, "id": 51, "inbound_destinations": [], "inbound_mailboxes": null, "incident_artifact_types": [], "incident_types": [{"update_date": 1693929572125, "create_date": 1693929572125, "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0", "description": "Customization Packages (internal)", "export_key": "Customization Packages (internal)", "name": "Customization Packages (internal)", "enabled": false, "system": false, "parent_id": null, "hidden": false, "id": 0}], "industries": null, "layouts": [], "locale": null, "message_destinations": [], "notifications": null, "overrides": null, "phases": [], "playbooks": [{"activation_type": "manual", "content": {"content_version": 3, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_8a7f7ee4_375e_4d68_b39f_8bbb542776a0\" isExecutable=\"true\" name=\"playbook_8a7f7ee4_375e_4d68_b39f_8bbb542776a0\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_0t9tqja</outgoing></startEvent><sequenceFlow id=\"Flow_0t9tqja\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_4\"/><scriptTask id=\"ScriptTask_2\" name=\"Dig Output Script\"><extensionElements><resilient:script uuid=\"6b775ce1-a3b3-4400-ad57-f9536bcf4237\"/></extensionElements><incoming>Flow_1995pj2</incoming><outgoing>Flow_1nl8qoe</outgoing><script>script</script></scriptTask><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_1nl8qoe</incoming></endEvent><sequenceFlow id=\"Flow_1nl8qoe\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/><serviceTask id=\"ServiceTask_4\" name=\"Network Utilities: Local Shell Command\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"bdcffebf-b4ae-4566-a2e9-5d68c3f43ce4\">{\"inputs\":{},\"pre_processing_script\":\"inputs.network_utilities_shell_command = 'dig'\\ninputs.network_utilities_shell_params = artifact.value\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"dig_output\"}</resilient:function></extensionElements><incoming>Flow_0t9tqja</incoming><outgoing>Flow_1995pj2</outgoing></serviceTask><sequenceFlow id=\"Flow_1995pj2\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_2\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_8a7f7ee4_375e_4d68_b39f_8bbb542776a0\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_1nl8qoe\" id=\"Flow_1nl8qoe_di\"><omgdi:waypoint x=\"721\" y=\"522\"/><omgdi:waypoint x=\"721\" y=\"674\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0t9tqja\" id=\"Flow_0t9tqja_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"228\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1995pj2\" id=\"Flow_1995pj2_di\"><omgdi:waypoint x=\"721\" y=\"312\"/><omgdi:waypoint x=\"721\" y=\"438\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"438\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"674\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"228\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1663161528455, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_8a7f7ee4_375e_4d68_b39f_8bbb542776a0", "description": {"format": "text", "content": "Playbook Allowing the use of the Linux command Dig to look into System Names, DNS Names, and IP Addresses."}, "display_name": "Dig", "export_key": "dig", "field_type_handle": "playbook_8a7f7ee4_375e_4d68_b39f_8bbb542776a0", "fields_type": {"actions": [], "display_name": "Dig", "export_key": "playbook_8a7f7ee4_375e_4d68_b39f_8bbb542776a0", "fields": {}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_8a7f7ee4_375e_4d68_b39f_8bbb542776a0", "uuid": "9d020c9e-e6ba-4573-a5a2-723807aa4c69"}, "has_logical_errors": false, "id": 7, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1693927705979, "local_scripts": [{"actions": [], "created_date": 1663161739308, "description": "Script used to parse out the data from the output of the previously run function running the Dig Command.", "enabled": false, "export_key": "Dig Output Script", "id": 8, "language": "python3", "last_modified_by": "john_doe@company.com", "last_modified_time": 1693927699909, "name": "Dig Output Script", "object_type": "artifact", "playbook_handle": "dig", "programmatic_name": "dig_dig_output_script", "script_text": "dig_output = playbook.functions.results.dig_output\n\nif dig_output.success:\n    note = 'Command: ' + dig_output['content']['commandline'] + '\\n'\n    \n    if dig_output['content']['stdout']:\n        incident.addNote(helper.createRichText(note + dig_output['content']['stdout']))\n        if artifact.description:\n            artifact.description = helper.createRichText(artifact.description['content'] + ' ' + note + dig_output['content']['stdout'])\n        else:\n            artifact.description = helper.createRichText(note + dig_output['content']['stdout'])\n    \n    else:\n        incident.addNote(helper.createRichText(dig_output['content']['stderr']))\n", "tags": [], "uuid": "6b775ce1-a3b3-4400-ad57-f9536bcf4237"}], "manual_settings": {"activation_conditions": {"conditions": [{"evaluation_id": null, "field_name": "artifact.type", "method": "in", "type": null, "value": ["IP Address", "DNS Name", "System Name"]}], "logic_type": "all"}, "view_items": []}, "name": "dig", "object_type": "artifact", "status": "enabled", "tag": {"display_name": "Playbook_8a7f7ee4-375e-4d68-b39f-8bbb542776a0", "id": 31, "name": "playbook_8a7f7ee4_375e_4d68_b39f_8bbb542776a0", "type": "playbook", "uuid": "e9b51264-8ca6-493c-9321-30150199bec0"}, "tags": [], "type": "default", "uuid": "8a7f7ee4-375e-4d68-b39f-8bbb542776a0", "version": 7}, {"activation_type": "manual", "content": {"content_version": 3, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_c7f97196_f036_4c09_a3d5_095401f1ba0e\" isExecutable=\"true\" name=\"playbook_c7f97196_f036_4c09_a3d5_095401f1ba0e\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_0ivp8qf</outgoing></startEvent><sequenceFlow id=\"Flow_0ivp8qf\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_4\"/><scriptTask id=\"ScriptTask_2\" name=\"NSLookup Output Script\"><extensionElements><resilient:script uuid=\"54ce02d5-99fe-40ce-9573-1eefab088476\"/></extensionElements><incoming>Flow_1keay67</incoming><outgoing>Flow_1b5zl16</outgoing><script>script</script></scriptTask><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_1b5zl16</incoming></endEvent><sequenceFlow id=\"Flow_1b5zl16\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/><serviceTask id=\"ServiceTask_4\" name=\"Network Utilities: Local Shell Command\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"bdcffebf-b4ae-4566-a2e9-5d68c3f43ce4\">{\"inputs\":{},\"pre_processing_script\":\"inputs.network_utilities_shell_command = 'nslookup'\\ninputs.network_utilities_shell_params = artifact.value\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"nslookup_output\"}</resilient:function></extensionElements><incoming>Flow_0ivp8qf</incoming><outgoing>Flow_1keay67</outgoing></serviceTask><sequenceFlow id=\"Flow_1keay67\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_2\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_c7f97196_f036_4c09_a3d5_095401f1ba0e\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_1b5zl16\" id=\"Flow_1b5zl16_di\"><omgdi:waypoint x=\"721\" y=\"462\"/><omgdi:waypoint x=\"721\" y=\"564\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0ivp8qf\" id=\"Flow_0ivp8qf_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"228\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1keay67\" id=\"Flow_1keay67_di\"><omgdi:waypoint x=\"721\" y=\"312\"/><omgdi:waypoint x=\"721\" y=\"378\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"378\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"564\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"228\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1663161982179, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_c7f97196_f036_4c09_a3d5_095401f1ba0e", "description": {"format": "text", "content": "Playbook Allowing the use of the Linux command NSLookup to look into System Names or DNS Names."}, "display_name": "NSLookup", "export_key": "nslookup", "field_type_handle": "playbook_c7f97196_f036_4c09_a3d5_095401f1ba0e", "fields_type": {"actions": [], "display_name": "NSLookup", "export_key": "playbook_c7f97196_f036_4c09_a3d5_095401f1ba0e", "fields": {}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_c7f97196_f036_4c09_a3d5_095401f1ba0e", "uuid": "416a0fb7-fdb6-47b2-96f3-54d0b15af040"}, "has_logical_errors": false, "id": 8, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1693928091027, "local_scripts": [{"actions": [], "created_date": 1663162136408, "description": "Script used to parse out the data from the output of the previously run function running the NSLookup Command.", "enabled": false, "export_key": "NSLookup Output Script", "id": 9, "language": "python3", "last_modified_by": "john_doe@company.com", "last_modified_time": 1693927984753, "name": "NSLookup Output Script", "object_type": "artifact", "playbook_handle": "nslookup", "programmatic_name": "nslookup_nslookup_output_script", "script_text": "import re\nnslookup_output = playbook.functions.results.nslookup_output\n\nif nslookup_output.success:\n    note = 'Command: ' + nslookup_output['content']['commandline'] + '\\n\\n'\n    \n    if nslookup_output['content']['stdout']:\n        output = nslookup_output['content']['stdout']\n        rich_text = helper.createRichText(note + output)\n        if 'authoritative' in output.lower():\n            if artifact.description:\n                artifact.description = helper.createRichText(artifact.description['content'] + ' ' + note + output)\n            else:\n                artifact.description = note + output\n            regex = re.compile(r'Name:\\s+(\\S+)\\s+Address:\\s+(\\S+)')\n            ip_list = re.findall(regex,output)\n            for name,ip in ip_list:\n                incident.addArtifact('IP Address', ip, 'IP derived from NSLookUp on artifact: {}'.format(name))\n        \n    else:\n        rich_text = helper.createRichText(note + nslookup_output['content']['stderr'])\n    \n    incident.addNote(rich_text)\n", "tags": [], "uuid": "54ce02d5-99fe-40ce-9573-1eefab088476"}], "manual_settings": {"activation_conditions": {"conditions": [{"evaluation_id": null, "field_name": "artifact.type", "method": "in", "type": null, "value": ["DNS Name", "System Name"]}], "logic_type": "all"}, "view_items": []}, "name": "nslookup", "object_type": "artifact", "status": "enabled", "tag": {"display_name": "Playbook_c7f97196-f036-4c09-a3d5-095401f1ba0e", "id": 32, "name": "playbook_c7f97196_f036_4c09_a3d5_095401f1ba0e", "type": "playbook", "uuid": "165891f3-2f31-4ac7-aec6-4f2676149d90"}, "tags": [], "type": "default", "uuid": "c7f97196-f036-4c09-a3d5-095401f1ba0e", "version": 7}, {"activation_type": "manual", "content": {"content_version": 3, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_b5f71b8f_6ce0_44d5_875b_6bea6cc71ef8\" isExecutable=\"true\" name=\"playbook_b5f71b8f_6ce0_44d5_875b_6bea6cc71ef8\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_0kx21l3</outgoing></startEvent><sequenceFlow id=\"Flow_0kx21l3\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_4\"/><scriptTask id=\"ScriptTask_2\" name=\"Traceroute Output Script\"><extensionElements><resilient:script uuid=\"0e7fd92c-681d-491d-b880-68cc5b96d8c4\"/></extensionElements><incoming>Flow_1wi83ou</incoming><outgoing>Flow_1j36qbp</outgoing><script>script</script></scriptTask><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_1j36qbp</incoming></endEvent><sequenceFlow id=\"Flow_1j36qbp\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/><serviceTask id=\"ServiceTask_4\" name=\"Network Utilities: Local Shell Command\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"bdcffebf-b4ae-4566-a2e9-5d68c3f43ce4\">{\"inputs\":{},\"pre_processing_script\":\"inputs.network_utilities_shell_command = 'traceroute'\\ninputs.network_utilities_shell_params = artifact.value\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"traceroute_output\"}</resilient:function></extensionElements><incoming>Flow_0kx21l3</incoming><outgoing>Flow_1wi83ou</outgoing></serviceTask><sequenceFlow id=\"Flow_1wi83ou\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_2\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_b5f71b8f_6ce0_44d5_875b_6bea6cc71ef8\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_1j36qbp\" id=\"Flow_1j36qbp_di\"><omgdi:waypoint x=\"721\" y=\"442\"/><omgdi:waypoint x=\"721\" y=\"554\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0kx21l3\" id=\"Flow_0kx21l3_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"198\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1wi83ou\" id=\"Flow_1wi83ou_di\"><omgdi:waypoint x=\"721\" y=\"282\"/><omgdi:waypoint x=\"721\" y=\"358\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"357.8\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"553.8\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"198\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1663162242142, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_b5f71b8f_6ce0_44d5_875b_6bea6cc71ef8", "description": {"format": "text", "content": "Playbook Allowing the use of the Linux command Traceroute to look into System Names, DNS Names, URL, and IP Addresses."}, "display_name": "Traceroute", "export_key": "traceroute", "field_type_handle": "playbook_b5f71b8f_6ce0_44d5_875b_6bea6cc71ef8", "fields_type": {"actions": [], "display_name": "Traceroute", "export_key": "playbook_b5f71b8f_6ce0_44d5_875b_6bea6cc71ef8", "fields": {}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_b5f71b8f_6ce0_44d5_875b_6bea6cc71ef8", "uuid": "f91e4448-433b-4cf1-acfc-56fd93eca44c"}, "has_logical_errors": false, "id": 9, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1693928427495, "local_scripts": [{"actions": [], "created_date": 1663162416097, "description": "Script used to parse out the data from the output of the previously run function running the Traceroute Command.", "enabled": false, "export_key": "Traceroute Output Script", "id": 10, "language": "python3", "last_modified_by": "john_doe@company.com", "last_modified_time": 1693928392232, "name": "Traceroute Output Script", "object_type": "artifact", "playbook_handle": "traceroute", "programmatic_name": "traceroute_traceroute_output_script", "script_text": "traceroute_output = playbook.functions.results.traceroute_output\n\nif traceroute_output.success:\n    note = 'Command: ' + traceroute_output['content']['commandline'] + '\\n\\n'\n    \n    if traceroute_output['content']['stdout']:\n        incident.addNote(helper.createRichText(note + str(traceroute_output['content']['stdout'])))\n    \n    else:\n        incident.addNote(helper.createRichText(note + traceroute_output['content']['stderr']))\n", "tags": [], "uuid": "0e7fd92c-681d-491d-b880-68cc5b96d8c4"}], "manual_settings": {"activation_conditions": {"conditions": [{"evaluation_id": null, "field_name": "artifact.type", "method": "in", "type": null, "value": ["IP Address", "DNS Name", "URL", "System Name"]}], "logic_type": "all"}, "view_items": []}, "name": "traceroute", "object_type": "artifact", "status": "enabled", "tag": {"display_name": "Playbook_b5f71b8f-6ce0-44d5-875b-6bea6cc71ef8", "id": 33, "name": "playbook_b5f71b8f_6ce0_44d5_875b_6bea6cc71ef8", "type": "playbook", "uuid": "04efc4a3-517f-4b48-a63e-7abad2327266"}, "tags": [], "type": "default", "uuid": "b5f71b8f-6ce0-44d5-875b-6bea6cc71ef8", "version": 7}, {"activation_type": "manual", "content": {"content_version": 10, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_51f678ef_3f98_4272_9b63_c7514874fa30\" isExecutable=\"true\" name=\"playbook_51f678ef_3f98_4272_9b63_c7514874fa30\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_0i0c2zl</outgoing></startEvent><sequenceFlow id=\"Flow_0i0c2zl\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_4\"/><scriptTask id=\"ScriptTask_2\" name=\"Whois Output Script\"><extensionElements><resilient:script uuid=\"827949e3-27f7-4c22-accb-fe66a3b911b4\"/></extensionElements><incoming>Flow_1h601bi</incoming><outgoing>Flow_1mqqxb4</outgoing><script>script</script></scriptTask><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_1mqqxb4</incoming></endEvent><sequenceFlow id=\"Flow_1mqqxb4\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/><serviceTask id=\"ServiceTask_4\" name=\"Network Utilities: Local Shell Command\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"bdcffebf-b4ae-4566-a2e9-5d68c3f43ce4\">{\"inputs\":{},\"pre_processing_script\":\"inputs.network_utilities_shell_command = 'whois'\\ninputs.network_utilities_shell_params = artifact.value\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"whois_output\"}</resilient:function></extensionElements><incoming>Flow_0i0c2zl</incoming><outgoing>Flow_1h601bi</outgoing></serviceTask><sequenceFlow id=\"Flow_1h601bi\" sourceRef=\"ServiceTask_4\" targetRef=\"ScriptTask_2\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_51f678ef_3f98_4272_9b63_c7514874fa30\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_1h601bi\" id=\"Flow_1h601bi_di\"><omgdi:waypoint x=\"721\" y=\"292\"/><omgdi:waypoint x=\"721\" y=\"378\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1mqqxb4\" id=\"Flow_1mqqxb4_di\"><omgdi:waypoint x=\"721\" y=\"462\"/><omgdi:waypoint x=\"721\" y=\"554\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0i0c2zl\" id=\"Flow_0i0c2zl_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"208\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"378\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"554\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_4\" id=\"ServiceTask_4_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"622.5\" y=\"207.5\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1663162617150, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_51f678ef_3f98_4272_9b63_c7514874fa30", "description": {"format": "text", "content": "Playbook Allowing the use of the Linux command Whois to look into System Names, DNS Names, URL, and IP Addresses."}, "display_name": "Whois", "export_key": "whois", "field_type_handle": "playbook_51f678ef_3f98_4272_9b63_c7514874fa30", "fields_type": {"actions": [], "display_name": "Whois", "export_key": "playbook_51f678ef_3f98_4272_9b63_c7514874fa30", "fields": {}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_51f678ef_3f98_4272_9b63_c7514874fa30", "uuid": "e37cce13-eea8-43d3-beea-55e384c19b3d"}, "has_logical_errors": false, "id": 10, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1693929110117, "local_scripts": [{"actions": [], "created_date": 1663162776224, "description": "Script used to parse out the data from the output of the previously run function running the Whois Command.", "enabled": false, "export_key": "Whois Output Script", "id": 11, "language": "python3", "last_modified_by": "john_doe@company.com", "last_modified_time": 1693929102435, "name": "Whois Output Script", "object_type": "artifact", "playbook_handle": "whois", "programmatic_name": "whois_whois_output_script", "script_text": "whois_output = playbook.functions.results.whois_output\n\nif whois_output.success:\n    note = 'Command: ' + whois_output['content']['commandline'] + '\\n\\n'\n    \n    if whois_output['content']['stdout']:\n        incident.addNote(helper.createRichText(note + str(whois_output['content']['stdout'])))\n    \n    else:\n        incident.addNote(helper.createRichText(note + whois_output['content']['stderr']))\n", "tags": [], "uuid": "827949e3-27f7-4c22-accb-fe66a3b911b4"}], "manual_settings": {"activation_conditions": {"conditions": [{"evaluation_id": null, "field_name": "artifact.type", "method": "in", "type": null, "value": ["IP Address", "DNS Name", "URL", "System Name"]}], "logic_type": "all"}, "view_items": []}, "name": "whois", "object_type": "artifact", "status": "enabled", "tag": {"display_name": "Playbook_51f678ef-3f98-4272-9b63-c7514874fa30", "id": 34, "name": "playbook_51f678ef_3f98_4272_9b63_c7514874fa30", "type": "playbook", "uuid": "9becb395-4a98-43e0-9d49-9611fd029ad6"}, "tags": [], "type": "default", "uuid": "51f678ef-3f98-4272-9b63-c7514874fa30", "version": 14}], "regulators": null, "roles": [], "scripts": [], "server_version": {"build_number": 8131, "major": 46, "minor": 0, "version": "46.0.8131"}, "tags": [], "task_order": [], "timeframes": null, "types": [], "workflows": [], "workspaces": []}