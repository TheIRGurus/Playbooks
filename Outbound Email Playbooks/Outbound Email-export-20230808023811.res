{"action_order": [], "actions": [{"automations": [{"scripts_to_run": "Conversations Email Parser", "type": "run_script", "value": null}], "conditions": [{"evaluation_id": null, "field_name": "__emailmessage.subject", "method": "contains", "type": null, "value": "(ID:"}, {"evaluation_id": null, "field_name": null, "method": "object_added", "type": null, "value": null}], "enabled": true, "export_key": "Conversation Response Parser", "id": 439, "logic_type": "all", "message_destinations": [], "name": "Conversation Response Parser", "object_type": "__emailmessage", "tags": [], "timeout_seconds": 86400, "type": 0, "uuid": "f4b237d3-6a22-4019-8251-8e912b62c39d", "view_items": [], "workflows": []}], "apps": [], "automatic_tasks": [], "export_date": 1691476691479, "export_format_version": 2, "export_type": null, "fields": [{"export_key": "incident/internal_customizations_field", "id": 0, "input_type": "text", "internal": true, "name": "internal_customizations_field", "read_only": true, "text": "Customizations Field (internal)", "type_id": 0, "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"}], "functions": [], "geos": null, "groups": null, "id": 40, "inbound_destinations": [], "inbound_mailboxes": null, "incident_artifact_types": [], "incident_types": [{"update_date": 1691476689388, "create_date": 1691476689388, "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0", "description": "Customization Packages (internal)", "export_key": "Customization Packages (internal)", "name": "Customization Packages (internal)", "enabled": false, "system": false, "parent_id": null, "hidden": false, "id": 0}], "industries": null, "layouts": [], "locale": null, "message_destinations": [], "notifications": null, "overrides": null, "phases": [], "playbooks": [{"activation_type": "manual", "content": {"content_version": 1, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_dcd8984d_6433_4652_abfc_eb04de07a44a\" isExecutable=\"true\" name=\"playbook_dcd8984d_6433_4652_abfc_eb04de07a44a\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_1y2lc3q</outgoing></startEvent><serviceTask id=\"ServiceTask_1\" name=\"Outbound Email: Send Email 2\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"bb874b84-b405-40ba-abed-5f7c594f2a99\">{\"inputs\":{\"9f9dde5a-65a6-4e39-81f5-53242747b03b\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"5df194d5-7f42-494b-8bf0-219d6ffc56ee\"}},\"e09789bf-057c-4914-9877-455fb11e3f4d\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"fdbcda16-d6f2-48d1-86d7-804e25890bc1\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"a4bfd9f7-f924-4289-8bb2-fd2e3c577eb4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"124e74e9-a891-442a-b257-7d79b0eeed45\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"3864ba99-ae8c-4926-9b76-9e8e691696f5\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"d343f80b-4760-4f4a-b492-bf85dfc29261\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"c6b538ef-a2e0-49b9-abe3-4a45339db160\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"823bffa7-4f34-4eda-8ba2-7a714d236ad7\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"1f86c63b-9f1e-46e5-a865-66fff55a1af4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"dde2204d-ab55-4817-98de-2013158e7687\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"77ebe14e-2028-4f38-b66e-c3566fdf1425\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"09f822a2-50a3-4556-8af0-e86ad8b072ea\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"e8fa561a-aea1-42f7-8b9e-4615ff4046fa\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}}},\"pre_processing_script\":\"import hashlib\\nimport time\\nfrom datetime import datetime\\n\\n# change this reflect a different message-id domain, as neeced\\nMESSAGE_ID_DOMAIN = \\\"{{Your Domain Here}}\\\"\\n\\nNEW_LINE = '\\\\n'\\n\\nif playbook.inputs.mail_message_id:\\n  # generate a message-id\\n  seed_value = str(int(time.time()*1000))\\n  uuid_hash = hashlib.md5(seed_value.encode()).hexdigest()\\n  msg_id = \\\"{}-{}-{}-{}-{}\\\".format(uuid_hash[0:8], uuid_hash[8:12], uuid_hash[12:16], uuid_hash[16:20], uuid_hash[20:])\\n  inputs.mail_message_id = \\\"{}@{}\\\".format(msg_id, MESSAGE_ID_DOMAIN)\\n\\ninputs.mail_attachments = playbook.inputs.mail_attachments\\ninputs.mail_body = playbook.inputs.mail_body.content if playbook.inputs.mail_body else None\\ninputs.mail_cc = playbook.inputs.mail_cc\\ninputs.mail_to = row['from']\\ninputs.mail_from = '{{Your Email Address}}'\\ninputs.mail_importance = playbook.inputs.mail_importance if playbook.inputs.mail_importance else None\\ninputs.mail_in_reply_to = row['message_id']\\ninputs.mail_incident_id = incident.id\\ninputs.mail_subject = \\\"re: {}\\\".format(row['subject']) if '(ID: {})'.format(incident.id) in row['subject'] else \\\"re: {} (ID: {})\\\".format(row['subject'], incident.id)\\ninputs.mail_template_label = playbook.inputs.mail_template_select\\n\\nif playbook.inputs.mail_merge_body:\\n    # Sent: Thursday, June 9, 2022, 01:03:54 PM EDT\\n    msg_sent = datetime.fromtimestamp(row['date_sent']/1000).strftime('%A, %B %d, %Y, %-I:%M:%S %p GMT')\\n    inputs.mail_merge_body = True\\n    original_email = f\\\"\\\"\\\"Sent: {msg_sent}\\n&lt;br&gt;From: {row['from']}\\n&lt;br&gt;{row['recipients'].content}\\n&lt;br&gt;Subject: {row['subject']}\\n&lt;br&gt;\\n&lt;br&gt;\\n{row['body'].content.replace(\\\"&lt;br&gt;\\\", \\\"\\\")}\\\"\\\"\\\"\\n  \\n    if inputs.mail_body:\\n        inputs.mail_body = f\\\"{inputs.mail_body}&lt;hr&gt;\\\"\\n    inputs.mail_body = f\\\"{inputs.mail_body if inputs.mail_body else ''}&lt;div style='border-left: 2px solid gray'&gt;&lt;div style='white-space: nowrap;margin-left: 5px'&gt;{original_email}&lt;/div&gt;&lt;/div&gt;\\\"\\n    \",\"pre_processing_script_language\":\"python3\",\"result_name\":\"outbound_email_results\"}</resilient:function></extensionElements><incoming>Flow_1y2lc3q</incoming><outgoing>Flow_1ba77ho</outgoing></serviceTask><sequenceFlow id=\"Flow_1y2lc3q\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/><scriptTask id=\"ScriptTask_2\" name=\"Save Outbound Email Results\"><extensionElements><resilient:script uuid=\"7744a945-4634-43eb-8558-a3658c865f03\"/></extensionElements><incoming>Flow_1ba77ho</incoming><outgoing>Flow_1ovphcv</outgoing><script>script</script></scriptTask><sequenceFlow id=\"Flow_1ba77ho\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_1ovphcv</incoming></endEvent><sequenceFlow id=\"Flow_1ovphcv\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_dcd8984d_6433_4652_abfc_eb04de07a44a\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_1y2lc3q\" id=\"Flow_1y2lc3q_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"228\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1ba77ho\" id=\"Flow_1ba77ho_di\"><omgdi:waypoint x=\"721\" y=\"312\"/><omgdi:waypoint x=\"721\" y=\"418\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1ovphcv\" id=\"Flow_1ovphcv_di\"><omgdi:waypoint x=\"721\" y=\"502\"/><omgdi:waypoint x=\"721\" y=\"634\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"228\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"418\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"634\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1691474186966, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a", "description": {"format": "text", "content": "Reply to a message within the email conversation"}, "display_name": "Outbound Email: Reply to Message (PB)", "export_key": "outbound_email_reply_to_message_pb", "field_type_handle": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a", "fields_type": {"actions": [], "display_name": "Outbound Email: Reply to Message (PB)", "export_key": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a", "fields": {"mail_attachments": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a/mail_attachments", "hide_notification": false, "id": 1928, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_attachments", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Attachments", "tooltip": "comma separated list of attachments for '*' for all", "type_id": 1178, "uuid": "a92a36ad-912e-4ce0-beea-7822f4cd555f", "values": []}, "mail_body": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a/mail_body", "hide_notification": false, "id": 1929, "input_type": "textarea", "internal": false, "is_tracked": false, "name": "mail_body", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Massage Body", "tooltip": "", "type_id": 1178, "uuid": "c3e249e2-7c10-469b-9593-56787f39ad59", "values": []}, "mail_cc": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a/mail_cc", "hide_notification": false, "id": 1930, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_cc", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "CC", "tooltip": "", "type_id": 1178, "uuid": "43988633-64fc-4756-b375-23a9ed8218d0", "values": []}, "mail_importance": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a/mail_importance", "hide_notification": false, "id": 1931, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_importance", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Importance", "tooltip": "", "type_id": 1178, "uuid": "119fd2bf-faa2-4cd4-8c41-1c332cab0ec4", "values": [{"default": false, "enabled": true, "hidden": false, "label": "high", "properties": null, "uuid": "680021e7-71c0-442c-8dc2-9a3590b2b6d6", "value": 951}, {"default": true, "enabled": true, "hidden": false, "label": "normal", "properties": null, "uuid": "9abae621-1d58-4498-b10d-b61235415702", "value": 952}, {"default": false, "enabled": true, "hidden": false, "label": "low", "properties": null, "uuid": "76f48e92-64b5-4692-9f9d-a0e7e7a77b36", "value": 953}]}, "mail_merge_body": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a/mail_merge_body", "hide_notification": false, "id": 1932, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_merge_body", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Include Original Email", "tooltip": "", "type_id": 1178, "uuid": "5d38504a-0aec-4ada-b4ee-6a9849489931", "values": []}, "mail_message_id": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a/mail_message_id", "hide_notification": false, "id": 1933, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_message_id", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Generate message-id", "tooltip": "generate a message id for this message", "type_id": 1178, "uuid": "dab932b6-c9a5-48f9-88cb-d6d0d781e8d4", "values": []}, "mail_template_select": {"allow_default_value": false, "blank_option": true, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a/mail_template_select", "hide_notification": false, "id": 1934, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_template_select", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Template label", "tooltip": "", "type_id": 1178, "uuid": "888d5df6-027d-40e5-add1-97d5366130ec", "values": [{"default": false, "enabled": true, "hidden": false, "label": "TemplateName1", "properties": null, "uuid": "09acdb75-cf60-4f8b-ac7e-11eae357dfe0", "value": 954}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName2", "properties": null, "uuid": "01092c9b-779a-4a40-8ce3-41952a1f1b5a", "value": 955}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName3", "properties": null, "uuid": "0af46ced-2c8e-4fae-bccb-3ee3796696ca", "value": 956}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName4", "properties": null, "uuid": "cd53cb3d-bfba-455f-9f99-826d6d1ea41b", "value": 957}]}}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a", "uuid": "c05cc4e2-9aae-4676-82c3-9f1231adedff"}, "has_logical_errors": false, "id": 134, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1691474600806, "local_scripts": [], "manual_settings": {"activation_conditions": {"conditions": [], "logic_type": "all"}, "view_items": [{"content": "43988633-64fc-4756-b375-23a9ed8218d0", "element": "field_uuid", "field_type": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "c3e249e2-7c10-469b-9593-56787f39ad59", "element": "field_uuid", "field_type": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "a92a36ad-912e-4ce0-beea-7822f4cd555f", "element": "field_uuid", "field_type": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "888d5df6-027d-40e5-add1-97d5366130ec", "element": "field_uuid", "field_type": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "dab932b6-c9a5-48f9-88cb-d6d0d781e8d4", "element": "field_uuid", "field_type": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "119fd2bf-faa2-4cd4-8c41-1c332cab0ec4", "element": "field_uuid", "field_type": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "5d38504a-0aec-4ada-b4ee-6a9849489931", "element": "field_uuid", "field_type": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a", "show_if": null, "show_link_header": false, "step_label": null}]}, "name": "outbound_email_reply_to_message_pb", "object_type": "email_conversations", "status": "draft", "tag": {"display_name": "Playbook_dcd8984d-6433-4652-abfc-eb04de07a44a", "id": 185, "name": "playbook_dcd8984d_6433_4652_abfc_eb04de07a44a", "type": "playbook", "uuid": "22a0e1e1-3148-4652-910c-646058a34c92"}, "tags": [], "type": "default", "uuid": "dcd8984d-6433-4652-abfc-eb04de07a44a", "version": 5}, {"activation_type": "manual", "content": {"content_version": 1, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2\" isExecutable=\"true\" name=\"playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_0gxfhzb</outgoing></startEvent><serviceTask id=\"ServiceTask_1\" name=\"Outbound Email: Send Email 2\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"bb874b84-b405-40ba-abed-5f7c594f2a99\">{\"inputs\":{\"9f9dde5a-65a6-4e39-81f5-53242747b03b\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"5df194d5-7f42-494b-8bf0-219d6ffc56ee\"}},\"e09789bf-057c-4914-9877-455fb11e3f4d\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"fdbcda16-d6f2-48d1-86d7-804e25890bc1\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"a4bfd9f7-f924-4289-8bb2-fd2e3c577eb4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"124e74e9-a891-442a-b257-7d79b0eeed45\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"3864ba99-ae8c-4926-9b76-9e8e691696f5\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"d343f80b-4760-4f4a-b492-bf85dfc29261\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"c6b538ef-a2e0-49b9-abe3-4a45339db160\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"823bffa7-4f34-4eda-8ba2-7a714d236ad7\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"1f86c63b-9f1e-46e5-a865-66fff55a1af4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"dde2204d-ab55-4817-98de-2013158e7687\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"77ebe14e-2028-4f38-b66e-c3566fdf1425\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"09f822a2-50a3-4556-8af0-e86ad8b072ea\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"e8fa561a-aea1-42f7-8b9e-4615ff4046fa\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}}},\"pre_processing_script\":\"import hashlib\\nimport time\\n\\nMESSAGE_ID_DOMAIN = \\\"soar-demo.mumaw-lab.net\\\"\\n\\ninputs.mail_to = artifact.value\\ninputs.mail_cc = playbook.inputs.mail_cc\\ninputs.mail_attachments = playbook.inputs.mail_attachments\\ninputs.mail_incident_id = incident.id\\ninputs.mail_from = 'SOAR-Mumaw@outlook.com'\\ninputs.mail_subject = \\\"{0} (ID: {1})\\\".format(incident.name, incident.id) if not playbook.inputs.mail_subject else playbook.inputs.mail_subject + ' (ID: {})'.format(incident.id)\\ninputs.mail_importance = playbook.inputs.mail_importance if playbook.inputs.mail_importance else None\\n\\nif playbook.inputs.mail_message_id:\\n  # generate a message-id\\n  seed_value = str(int(time.time()*1000))\\n  uuid_hash = hashlib.md5(seed_value.encode()).hexdigest()\\n  msg_id = \\\"{}-{}-{}-{}-{}\\\".format(uuid_hash[0:8], uuid_hash[8:12], uuid_hash[12:16], uuid_hash[16:20], uuid_hash[20:])\\n  inputs.mail_message_id = \\\"{}@{}\\\".format(msg_id, MESSAGE_ID_DOMAIN)\\n  \\nif playbook.inputs.mail_in_reply_to and incident.properties.email_message_id:\\n  inputs.mail_in_reply_to = incident.properties.email_message_id\\n\\nif playbook.inputs.mail_body:\\n  inputs.mail_body = playbook.inputs.mail_body.content\\nelif playbook.inputs.mail_template_select:\\n  inputs.mail_template_label = playbook.inputs.mail_template_label\\nelse:\\n  inputs.mail_inline_template = \\\"\\\"\\\"{% set NOT_FOUND = [\\\"Not Found!\\\",\\\"-\\\",\\\"None\\\",None] -%}\\n{% set style = \\\"font-family: Calibri; color: rgb(31,73,125)\\\" -%}\\n{% macro get_row(label, field_name) -%}\\n\\t{% set value = template_helper.get_incident_value(incident,field_name) -%}\\n    {% if value and value not in NOT_FOUND and not value.startswith('-') -%}\\n    &lt;tr&gt;\\n        &lt;td width=\\\"100\\\" style=\\\"{{style}}; font-weight:bold\\\"&gt;{{ label }}&lt;/td&gt;\\n        &lt;td style=\\\"{{style}}\\\"&gt;{{ value | striptags }}&lt;/td&gt;\\n    &lt;/tr&gt;\\n    {% endif -%}\\n{% endmacro -%}\\n&lt;table width=\\\"100%\\\" &gt;\\n&lt;tr&gt;\\n    &lt;td colspan=\\\"2\\\"&gt;\\n        &lt;h3 style=\\\"color: rgb(68,114,196)\\\"&gt;INCIDENT DETAILS&lt;/h3&gt;\\n        &lt;hr size=\\\"1\\\" width=\\\"100%\\\" noshade style=\\\"color:#FFDF57\\\" align=\\\"center\\\"/&gt;\\n    &lt;/td&gt;\\n&lt;/tr&gt;\\n    {{ get_row('Incident:','severity_code') }}\\n    {{ get_row('Severity:','severity_code') }}\\n    {{ get_row('Status:','plan_status') }}&lt;br&gt;\\n    {{ get_row('Created:','create_date') }}&lt;br&gt;\\n    {{ get_row('Category:','incident_type_ids') }}\\n&lt;tr&gt;\\n    &lt;td colspan=\\\"2\\\"&gt;\\n        &lt;br&gt;&lt;h3 style=\\\"color: rgb(68,114,196)\\\"&gt;INCIDENT DESCRIPTION&lt;/h3&gt;\\n        &lt;hr size=\\\"1\\\" width=\\\"100%\\\" noshade style=\\\"color:#FFDF57\\\" align=\\\"center\\\"/&gt;\\n    &lt;/td&gt;\\n&lt;/tr&gt;\\n    {{ get_row('Description:','description') }}\\n&lt;tr&gt;\\n    &lt;td width=\\\"100\\\" style=\\\"{{style}}; font-weight:bold\\\"&gt;Incident link&lt;/td&gt;\\n    {% set inc_url = template_helper.generate_incident_url(incident.id) -%}\\n    &lt;td style=\\\"{{style}}\\\"&gt;&lt;a target=\\\"_blank\\\" href=\\\"{{ inc_url }}\\\"&gt;{{ incident.id }}: {{ incident.name }}&lt;/a&gt;&lt;/td&gt;\\n&lt;/tr&gt;\\n&lt;/table&gt;\\n&lt;br&gt;\\n\\\"\\\"\\\"\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"outbound_email_results\"}</resilient:function></extensionElements><incoming>Flow_0gxfhzb</incoming><outgoing>Flow_1yaw3vu</outgoing></serviceTask><sequenceFlow id=\"Flow_0gxfhzb\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/><scriptTask id=\"ScriptTask_2\" name=\"Save Outbound Email Results\"><extensionElements><resilient:script uuid=\"7744a945-4634-43eb-8558-a3658c865f03\"/></extensionElements><incoming>Flow_1yaw3vu</incoming><outgoing>Flow_1n7vfe6</outgoing><script>script</script></scriptTask><sequenceFlow id=\"Flow_1yaw3vu\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_1n7vfe6</incoming></endEvent><sequenceFlow id=\"Flow_1n7vfe6\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_0gxfhzb\" id=\"Flow_0gxfhzb_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"218\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1yaw3vu\" id=\"Flow_1yaw3vu_di\"><omgdi:waypoint x=\"721\" y=\"302\"/><omgdi:waypoint x=\"721\" y=\"418\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1n7vfe6\" id=\"Flow_1n7vfe6_di\"><omgdi:waypoint x=\"721\" y=\"502\"/><omgdi:waypoint x=\"721\" y=\"634\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"218\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"418\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"634\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1691474717221, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "description": {"format": "text", "content": "Send an HTML-formatted email containing Resilient Incident Details in the email body and incident attachments.  A note containing the email details is posted to the incident."}, "display_name": "Send Email (PB)", "export_key": "send_email_pb", "field_type_handle": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "fields_type": {"actions": [], "display_name": "Send Email (PB)", "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "fields": {"mail_attachments": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_attachments", "hide_notification": false, "id": 1935, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_attachments", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Attachments", "tooltip": "comma separated list of attachments for '*' for all", "type_id": 1179, "uuid": "b9ea231e-323f-40a7-aadd-51483c966228", "values": []}, "mail_body": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_body", "hide_notification": false, "id": 1936, "input_type": "textarea", "internal": false, "is_tracked": false, "name": "mail_body", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Message body", "tooltip": "", "type_id": 1179, "uuid": "ce7682b7-33ea-4dda-ad50-a348a0cfc29b", "values": []}, "mail_cc": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_cc", "hide_notification": false, "id": 1937, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_cc", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "CC", "tooltip": "", "type_id": 1179, "uuid": "bd828e2e-5bd4-4569-b6eb-aa1d7db92097", "values": []}, "mail_importance": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_importance", "hide_notification": false, "id": 1938, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_importance", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Importance", "tooltip": "", "type_id": 1179, "uuid": "360cb032-af01-43e3-b57e-9d94a4128707", "values": [{"default": false, "enabled": true, "hidden": false, "label": "high", "properties": null, "uuid": "2d271905-83c9-41fc-b971-b3ee95391bed", "value": 958}, {"default": true, "enabled": true, "hidden": false, "label": "normal", "properties": null, "uuid": "bafa604a-f999-427b-bb01-596eb44bd256", "value": 959}, {"default": false, "enabled": true, "hidden": false, "label": "low", "properties": null, "uuid": "3e40d36e-a054-4085-9b7a-b2db5766f3b7", "value": 960}]}, "mail_in_reply_to": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_in_reply_to", "hide_notification": false, "id": 1939, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_in_reply_to", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Use in-reply-to", "tooltip": "Use the message_id of the original email associated with this incident", "type_id": 1179, "uuid": "0210f389-4d54-479b-914d-3c3dec200dbb", "values": []}, "mail_message_id": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_message_id", "hide_notification": false, "id": 1940, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_message_id", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Generate message-id", "tooltip": "generate a message id for this message", "type_id": 1179, "uuid": "9603dceb-1517-4033-8e6c-bf151e0e7047", "values": []}, "mail_subject": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_subject", "hide_notification": false, "id": 1941, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_subject", "operation_perms": {}, "operations": [], "placeholder": "Empty subject will default to workflow script", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Subject", "tooltip": "", "type_id": 1179, "uuid": "0df1adfa-f0d3-409b-afcb-532100a73d39", "values": []}, "mail_template_select": {"allow_default_value": false, "blank_option": true, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_template_select", "hide_notification": false, "id": 1942, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_template_select", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Template label", "tooltip": "", "type_id": 1179, "uuid": "8b2664de-981e-4000-903b-28106b5ab6b9", "values": [{"default": false, "enabled": true, "hidden": false, "label": "TemplateName1", "properties": null, "uuid": "49f16095-d63f-46f3-9b35-426bceaf9f55", "value": 961}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName2", "properties": null, "uuid": "6dd8c42b-b12d-42b9-a8b3-2ba0112bdb12", "value": 962}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName3", "properties": null, "uuid": "245a9745-cb6c-4a83-b6db-b539339fce48", "value": 963}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName4", "properties": null, "uuid": "d8afa931-97a3-4548-92d6-9aed3a399571", "value": 964}]}}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "uuid": "42fbea69-e9e0-434b-8be0-3f950fba659c"}, "has_logical_errors": false, "id": 135, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1691474997562, "local_scripts": [], "manual_settings": {"activation_conditions": {"conditions": [{"evaluation_id": null, "field_name": "artifact.type", "method": "in", "type": null, "value": ["Email Sender", "Email Recipient"]}], "logic_type": "all"}, "view_items": [{"content": "bd828e2e-5bd4-4569-b6eb-aa1d7db92097", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "0df1adfa-f0d3-409b-afcb-532100a73d39", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "ce7682b7-33ea-4dda-ad50-a348a0cfc29b", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "b9ea231e-323f-40a7-aadd-51483c966228", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "9603dceb-1517-4033-8e6c-bf151e0e7047", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "0210f389-4d54-479b-914d-3c3dec200dbb", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "360cb032-af01-43e3-b57e-9d94a4128707", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "8b2664de-981e-4000-903b-28106b5ab6b9", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}]}, "name": "send_email_pb", "object_type": "artifact", "status": "draft", "tag": {"display_name": "Playbook_e07483e5-f077-4297-b8eb-10f9ed3fbbe2", "id": 186, "name": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "type": "playbook", "uuid": "bee268f8-58f9-4946-b16d-0f552d1e6485"}, "tags": [], "type": "default", "uuid": "e07483e5-f077-4297-b8eb-10f9ed3fbbe2", "version": 5}, {"activation_type": "manual", "content": {"content_version": 1, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854\" isExecutable=\"true\" name=\"playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_1eva8rw</outgoing></startEvent><serviceTask id=\"ServiceTask_1\" name=\"Outbound Email: Send Email 2\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"bb874b84-b405-40ba-abed-5f7c594f2a99\">{\"inputs\":{\"9f9dde5a-65a6-4e39-81f5-53242747b03b\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"5df194d5-7f42-494b-8bf0-219d6ffc56ee\"}},\"e09789bf-057c-4914-9877-455fb11e3f4d\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"fdbcda16-d6f2-48d1-86d7-804e25890bc1\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"a4bfd9f7-f924-4289-8bb2-fd2e3c577eb4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"124e74e9-a891-442a-b257-7d79b0eeed45\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"3864ba99-ae8c-4926-9b76-9e8e691696f5\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"d343f80b-4760-4f4a-b492-bf85dfc29261\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"c6b538ef-a2e0-49b9-abe3-4a45339db160\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"823bffa7-4f34-4eda-8ba2-7a714d236ad7\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"1f86c63b-9f1e-46e5-a865-66fff55a1af4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"dde2204d-ab55-4817-98de-2013158e7687\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"77ebe14e-2028-4f38-b66e-c3566fdf1425\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"09f822a2-50a3-4556-8af0-e86ad8b072ea\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"e8fa561a-aea1-42f7-8b9e-4615ff4046fa\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}}},\"pre_processing_script\":\"import hashlib\\nimport time\\n\\nMESSAGE_ID_DOMAIN = \\\"soar-demo.mumaw-lab.net\\\"\\n\\ninputs.mail_to = playbook.inputs.mail_to\\ninputs.mail_cc = playbook.inputs.mail_cc\\ninputs.mail_attachments = playbook.inputs.mail_attachments\\ninputs.mail_incident_id = incident.id\\ninputs.mail_from = 'SOAR-Mumaw@outlook.com'\\ninputs.mail_subject = \\\"{0} (ID: {1})\\\".format(incident.name, incident.id) if not playbook.inputs.mail_subject else playbook.inputs.mail_subject + ' (ID: {})'.format(incident.id)\\ninputs.mail_importance = playbook.inputs.mail_importance if playbook.inputs.mail_importance else None\\n\\nif playbook.inputs.mail_message_id:\\n  # generate a message-id\\n  seed_value = str(int(time.time()*1000))\\n  uuid_hash = hashlib.md5(seed_value.encode()).hexdigest()\\n  msg_id = \\\"{}-{}-{}-{}-{}\\\".format(uuid_hash[0:8], uuid_hash[8:12], uuid_hash[12:16], uuid_hash[16:20], uuid_hash[20:])\\n  inputs.mail_message_id = \\\"{}@{}\\\".format(msg_id, MESSAGE_ID_DOMAIN)\\n  \\nif playbook.inputs.mail_in_reply_to and incident.properties.email_message_id:\\n  inputs.mail_in_reply_to = incident.properties.email_message_id\\n\\nif playbook.inputs.mail_body:\\n  inputs.mail_body = playbook.inputs.mail_body.content\\nelif playbook.inputs.mail_template_select:\\n  inputs.mail_template_label = playbook.inputs.mail_template_select\\nelse:\\n  inputs.mail_inline_template = \\\"\\\"\\\"{% set NOT_FOUND = [\\\"Not Found!\\\",\\\"-\\\",\\\"None\\\",None] -%}\\n{% set style = \\\"font-family: Calibri; color: rgb(31,73,125)\\\" -%}\\n{% macro get_row(label, field_name) -%}\\n\\t{% set value = template_helper.get_incident_value(incident,field_name) -%}\\n    {% if value and value not in NOT_FOUND and not value.startswith('-') -%}\\n    &lt;tr&gt;\\n        &lt;td width=\\\"100\\\" style=\\\"{{style}}; font-weight:bold\\\"&gt;{{ label }}&lt;/td&gt;\\n        &lt;td style=\\\"{{style}}\\\"&gt;{{ value | striptags }}&lt;/td&gt;\\n    &lt;/tr&gt;\\n    {% endif -%}\\n{% endmacro -%}\\n&lt;table width=\\\"100%\\\" &gt;\\n&lt;tr&gt;\\n    &lt;td colspan=\\\"2\\\"&gt;\\n        &lt;h3 style=\\\"color: rgb(68,114,196)\\\"&gt;INCIDENT DETAILS&lt;/h3&gt;\\n        &lt;hr size=\\\"1\\\" width=\\\"100%\\\" noshade style=\\\"color:#FFDF57\\\" align=\\\"center\\\"/&gt;\\n    &lt;/td&gt;\\n&lt;/tr&gt;\\n    {{ get_row('Incident:','severity_code') }}\\n    {{ get_row('Severity:','severity_code') }}\\n    {{ get_row('Status:','plan_status') }}&lt;br&gt;\\n    {{ get_row('Created:','create_date') }}&lt;br&gt;\\n    {{ get_row('Category:','incident_type_ids') }}\\n&lt;tr&gt;\\n    &lt;td colspan=\\\"2\\\"&gt;\\n        &lt;br&gt;&lt;h3 style=\\\"color: rgb(68,114,196)\\\"&gt;INCIDENT DESCRIPTION&lt;/h3&gt;\\n        &lt;hr size=\\\"1\\\" width=\\\"100%\\\" noshade style=\\\"color:#FFDF57\\\" align=\\\"center\\\"/&gt;\\n    &lt;/td&gt;\\n&lt;/tr&gt;\\n    {{ get_row('Description:','description') }}\\n&lt;tr&gt;\\n    &lt;td width=\\\"100\\\" style=\\\"{{style}}; font-weight:bold\\\"&gt;Incident link&lt;/td&gt;\\n    {% set inc_url = template_helper.generate_incident_url(incident.id) -%}\\n    &lt;td style=\\\"{{style}}\\\"&gt;&lt;a target=\\\"_blank\\\" href=\\\"{{ inc_url }}\\\"&gt;{{ incident.id }}: {{ incident.name }}&lt;/a&gt;&lt;/td&gt;\\n&lt;/tr&gt;\\n&lt;/table&gt;\\n&lt;br&gt;\\n\\\"\\\"\\\"\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"outbound_email_results\"}</resilient:function></extensionElements><incoming>Flow_1eva8rw</incoming><outgoing>Flow_0ulw1h7</outgoing></serviceTask><sequenceFlow id=\"Flow_1eva8rw\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/><scriptTask id=\"ScriptTask_2\" name=\"Save Outbound Email Results\"><extensionElements><resilient:script uuid=\"7744a945-4634-43eb-8558-a3658c865f03\"/></extensionElements><incoming>Flow_0ulw1h7</incoming><outgoing>Flow_10rqudw</outgoing><script>script</script></scriptTask><sequenceFlow id=\"Flow_0ulw1h7\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_10rqudw</incoming></endEvent><sequenceFlow id=\"Flow_10rqudw\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_1eva8rw\" id=\"Flow_1eva8rw_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"228\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0ulw1h7\" id=\"Flow_0ulw1h7_di\"><omgdi:waypoint x=\"721\" y=\"312\"/><omgdi:waypoint x=\"721\" y=\"428\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_10rqudw\" id=\"Flow_10rqudw_di\"><omgdi:waypoint x=\"721\" y=\"512\"/><omgdi:waypoint x=\"721\" y=\"624\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"228\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"428\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"624\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1691475035403, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "description": {"format": "text", "content": "Send an HTML-formatted email containing Resilient Incident Details in the email body and incident attachments.  A note containing the email details is posted to the incident."}, "display_name": "Send Incident Email (PB)", "export_key": "send_incident_email_pb", "field_type_handle": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "fields_type": {"actions": [], "display_name": "Send Incident Email (PB)", "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "fields": {"attachments": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/attachments", "hide_notification": false, "id": 1943, "input_type": "text", "internal": false, "is_tracked": false, "name": "attachments", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Attachments", "tooltip": "comma separated list of attachments for '*' for all", "type_id": 1180, "uuid": "6facd123-37f6-4edf-88ea-e9081e48a068", "values": []}, "mail_body": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_body", "hide_notification": false, "id": 1944, "input_type": "textarea", "internal": false, "is_tracked": false, "name": "mail_body", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Message body", "tooltip": "", "type_id": 1180, "uuid": "f746ad6c-1330-4fc6-8691-e77e7a794b50", "values": []}, "mail_cc": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_cc", "hide_notification": false, "id": 1945, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_cc", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "CC", "tooltip": "", "type_id": 1180, "uuid": "37ff36b7-e4d9-4dc2-9e49-6d8a971e8d14", "values": []}, "mail_importance": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_importance", "hide_notification": false, "id": 1946, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_importance", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Importance", "tooltip": "", "type_id": 1180, "uuid": "ad562782-d697-4fc4-a84f-5c4e87aff76a", "values": [{"default": false, "enabled": true, "hidden": false, "label": "high", "properties": null, "uuid": "f6d47535-fb9e-4992-8539-35d7dddc886d", "value": 965}, {"default": true, "enabled": true, "hidden": false, "label": "normal", "properties": null, "uuid": "449a6237-01ef-4d98-afb0-104ca334d28f", "value": 966}, {"default": false, "enabled": true, "hidden": false, "label": "low", "properties": null, "uuid": "95b2d474-029c-485a-9b79-f5234f9427c2", "value": 967}]}, "mail_in_reply_to": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_in_reply_to", "hide_notification": false, "id": 1947, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_in_reply_to", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Use in-reply-to", "tooltip": "Use the message_id of the original email associated with this incident", "type_id": 1180, "uuid": "3595c32a-a66c-48a5-ada9-859c9b42b73d", "values": []}, "mail_message_id": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_message_id", "hide_notification": false, "id": 1948, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_message_id", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Generate message-id", "tooltip": "generate a message id for this message", "type_id": 1180, "uuid": "7ac328d4-78ca-46f2-ae4b-5027bd603692", "values": []}, "mail_subject": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_subject", "hide_notification": false, "id": 1949, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_subject", "operation_perms": {}, "operations": [], "placeholder": "Empty subject will default to workflow script", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Subject", "tooltip": "", "type_id": 1180, "uuid": "1d4061b1-94a7-4c1d-9a50-bcb242a5255c", "values": []}, "mail_template_select": {"allow_default_value": false, "blank_option": true, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_template_select", "hide_notification": false, "id": 1950, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_template_select", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Template label", "tooltip": "", "type_id": 1180, "uuid": "11a09ef9-7b29-49c4-a65c-379409a4787f", "values": [{"default": false, "enabled": true, "hidden": false, "label": "TemplateName1", "properties": null, "uuid": "983393f3-0fc7-4c28-8556-0e3266b70f8a", "value": 968}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName2", "properties": null, "uuid": "a2765e5e-6802-4e45-baa4-50acd13e1f6c", "value": 969}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName3", "properties": null, "uuid": "d086737c-5a08-4ace-b24a-3ac53e80760a", "value": 970}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName4", "properties": null, "uuid": "d320666b-8a03-45ba-8dcd-34e1aa14e3a7", "value": 971}]}, "mail_to": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_to", "hide_notification": false, "id": 1951, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_to", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "required": "always", "rich_text": false, "tags": [], "templates": [], "text": "To", "tooltip": "", "type_id": 1180, "uuid": "1f23f515-d896-44ca-b2e1-4620a18a1aca", "values": []}}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "uuid": "2ab94037-9a78-44ff-ad82-f25805e7591e"}, "has_logical_errors": false, "id": 136, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1691475254287, "local_scripts": [], "manual_settings": {"activation_conditions": {"conditions": [], "logic_type": "all"}, "view_items": [{"content": "1f23f515-d896-44ca-b2e1-4620a18a1aca", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "37ff36b7-e4d9-4dc2-9e49-6d8a971e8d14", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "1d4061b1-94a7-4c1d-9a50-bcb242a5255c", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "f746ad6c-1330-4fc6-8691-e77e7a794b50", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "6facd123-37f6-4edf-88ea-e9081e48a068", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "7ac328d4-78ca-46f2-ae4b-5027bd603692", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "3595c32a-a66c-48a5-ada9-859c9b42b73d", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "ad562782-d697-4fc4-a84f-5c4e87aff76a", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "11a09ef9-7b29-49c4-a65c-379409a4787f", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}]}, "name": "send_incident_email_pb", "object_type": "incident", "status": "draft", "tag": {"display_name": "Playbook_53a9be53-dc16-43ae-b4a6-d6c22fdc5854", "id": 187, "name": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "type": "playbook", "uuid": "5e5c6045-ebff-40f4-a29d-fbf82a9fabf2"}, "tags": [], "type": "default", "uuid": "53a9be53-dc16-43ae-b4a6-d6c22fdc5854", "version": 5}, {"activation_type": "manual", "content": {"content_version": 1, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8\" isExecutable=\"true\" name=\"playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_0gb3bmk</outgoing></startEvent><serviceTask id=\"ServiceTask_1\" name=\"Outbound Email: Send Email 2\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"bb874b84-b405-40ba-abed-5f7c594f2a99\">{\"inputs\":{\"9f9dde5a-65a6-4e39-81f5-53242747b03b\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"5df194d5-7f42-494b-8bf0-219d6ffc56ee\"}},\"e09789bf-057c-4914-9877-455fb11e3f4d\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"fdbcda16-d6f2-48d1-86d7-804e25890bc1\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"a4bfd9f7-f924-4289-8bb2-fd2e3c577eb4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"124e74e9-a891-442a-b257-7d79b0eeed45\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"3864ba99-ae8c-4926-9b76-9e8e691696f5\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"d343f80b-4760-4f4a-b492-bf85dfc29261\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"c6b538ef-a2e0-49b9-abe3-4a45339db160\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"823bffa7-4f34-4eda-8ba2-7a714d236ad7\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"1f86c63b-9f1e-46e5-a865-66fff55a1af4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"dde2204d-ab55-4817-98de-2013158e7687\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"77ebe14e-2028-4f38-b66e-c3566fdf1425\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"09f822a2-50a3-4556-8af0-e86ad8b072ea\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"e8fa561a-aea1-42f7-8b9e-4615ff4046fa\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}}},\"pre_processing_script\":\"import hashlib\\nimport time\\nfrom datetime import datetime\\n\\nMESSAGE_ID_DOMAIN = \\\"soar-demo.mumaw-lab.net\\\"\\n\\ninputs.mail_to = playbook.inputs.mail_to\\ninputs.mail_cc = playbook.inputs.mail_cc\\ninputs.mail_attachments = playbook.inputs.mail_attachments\\ninputs.mail_incident_id = incident.id\\ninputs.mail_from = 'SOAR-Mumaw@outlook.com'\\ninputs.mail_subject = \\\"{0} [Task: {1}] (ID: {2})\\\".format(incident.name, task.name, incident.id)\\ninputs.mail_importance = playbook.inputs.mail_importance if playbook.inputs.mail_importance else None\\n\\nif playbook.inputs.mail_message_id:\\n  # generate a message-id\\n  seed_value = str(int(time.time()*1000))\\n  uuid_hash = hashlib.md5(seed_value.encode()).hexdigest()\\n  msg_id = \\\"{}-{}-{}-{}-{}\\\".format(uuid_hash[0:8], uuid_hash[8:12], uuid_hash[12:16], uuid_hash[16:20], uuid_hash[20:])\\n  inputs.mail_message_id = \\\"{}@{}\\\".format(msg_id, MESSAGE_ID_DOMAIN)\\n  \\nif playbook.inputs.mail_in_reply_to and incident.properties.email_message_id:\\n  inputs.mail_in_reply_to = incident.properties.email_message_id\\n\\ncreation_date = datetime.fromtimestamp( incident.create_date/1000)\\ntype_ids = u\\\", \\\".join(incident.incident_type_ids)\\nsev_code = u\\\"{}\\\".format(incident.severity_code)\\ncurrent_plan = u\\\"{}\\\".format(incident.plan_status)\\n\\nif playbook.inputs.mail_template_select:\\n  inputs.mail_template_label = playbook.inputs.mail_template_select\\nelse:\\n  inputs.mail_inline_template = u\\\"\\\"\\\"\\n&lt;h2&gt;Incident Summary&lt;/h2&gt;\\n    Severity Code: {0}\\n&lt;br&gt;\\n    Plan Status: {1}\\n&lt;br&gt;\\n    Created: {2}\\n&lt;br&gt;\\n    Incident Type: {3}\\n&lt;br&gt;\\n    Incident Link: &lt;a target='_blank' href='{{{{ template_helper.generate_incident_url({5}) }}}}'&gt;{5}&lt;/a&gt;\\n&lt;br&gt;\\n    Task: &lt;a target='_blank' href='{{{{ template_helper.generate_task_url({5},{6}) }}}}'&gt;{4}&lt;/a&gt;\\n&lt;br&gt;\\n    Instructions: \\n&lt;br&gt;\\n{7}\\n\\\"\\\"\\\".format(sev_code, current_plan, creation_date, type_ids, task.name, incident.id, task.id, task.instructions.get(\\\"content\\\") if task.instructions else '-')\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"outbound_email_results\"}</resilient:function></extensionElements><incoming>Flow_0gb3bmk</incoming><outgoing>Flow_1rs2s62</outgoing></serviceTask><sequenceFlow id=\"Flow_0gb3bmk\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/><scriptTask id=\"ScriptTask_2\" name=\"Save Outbound Email Results\"><extensionElements><resilient:script uuid=\"7744a945-4634-43eb-8558-a3658c865f03\"/></extensionElements><incoming>Flow_1rs2s62</incoming><outgoing>Flow_1fes6dl</outgoing><script>script</script></scriptTask><sequenceFlow id=\"Flow_1rs2s62\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_1fes6dl</incoming></endEvent><sequenceFlow id=\"Flow_1fes6dl\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_0gb3bmk\" id=\"Flow_0gb3bmk_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"208\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1rs2s62\" id=\"Flow_1rs2s62_di\"><omgdi:waypoint x=\"721\" y=\"292\"/><omgdi:waypoint x=\"721\" y=\"388\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1fes6dl\" id=\"Flow_1fes6dl_di\"><omgdi:waypoint x=\"721\" y=\"472\"/><omgdi:waypoint x=\"721\" y=\"564\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"161.48329999999999\" x=\"640\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"208\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"388\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"564\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1691475289915, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8", "description": {"format": "text", "content": "Send email based on a task with optional attachments"}, "display_name": "Send Task Email (PB)", "export_key": "send_task_email_pb", "field_type_handle": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8", "fields_type": {"actions": [], "display_name": "Send Task Email (PB)", "export_key": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8", "fields": {"mail_attachments": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8/mail_attachments", "hide_notification": false, "id": 1952, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_attachments", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Attachments", "tooltip": "comma separated list of attachments for '*' for all", "type_id": 1181, "uuid": "c11c38f1-7b99-4926-8642-02487e2e0e4b", "values": []}, "mail_cc": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8/mail_cc", "hide_notification": false, "id": 1953, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_cc", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "CC", "tooltip": "", "type_id": 1181, "uuid": "c6d58b1f-befe-4c30-baba-540ddffa019c", "values": []}, "mail_importance": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8/mail_importance", "hide_notification": false, "id": 1954, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_importance", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Importance", "tooltip": "", "type_id": 1181, "uuid": "229bb1b2-5f5c-4c50-ae42-1877589fcff5", "values": [{"default": false, "enabled": true, "hidden": false, "label": "high", "properties": null, "uuid": "48f4042c-12b5-4f0d-9166-8d4b3fb92efc", "value": 972}, {"default": true, "enabled": true, "hidden": false, "label": "normal", "properties": null, "uuid": "92b9a1b0-f771-4ce0-93a7-5dd416ddedb5", "value": 973}, {"default": false, "enabled": true, "hidden": false, "label": "low", "properties": null, "uuid": "23dc50e4-9c33-4b80-b3a1-09dfe0a35e45", "value": 974}]}, "mail_in_reply_to": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8/mail_in_reply_to", "hide_notification": false, "id": 1955, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_in_reply_to", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Use in-reply-to", "tooltip": "Use the message_id of the original email associated with this incident", "type_id": 1181, "uuid": "4aee63d1-f978-4032-9939-3bed8e108dc2", "values": []}, "mail_message_id": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8/mail_message_id", "hide_notification": false, "id": 1956, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_message_id", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Generate message-id", "tooltip": "generate a message id for this message", "type_id": 1181, "uuid": "d9ca4fcf-c9f4-490b-88d1-51b9bd30319a", "values": []}, "mail_template_select": {"allow_default_value": false, "blank_option": true, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8/mail_template_select", "hide_notification": false, "id": 1957, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_template_select", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Template label", "tooltip": "", "type_id": 1181, "uuid": "d649bf04-b5cc-4362-ac4f-edea1f9f7853", "values": [{"default": false, "enabled": true, "hidden": false, "label": "TemplateName1", "properties": null, "uuid": "01c9cff6-59c1-4e8d-b826-71f0874bb4dc", "value": 975}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName2", "properties": null, "uuid": "f45faaf4-2b6e-4578-914f-ac8a5ff2db95", "value": 976}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName3", "properties": null, "uuid": "a3a28b9e-415d-4e24-b2ca-080f07d5ad4d", "value": 977}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName4", "properties": null, "uuid": "6553d21c-8628-4e12-bce0-adda4dc3ef02", "value": 978}]}, "mail_to": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8/mail_to", "hide_notification": false, "id": 1958, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_to", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "required": "always", "rich_text": false, "tags": [], "templates": [], "text": "To", "tooltip": "", "type_id": 1181, "uuid": "406013d1-f291-44b3-9417-2a082f5cc92b", "values": []}}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8", "uuid": "cc66fd74-dada-45dd-82cb-fff667dc20e5"}, "has_logical_errors": false, "id": 137, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1691475533928, "local_scripts": [], "manual_settings": {"activation_conditions": {"conditions": [], "logic_type": "all"}, "view_items": [{"content": "406013d1-f291-44b3-9417-2a082f5cc92b", "element": "field_uuid", "field_type": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "c6d58b1f-befe-4c30-baba-540ddffa019c", "element": "field_uuid", "field_type": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "c11c38f1-7b99-4926-8642-02487e2e0e4b", "element": "field_uuid", "field_type": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "d9ca4fcf-c9f4-490b-88d1-51b9bd30319a", "element": "field_uuid", "field_type": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "4aee63d1-f978-4032-9939-3bed8e108dc2", "element": "field_uuid", "field_type": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "229bb1b2-5f5c-4c50-ae42-1877589fcff5", "element": "field_uuid", "field_type": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "d649bf04-b5cc-4362-ac4f-edea1f9f7853", "element": "field_uuid", "field_type": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8", "show_if": null, "show_link_header": false, "step_label": null}]}, "name": "send_task_email_pb", "object_type": "task", "status": "draft", "tag": {"display_name": "Playbook_3a27fbfa-a1be-43db-bd7c-6a135131b9d8", "id": 188, "name": "playbook_3a27fbfa_a1be_43db_bd7c_6a135131b9d8", "type": "playbook", "uuid": "d53f4fdc-ac8a-4b62-8eea-cd04f3fdbf33"}, "tags": [], "type": "default", "uuid": "3a27fbfa-a1be-43db-bd7c-6a135131b9d8", "version": 5}], "regulators": null, "roles": [], "scripts": [{"actions": [], "created_date": 1691476466448, "description": "Email Parsing script to apply responses from outbound emails back to incidents for conversation tracking.", "enabled": false, "export_key": "Conversations Email Parser", "id": 113, "language": "python3", "last_modified_by": "john_doe@company.com", "last_modified_time": 1691476466471, "name": "Conversations Email Parser", "object_type": "__emailmessage", "playbook_handle": null, "programmatic_name": "conversations_email_parser", "script_text": "import re\nfrom datetime import datetime\n\n\n# Create Functions for handling data.\ndef readable_date(res_date_time):\n    ep_date_time = res_date_time / 1000.0\n    readable_date_time = datetime.fromtimestamp(ep_date_time).strftime('%Y-%m-%d %H:%M:%S')\n    return(readable_date_time)\n\n\n# Parses out email information.\nemail_headers = emailmessage.headers\nemail_sender = emailmessage.sender\nemail_to = emailmessage.to\nemail_cc = emailmessage.cc\nemail_subject = emailmessage.subject\nemail_sent = emailmessage.sent_date\nemail_received = emailmessage.received_date\nemail_body = emailmessage.body\nemail_attachments = emailmessage.attachments\n\n\n# Establish Incident Association.\nid_regex = re.compile(r'\\(ID: (\\d+)\\)')\nincident_id = re.findall(id_regex, email_subject)\n\nif incident_id:\n    query_builder.equals(fields.incident.id, int(incident_id[0]))\n    query = query_builder.build()\n    incidents = helper.findIncidents(query)\n    emailmessage.associateWithIncident(incidents[0])\n    \nelse:\n    emailmessage.createAssociatedIncident(email_subject,'Tier 1 Analysts')\n    # Add Additional Artifacts from Email.\n    for recipient in email_to + email_cc:\n        incident.addArtifact('Email Recipient', recipient.address, \"Email Recipient Received by SOAR\")\n    incident.addArtifact('Email Sender', email_sender.address, \"Email Sender Received by SOAR\")\n    if email_sender.name:\n        incident.addArtifact('Email Sender Name', email_sender.name, \"Email Sender Received by SOAR\")\n    incident.addArtifact('Email Subject', email_subject, \"Email Subject Received by SOAR\")\n\n\n# Define Sender, To, and From in a email output fashion.\nif email_sender.get('name') and email_sender.get('name') != email_sender.address:\n    sender = \"{}: <{}>\".format(email_sender.name, email_sender.address)\nelse:\n    sender = email_sender.address\n\nif email_to:\n    to = ''\n    for recipient_to in email_to:\n        if recipient_to.get('name') and recipient_to.get('name') != recipient_to.address:\n            to = to + \"{}: <{}>\\n\".format(name=recipient_to.name, email=recipient_to.address)\n        else:\n            to = to + \"{}\\n\".format(recipient_to.address)\nelse:\n    to = 'None'\n\nif email_cc:\n    cc = ''\n    for recipient_cc in email_cc:\n        if recipient_cc.get('name') and recipient_cc.get('name') != recipient_cc.address:\n            cc = cc + \"{}: <{}>\\n\".format(recipient_cc.name,recipient_cc.address)\n        else:\n            cc = cc + \"{}\\n\".format(recipient_cc.address)\nelse:\n    cc = 'None'\n\n\n# Parse Out Attachments.\nattachments_list = []\nif email_attachments:\n    for attachment in email_attachments:\n        if not attachment.inline:\n            incident.addEmailAttachment(attachment.id)\n            attachments_list.append(attachment.suggested_filename)\n            incident.addArtifact('Email Attachment Name', attachment.suggested_filename, \"Name of Attachment received in Email.\")\n\n\n\n# Generate a new Row for Email Conversation.\nnewRow = incident.addRow('email_conversations')\nnewRow['date_sent'] = email_received\nnewRow['status'] = 'success'\nnewRow['source'] = 'inbound'\nnewRow['inbound_id'] = emailmessage.id\nnewRow['from'] = sender\nnewRow['recipients'] = \"To: {}\\nCC: {}\".format(to, cc)\nnewRow['subject'] = email_subject\nnewRow['body'] = email_body['content'].split('From: SOAR')[0]\nnewRow['attachments'] = \",\\n\".join(attachments_list)\nnewRow['message_id'] = email_headers.get('Message-ID')[0][1:-1]\n\n\n\n# Apply the Email as a Note.\nnote = \"Email Received On: {}\\nSender: {}\\nRecipient(s): {}CC: {}\\nSubject: {}\\n\\n\".format(readable_date(email_received),sender,to,cc,email_subject) + email_body['content'].split('From: SOAR')[0]\nrich_note = helper.createRichText(note)\n\nincident.addNote(rich_note)\n", "tags": [], "uuid": "352b9e98-e69d-47f2-9d04-fd174d6e96f9"}, {"actions": [], "created_date": 1691420986120, "description": "Save outbound email results in the Email Conversations datatable", "enabled": false, "export_key": "Save Outbound Email Results", "id": 104, "language": "python3", "last_modified_by": "john_doe@company.com", "last_modified_time": 1691420986210, "name": "Save Outbound Email Results", "object_type": "incident", "playbook_handle": null, "programmatic_name": "save_outbound_email_results", "script_text": "import time\n\ntry:\n  e_results = workflow.properties.outbound_email_results\nexcept:\n  try:\n    e_results = playbook.functions.results.outbound_email_results\n  except:\n    helper.fail(\"unable to read outbound_email_results property\")\n\nif e_results:\n  row = incident.addRow('email_conversations')\n  row['status'] = \"success\" if e_results.get('success') else \"failure: {}\".format(e_results.get('reason'))\n  \n  row['date_sent'] = int(time.time()*1000)\n  row['source'] = \"outbound\"\n  row['recipients'] = helper.createRichText(\"To: {}<br>Cc: {}<br>Bcc: {}\".format(e_results.get('inputs', {}).get('mail_to'), e_results.get('inputs', {}).get('mail_cc', ''), e_results.get('inputs', {}).get('mail_bcc', '')))\n  row['from'] = e_results.get('content', {}).get('mail_from') if e_results.get('content', {}).get('mail_from') else e_results.get('inputs', {}).get('mail_from')\n  row['subject'] = e_results.get('inputs', {}).get('mail_subject')\n  row['body'] = e_results.get('content', {}).get('mail_body')\n  row['attachments'] = e_results.get('inputs', {}).get('mail_attachments')\n  row['importance'] = e_results.get('inputs', {}).get('mail_importance')\n  row['in_reply_to'] = e_results.get('inputs', {}).get('mail_in_reply_to')\n  row['message_id'] = e_results.get('inputs', {}).get('mail_message_id')\nelse:\n  incident.addNote(\"workflow/playbook properties 'outbound_email_results' not found\")\n  ", "tags": [], "uuid": "7744a945-4634-43eb-8558-a3658c865f03"}], "server_version": {"build_number": 8131, "major": 46, "minor": 0, "version": "46.0.8131"}, "tags": [], "task_order": [], "timeframes": null, "types": [], "workflows": [], "workspaces": []}