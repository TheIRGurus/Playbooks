{"action_order": [], "actions": [{"automations": [{"scripts_to_run": "Conversations Email Parser", "type": "run_script", "value": null}], "conditions": [{"evaluation_id": null, "field_name": "__emailmessage.subject", "method": "contains", "type": null, "value": "(ID:"}, {"evaluation_id": null, "field_name": null, "method": "object_added", "type": null, "value": null}], "enabled": true, "export_key": "Conversation Response Parser", "id": 439, "logic_type": "all", "message_destinations": [], "name": "Conversation Response Parser", "object_type": "__emailmessage", "tags": [], "timeout_seconds": 86400, "type": 0, "uuid": "f4b237d3-6a22-4019-8251-8e912b62c39d", "view_items": [], "workflows": []}], "apps": [], "automatic_tasks": [], "export_date": 1698109961696, "export_format_version": 2, "export_type": null, "fields": [{"export_key": "incident/internal_customizations_field", "id": 0, "input_type": "text", "internal": true, "name": "internal_customizations_field", "read_only": true, "text": "Customizations Field (internal)", "type_id": 0, "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa1"}], "functions": [], "geos": null, "groups": null, "id": 53, "inbound_destinations": [], "inbound_mailboxes": null, "incident_artifact_types": [], "incident_types": [{"update_date": 1698109957410, "create_date": 1698109957410, "uuid": "bfeec2d4-3770-11e8-ad39-4a0004044aa0", "description": "Customization Packages (internal)", "export_key": "Customization Packages (internal)", "name": "Customization Packages (internal)", "enabled": false, "system": false, "parent_id": null, "hidden": false, "id": 0}], "industries": null, "layouts": [], "locale": null, "message_destinations": [], "notifications": null, "overrides": null, "phases": [], "playbooks": [{"activation_type": "manual", "content": {"content_version": 4, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_225e0cd5_adbc_43e0_8170_643783485331\" isExecutable=\"true\" name=\"playbook_225e0cd5_adbc_43e0_8170_643783485331\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_0ks116m</outgoing></startEvent><serviceTask id=\"ServiceTask_1\" name=\"Outbound Email: Send Email 2\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"bb874b84-b405-40ba-abed-5f7c594f2a99\">{\"inputs\":{\"9f9dde5a-65a6-4e39-81f5-53242747b03b\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"5df194d5-7f42-494b-8bf0-219d6ffc56ee\"}},\"e09789bf-057c-4914-9877-455fb11e3f4d\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"fdbcda16-d6f2-48d1-86d7-804e25890bc1\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"a4bfd9f7-f924-4289-8bb2-fd2e3c577eb4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"124e74e9-a891-442a-b257-7d79b0eeed45\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"3864ba99-ae8c-4926-9b76-9e8e691696f5\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"d343f80b-4760-4f4a-b492-bf85dfc29261\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"c6b538ef-a2e0-49b9-abe3-4a45339db160\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"823bffa7-4f34-4eda-8ba2-7a714d236ad7\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"1f86c63b-9f1e-46e5-a865-66fff55a1af4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"dde2204d-ab55-4817-98de-2013158e7687\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"77ebe14e-2028-4f38-b66e-c3566fdf1425\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"09f822a2-50a3-4556-8af0-e86ad8b072ea\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"e8fa561a-aea1-42f7-8b9e-4615ff4046fa\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"d0ad610c-53ad-4288-a506-c638df53b4d3\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}}},\"pre_processing_script\":\"import hashlib\\nimport time\\nfrom datetime import datetime\\n\\nMESSAGE_ID_DOMAIN = \\\"&lt;::system.fqdn.com::&gt;\\\"\\nsender_email = '&lt;::sender_email@domain.com::&gt;'\\n\\nsubject = \\\"re: {}\\\".format(row['subject']) if '(ID: {})'.format(incident.id) in row['subject'] else \\\"re: {} (ID: {})\\\".format(row['subject'], incident.id)\\n\\ninputs.mail_to = row['from']\\ninputs.mail_cc = playbook.inputs.mail_cc\\ninputs.mail_encryption_recipients = None\\ninputs.mail_attachments = playbook.inputs.mail_attachments\\ninputs.mail_incident_id = incident.id\\ninputs.mail_from = sender_email\\ninputs.mail_subject = subject\\ninputs.mail_importance = playbook.inputs.mail_importance if playbook.inputs.mail_importance else 'normal'\\n\\nif playbook.inputs.mail_message_id:\\n  # generate a message-id\\n  seed_value = str(int(time.time()*1000))\\n  uuid_hash = hashlib.md5(seed_value.encode()).hexdigest()\\n  msg_id = \\\"{}-{}-{}-{}-{}\\\".format(uuid_hash[0:8], uuid_hash[8:12], uuid_hash[12:16], uuid_hash[16:20], uuid_hash[20:])\\n  inputs.mail_message_id = \\\"{}@{}\\\".format(msg_id, MESSAGE_ID_DOMAIN)\\n\\ninputs.mail_in_reply_to = row['message_id']\\n\\nif playbook.inputs.mail_body.content:\\n  inputs.mail_inline_template = \\\"\\\"\\\"&lt;!doctype html&gt;\\n&lt;html&gt;\\n  &lt;head&gt;\\n    &lt;meta name=\\\"viewport\\\" content=\\\"width=device-width\\\" /&gt;\\n    &lt;meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=UTF-8\\\" /&gt;\\n    &lt;title&gt;{0}&lt;/title&gt;\\n    &lt;style&gt;\\n      /* -------------------------------------\\n          GLOBAL RESETS\\n      ------------------------------------- */\\n      \\n      /*All the styling goes here*/\\n      \\n      img {{\\n        border: none;\\n        -ms-interpolation-mode: bicubic;\\n        max-width: 100%; \\n      }}\\n      body {{\\n        background-color: #f6f6f6;\\n        font-family: sans-serif;\\n        -webkit-font-smoothing: antialiased;\\n        font-size: 14px;\\n        line-height: 1.4;\\n        margin: 0;\\n        padding: 0;\\n        -ms-text-size-adjust: 100%;\\n        -webkit-text-size-adjust: 100%; \\n      }}\\n      table {{\\n        border-collapse: separate;\\n        mso-table-lspace: 0pt;\\n        mso-table-rspace: 0pt;\\n        width: 100%; }}\\n        table td {{\\n          font-family: sans-serif;\\n          font-size: 14px;\\n          vertical-align: top; \\n      }}\\n      /* -------------------------------------\\n          BODY &amp; CONTAINER\\n      ------------------------------------- */\\n      .body {{\\n        background-color: #f6f6f6;\\n        width: 100%; \\n      }}\\n      /* Set a max-width, and make it display as block so it will automatically stretch to that width, but will also shrink down on a phone or something */\\n      .container {{\\n        display: block;\\n        margin: 0 auto !important;\\n        /* makes it centered */\\n        max-width: 580px;\\n        padding: 10px;\\n        width: 580px; \\n      }}\\n      /* This should also be a block element, so that it will fill 100% of the .container */\\n      .content {{\\n        box-sizing: border-box;\\n        display: block;\\n        margin: 0 auto;\\n        max-width: 580px;\\n        padding: 10px; \\n      }}\\n      /* -------------------------------------\\n          HEADER, FOOTER, MAIN\\n      ------------------------------------- */\\n      .main {{\\n        background: #ffffff;\\n        border-radius: 3px;\\n        width: 100%; \\n      }}\\n      .wrapper {{\\n        box-sizing: border-box;\\n        padding: 20px; \\n      }}\\n      .content-block {{\\n        padding-bottom: 10px;\\n        padding-top: 10px;\\n      }}\\n      .footer {{\\n        clear: both;\\n        margin-top: 10px;\\n        text-align: center;\\n        width: 100%; \\n      }}\\n        .footer td,\\n        .footer p,\\n        .footer span,\\n        .footer a {{\\n          color: #999999;\\n          font-size: 12px;\\n          text-align: center; \\n      }}\\n      /* -------------------------------------\\n          TYPOGRAPHY\\n      ------------------------------------- */\\n      h1,\\n      h2,\\n      h3,\\n      h4 {{\\n        color: #000000;\\n        font-family: sans-serif;\\n        font-weight: 400;\\n        line-height: 1.4;\\n        margin: 0;\\n        margin-bottom: 30px; \\n      }}\\n      h1 {{\\n        font-size: 35px;\\n        font-weight: 300;\\n        text-align: center;\\n        text-transform: capitalize; \\n      }}\\n      p,\\n      ul,\\n      ol {{\\n        font-family: sans-serif;\\n        font-size: 14px;\\n        font-weight: normal;\\n        margin: 0;\\n        margin-bottom: 15px; \\n      }}\\n        p li,\\n        ul li,\\n        ol li {{\\n          list-style-position: inside;\\n          margin-left: 5px; \\n      }}\\n      a {{\\n        color: #3498db;\\n        text-decoration: underline; \\n      }}\\n      /* -------------------------------------\\n          BUTTONS\\n      ------------------------------------- */\\n      .btn {{\\n        box-sizing: border-box;\\n        width: 100%; }}\\n        .btn &gt; tbody &gt; tr &gt; td {{\\n          padding-bottom: 15px; }}\\n        .btn table {{\\n          width: auto; \\n      }}\\n        .btn table td {{\\n          background-color: #ffffff;\\n          border-radius: 5px;\\n          text-align: center; \\n      }}\\n        .btn a {{\\n          background-color: #ffffff;\\n          border: solid 1px #3498db;\\n          border-radius: 5px;\\n          box-sizing: border-box;\\n          color: #3498db;\\n          cursor: pointer;\\n          display: inline-block;\\n          font-size: 14px;\\n          font-weight: bold;\\n          margin: 0;\\n          padding: 12px 25px;\\n          text-decoration: none;\\n          text-transform: capitalize; \\n      }}\\n      .btn-primary table td {{\\n        background-color: #3498db; \\n      }}\\n      .btn-primary a {{\\n        background-color: #3498db;\\n        border-color: #3498db;\\n        color: #ffffff; \\n      }}\\n      /* -------------------------------------\\n          OTHER STYLES THAT MIGHT BE USEFUL\\n      ------------------------------------- */\\n      .last {{\\n        margin-bottom: 0; \\n      }}\\n      .first {{\\n        margin-top: 0; \\n      }}\\n      .align-center {{\\n        text-align: center; \\n      }}\\n      .align-right {{\\n        text-align: right; \\n      }}\\n      .align-left {{\\n        text-align: left; \\n      }}\\n      .clear {{\\n        clear: both; \\n      }}\\n      .mt0 {{\\n        margin-top: 0; \\n      }}\\n      .mb0 {{\\n        margin-bottom: 0; \\n      }}\\n      .preheader {{\\n        color: transparent;\\n        display: none;\\n        height: 0;\\n        max-height: 0;\\n        max-width: 0;\\n        opacity: 0;\\n        overflow: hidden;\\n        mso-hide: all;\\n        visibility: hidden;\\n        width: 0; \\n      }}\\n      .powered-by a {{\\n        text-decoration: none; \\n      }}\\n      hr {{\\n        border: 0;\\n        border-bottom: 1px solid #f6f6f6;\\n        margin: 20px 0; \\n      }}\\n      /* -------------------------------------\\n          RESPONSIVE AND MOBILE FRIENDLY STYLES\\n      ------------------------------------- */\\n      @media only screen and (max-width: 620px) {{\\n        table[class=body] h1 {{\\n          font-size: 28px !important;\\n          margin-bottom: 10px !important; \\n        }}\\n        table[class=body] p,\\n        table[class=body] ul,\\n        table[class=body] ol,\\n        table[class=body] td,\\n        table[class=body] span,\\n        table[class=body] a {{\\n          font-size: 16px !important; \\n        }}\\n        table[class=body] .wrapper,\\n        table[class=body] .article {{\\n          padding: 10px !important; \\n        }}\\n        table[class=body] .content {{\\n          padding: 0 !important; \\n        }}\\n        table[class=body] .container {{\\n          padding: 0 !important;\\n          width: 100% !important; \\n        }}\\n        table[class=body] .main {{\\n          border-left-width: 0 !important;\\n          border-radius: 0 !important;\\n          border-right-width: 0 !important; \\n        }}\\n        table[class=body] .btn table {{\\n          width: 100% !important; \\n        }}\\n        table[class=body] .btn a {{\\n          width: 100% !important; \\n        }}\\n        table[class=body] .img-responsive {{\\n          height: auto !important;\\n          max-width: 100% !important;\\n          width: auto !important; \\n        }}\\n      }}\\n      /* -------------------------------------\\n          PRESERVE THESE STYLES IN THE HEAD\\n      ------------------------------------- */\\n      @media all {{\\n        .ExternalClass {{\\n          width: 100%; \\n        }}\\n        .ExternalClass,\\n        .ExternalClass p,\\n        .ExternalClass span,\\n        .ExternalClass font,\\n        .ExternalClass td,\\n        .ExternalClass div {{\\n          line-height: 100%; \\n        }}\\n        .apple-link a {{\\n          color: inherit !important;\\n          font-family: inherit !important;\\n          font-size: inherit !important;\\n          font-weight: inherit !important;\\n          line-height: inherit !important;\\n          text-decoration: none !important; \\n        }}\\n        #MessageViewBody a {{\\n          color: inherit;\\n          text-decoration: none;\\n          font-size: inherit;\\n          font-family: inherit;\\n          font-weight: inherit;\\n          line-height: inherit;\\n        }}\\n        .btn-primary table td:hover {{\\n          background-color: #34495e !important; \\n        }}\\n        .btn-primary a:hover {{\\n          background-color: #34495e !important;\\n          border-color: #34495e !important; \\n        }} \\n      }}\\n    &lt;/style&gt;\\n  &lt;/head&gt;\\n  &lt;body class=\\\"\\\"&gt;\\n    &lt;table role=\\\"presentation\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\" class=\\\"body\\\"&gt;\\n      &lt;tr&gt;\\n        &lt;td&gt;&amp;nbsp;&lt;/td&gt;\\n        &lt;td class=\\\"container\\\"&gt;\\n          &lt;div class=\\\"content\\\"&gt;\\n\\n            &lt;!-- START CENTERED WHITE CONTAINER --&gt;\\n            &lt;table role=\\\"presentation\\\" class=\\\"main\\\"&gt;\\n\\n              &lt;!-- START MAIN CONTENT AREA --&gt;\\n              &lt;tr&gt;\\n                &lt;td class=\\\"wrapper\\\"&gt;\\n                  &lt;table role=\\\"presentation\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"&gt;\\n                    &lt;tr&gt;\\n                      &lt;td&gt;\\n                        &lt;p&gt;Hello,&lt;/p&gt;\\n                        &lt;p&gt;{1}&lt;/p&gt;\\n                        &lt;p&gt;Regards,&lt;/p&gt;\\n\\t\\t\\t\\t\\t\\t&lt;p&gt;Cyber Security Team&lt;/p&gt;\\n                      &lt;/td&gt;\\n                    &lt;/tr&gt;\\n                  &lt;/table&gt;\\n                &lt;/td&gt;\\n              &lt;/tr&gt;\\n\\n            &lt;!-- END MAIN CONTENT AREA --&gt;\\n            &lt;/table&gt;\\n            &lt;!-- END CENTERED WHITE CONTAINER --&gt;\\n\\n            &lt;!-- START FOOTER --&gt;\\n            &lt;div class=\\\"footer\\\"&gt;\\n              &lt;table role=\\\"presentation\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"&gt;\\n                &lt;tr&gt;\\n                  &lt;td class=\\\"content-block\\\"&gt;\\n                    &lt;span class=\\\"apple-link\\\"&gt;IBM US&lt;/span&gt;\\n                  &lt;/td&gt;\\n                &lt;/tr&gt;\\n                &lt;tr&gt;\\n                  &lt;td class=\\\"content-block powered-by\\\"&gt;\\n                    Powered by &lt;a href=\\\"https://www.ibm.com/products/qradar-soar\\\" target=\\\"_blank\\\"&gt;IBM SOAR&lt;/a&gt;.\\n                  &lt;/td&gt;\\n                &lt;/tr&gt;\\n              &lt;/table&gt;\\n            &lt;/div&gt;\\n            &lt;!-- END FOOTER --&gt;\\n\\n          &lt;/div&gt;\\n        &lt;/td&gt;\\n        &lt;td&gt;&amp;nbsp;&lt;/td&gt;\\n      &lt;/tr&gt;\\n    &lt;/table&gt;\\n  &lt;/body&gt;\\n&lt;/html&gt;\\n\\\"\\\"\\\".format(subject, playbook.inputs.mail_body.content)\\nelif playbook.inputs.mail_template_select:\\n  inputs.mail_template_label = playbook.inputs.mail_template_select\\nelse:\\n  helper.fail(\\\"Please provide either a template or a messgae in the Body field.\\\")\\n\\nif playbook.inputs.mail_merge_body:\\n    # Sent: Thursday, June 9, 2022, 01:03:54 PM EDT\\n    msg_sent = datetime.fromtimestamp(row['date_sent']/1000).strftime('%A, %B %d, %Y, %-I:%M:%S %p GMT')\\n    inputs.mail_merge_body = True\\n    original_email = f\\\"\\\"\\\"Sent: {msg_sent}\\n&lt;br&gt;From: {row['from']}\\n&lt;br&gt;{row['recipients'].content}\\n&lt;br&gt;Subject: {row['subject']}\\n&lt;br&gt;\\n&lt;br&gt;\\n{row['body'].content.replace(\\\"&lt;br&gt;\\\", \\\"\\\")}\\\"\\\"\\\"\\n  \\n    if inputs.mail_body:\\n        inputs.mail_body = f\\\"{inputs.mail_body}&lt;hr&gt;\\\"\\n    inputs.mail_body = f\\\"{inputs.mail_body if inputs.mail_body else ''}&lt;div style='border-left: 2px solid gray'&gt;&lt;div style='white-space: nowrap;margin-left: 5px'&gt;{original_email}&lt;/div&gt;&lt;/div&gt;\\\"\\n    \",\"pre_processing_script_language\":\"python3\",\"result_name\":\"outbound_email_results\"}</resilient:function></extensionElements><incoming>Flow_0ks116m</incoming><outgoing>Flow_1u6luam</outgoing></serviceTask><sequenceFlow id=\"Flow_0ks116m\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/><scriptTask id=\"ScriptTask_2\" name=\"Save Outbound Email Results\"><extensionElements><resilient:script uuid=\"7744a945-4634-43eb-8558-a3658c865f03\"/></extensionElements><incoming>Flow_1u6luam</incoming><outgoing>Flow_1tl0t21</outgoing><script>script</script></scriptTask><sequenceFlow id=\"Flow_1u6luam\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_1tl0t21</incoming></endEvent><sequenceFlow id=\"Flow_1tl0t21\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_225e0cd5_adbc_43e0_8170_643783485331\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_1tl0t21\" id=\"Flow_1tl0t21_di\"><omgdi:waypoint x=\"721\" y=\"482\"/><omgdi:waypoint x=\"721\" y=\"594\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1u6luam\" id=\"Flow_1u6luam_di\"><omgdi:waypoint x=\"721\" y=\"292\"/><omgdi:waypoint x=\"721\" y=\"398\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0ks116m\" id=\"Flow_0ks116m_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"208\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"199.65\" x=\"621\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"208\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"398\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"594\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1698039223675, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_225e0cd5_adbc_43e0_8170_643783485331", "description": {"format": "text", "content": "Reply to a message within the email conversation"}, "display_name": "Reply to Message (PB)", "export_key": "reply_to_message_pb", "field_type_handle": "playbook_225e0cd5_adbc_43e0_8170_643783485331", "fields_type": {"actions": [], "display_name": "Reply to Message (PB)", "export_key": "playbook_225e0cd5_adbc_43e0_8170_643783485331", "fields": {"mail_attachments": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_225e0cd5_adbc_43e0_8170_643783485331/mail_attachments", "hide_notification": false, "id": 2196, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_attachments", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Attachments", "tooltip": "comma separated list of attachments for '*' for all", "type_id": 1226, "uuid": "7d9808d3-221b-43b2-bee7-50de17459990", "values": []}, "mail_body": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_225e0cd5_adbc_43e0_8170_643783485331/mail_body", "hide_notification": false, "id": 2197, "input_type": "textarea", "internal": false, "is_tracked": false, "name": "mail_body", "operation_perms": {}, "operations": [], "placeholder": "If not using a template, place message here.", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Massage Body", "tooltip": "", "type_id": 1226, "uuid": "40622750-d720-4d5d-bb63-979183cbec8d", "values": []}, "mail_cc": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_225e0cd5_adbc_43e0_8170_643783485331/mail_cc", "hide_notification": false, "id": 2198, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_cc", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "CC", "tooltip": "", "type_id": 1226, "uuid": "cad85a8e-cd78-42c0-a2d5-7e8f7f628ddf", "values": []}, "mail_importance": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_225e0cd5_adbc_43e0_8170_643783485331/mail_importance", "hide_notification": false, "id": 2199, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_importance", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Importance", "tooltip": "", "type_id": 1226, "uuid": "9955fcc4-3054-4515-b5f7-a111df28e428", "values": [{"default": false, "enabled": true, "hidden": false, "label": "high", "properties": null, "uuid": "41c84ab0-c3f4-45e0-bf1f-7e581941dc57", "value": 1139}, {"default": true, "enabled": true, "hidden": false, "label": "normal", "properties": null, "uuid": "fe12979b-7cb5-4a3c-ba48-53fbf9e678c3", "value": 1140}, {"default": false, "enabled": true, "hidden": false, "label": "low", "properties": null, "uuid": "82d22b32-528b-4a33-8602-c252a4826e8a", "value": 1141}]}, "mail_merge_body": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_225e0cd5_adbc_43e0_8170_643783485331/mail_merge_body", "hide_notification": false, "id": 2200, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_merge_body", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "required": "always", "rich_text": false, "tags": [], "templates": [], "text": "Include Original Email", "tooltip": "", "type_id": 1226, "uuid": "fa34ad39-29f6-420f-9b0b-1569d31e96a3", "values": []}, "mail_message_id": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_225e0cd5_adbc_43e0_8170_643783485331/mail_message_id", "hide_notification": false, "id": 2201, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_message_id", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Generate message-id", "tooltip": "generate a message id for this message", "type_id": 1226, "uuid": "e1c02184-bce7-4795-99fa-cfae73804500", "values": []}, "mail_template_select": {"allow_default_value": false, "blank_option": true, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_225e0cd5_adbc_43e0_8170_643783485331/mail_template_select", "hide_notification": false, "id": 2202, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_template_select", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Template label", "tooltip": "", "type_id": 1226, "uuid": "cb814c1a-ff2f-48ff-ac9f-0e878a1679b9", "values": [{"default": false, "enabled": true, "hidden": false, "label": "TemplateName1", "properties": null, "uuid": "c521d087-6094-48e1-91a4-e8c6dac87ad5", "value": 1142}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName2", "properties": null, "uuid": "5732824f-eab5-4562-926e-3a9bbe885dee", "value": 1143}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName3", "properties": null, "uuid": "2132c8a0-e60c-4e28-8be5-857f9d480145", "value": 1144}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName4", "properties": null, "uuid": "448fe62c-7f75-488b-81b7-e29015309eeb", "value": 1145}]}}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_225e0cd5_adbc_43e0_8170_643783485331", "uuid": "05efeaef-a4bb-4d85-9caa-53c6dc1e25e7"}, "has_logical_errors": false, "id": 181, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1698039637485, "local_scripts": [], "manual_settings": {"activation_conditions": {"conditions": [], "logic_type": "all"}, "view_items": [{"content": "cad85a8e-cd78-42c0-a2d5-7e8f7f628ddf", "element": "field_uuid", "field_type": "playbook_225e0cd5_adbc_43e0_8170_643783485331", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "40622750-d720-4d5d-bb63-979183cbec8d", "element": "field_uuid", "field_type": "playbook_225e0cd5_adbc_43e0_8170_643783485331", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "7d9808d3-221b-43b2-bee7-50de17459990", "element": "field_uuid", "field_type": "playbook_225e0cd5_adbc_43e0_8170_643783485331", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "e1c02184-bce7-4795-99fa-cfae73804500", "element": "field_uuid", "field_type": "playbook_225e0cd5_adbc_43e0_8170_643783485331", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "9955fcc4-3054-4515-b5f7-a111df28e428", "element": "field_uuid", "field_type": "playbook_225e0cd5_adbc_43e0_8170_643783485331", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "cb814c1a-ff2f-48ff-ac9f-0e878a1679b9", "element": "field_uuid", "field_type": "playbook_225e0cd5_adbc_43e0_8170_643783485331", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "fa34ad39-29f6-420f-9b0b-1569d31e96a3", "element": "field_uuid", "field_type": "playbook_225e0cd5_adbc_43e0_8170_643783485331", "show_if": null, "show_link_header": false, "step_label": null}]}, "name": "reply_to_message_pb", "object_type": "email_conversations", "status": "draft", "tag": {"display_name": "Playbook_225e0cd5-adbc-43e0-8170-643783485331", "id": 234, "name": "playbook_225e0cd5_adbc_43e0_8170_643783485331", "type": "playbook", "uuid": "34d8bc53-d127-4769-a787-184e2d3b59fc"}, "tags": [], "type": "default", "uuid": "225e0cd5-adbc-43e0-8170-643783485331", "version": 5}, {"activation_type": "manual", "content": {"content_version": 5, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2\" isExecutable=\"true\" name=\"playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_0gxfhzb</outgoing></startEvent><serviceTask id=\"ServiceTask_1\" name=\"Outbound Email: Send Email 2\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"bb874b84-b405-40ba-abed-5f7c594f2a99\">{\"inputs\":{\"9f9dde5a-65a6-4e39-81f5-53242747b03b\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"5df194d5-7f42-494b-8bf0-219d6ffc56ee\"}},\"e09789bf-057c-4914-9877-455fb11e3f4d\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"fdbcda16-d6f2-48d1-86d7-804e25890bc1\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"a4bfd9f7-f924-4289-8bb2-fd2e3c577eb4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"124e74e9-a891-442a-b257-7d79b0eeed45\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"3864ba99-ae8c-4926-9b76-9e8e691696f5\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"d343f80b-4760-4f4a-b492-bf85dfc29261\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"c6b538ef-a2e0-49b9-abe3-4a45339db160\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"823bffa7-4f34-4eda-8ba2-7a714d236ad7\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"1f86c63b-9f1e-46e5-a865-66fff55a1af4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"dde2204d-ab55-4817-98de-2013158e7687\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"77ebe14e-2028-4f38-b66e-c3566fdf1425\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"09f822a2-50a3-4556-8af0-e86ad8b072ea\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"e8fa561a-aea1-42f7-8b9e-4615ff4046fa\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}}},\"pre_processing_script\":\"import hashlib\\nimport time\\n\\nMESSAGE_ID_DOMAIN = \\\"&lt;::system.fqdn.com::&gt;\\\"\\nsender_email = '&lt;::sender_email@domain.com::&gt;'\\n\\nsubject = \\\"{0} (ID: {1})\\\".format(incident.name, incident.id) if not playbook.inputs.mail_subject else playbook.inputs.mail_subject + ' (ID: {})'.format(incident.id)\\n\\ninputs.mail_to = artifact.value\\ninputs.mail_cc = playbook.inputs.mail_cc\\ninputs.mail_encryption_recipients = None\\ninputs.mail_attachments = playbook.inputs.mail_attachments\\ninputs.mail_incident_id = incident.id\\ninputs.mail_from = sender_email\\ninputs.mail_subject = subject\\ninputs.mail_importance = playbook.inputs.mail_importance if playbook.inputs.mail_importance else \\\"normal\\\"\\n\\nif playbook.inputs.mail_message_id:\\n  # generate a message-id\\n  seed_value = str(int(time.time()*1000))\\n  uuid_hash = hashlib.md5(seed_value.encode()).hexdigest()\\n  msg_id = \\\"{}-{}-{}-{}-{}\\\".format(uuid_hash[0:8], uuid_hash[8:12], uuid_hash[12:16], uuid_hash[16:20], uuid_hash[20:])\\n  inputs.mail_message_id = \\\"{}@{}\\\".format(msg_id, MESSAGE_ID_DOMAIN)\\n  \\nif playbook.inputs.mail_in_reply_to and incident.properties.email_message_id:\\n  inputs.mail_in_reply_to = incident.properties.email_message_id\\n\\nif playbook.inputs.mail_body.content:\\n  inputs.mail_inline_template = \\\"\\\"\\\"&lt;!doctype html&gt;\\n&lt;html&gt;\\n  &lt;head&gt;\\n    &lt;meta name=\\\"viewport\\\" content=\\\"width=device-width\\\" /&gt;\\n    &lt;meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=UTF-8\\\" /&gt;\\n    &lt;title&gt;{0}&lt;/title&gt;\\n    &lt;style&gt;\\n      /* -------------------------------------\\n          GLOBAL RESETS\\n      ------------------------------------- */\\n      \\n      /*All the styling goes here*/\\n      \\n      img {{\\n        border: none;\\n        -ms-interpolation-mode: bicubic;\\n        max-width: 100%; \\n      }}\\n      body {{\\n        background-color: #f6f6f6;\\n        font-family: sans-serif;\\n        -webkit-font-smoothing: antialiased;\\n        font-size: 14px;\\n        line-height: 1.4;\\n        margin: 0;\\n        padding: 0;\\n        -ms-text-size-adjust: 100%;\\n        -webkit-text-size-adjust: 100%; \\n      }}\\n      table {{\\n        border-collapse: separate;\\n        mso-table-lspace: 0pt;\\n        mso-table-rspace: 0pt;\\n        width: 100%; }}\\n        table td {{\\n          font-family: sans-serif;\\n          font-size: 14px;\\n          vertical-align: top; \\n      }}\\n      /* -------------------------------------\\n          BODY &amp; CONTAINER\\n      ------------------------------------- */\\n      .body {{\\n        background-color: #f6f6f6;\\n        width: 100%; \\n      }}\\n      /* Set a max-width, and make it display as block so it will automatically stretch to that width, but will also shrink down on a phone or something */\\n      .container {{\\n        display: block;\\n        margin: 0 auto !important;\\n        /* makes it centered */\\n        max-width: 580px;\\n        padding: 10px;\\n        width: 580px; \\n      }}\\n      /* This should also be a block element, so that it will fill 100% of the .container */\\n      .content {{\\n        box-sizing: border-box;\\n        display: block;\\n        margin: 0 auto;\\n        max-width: 580px;\\n        padding: 10px; \\n      }}\\n      /* -------------------------------------\\n          HEADER, FOOTER, MAIN\\n      ------------------------------------- */\\n      .main {{\\n        background: #ffffff;\\n        border-radius: 3px;\\n        width: 100%; \\n      }}\\n      .wrapper {{\\n        box-sizing: border-box;\\n        padding: 20px; \\n      }}\\n      .content-block {{\\n        padding-bottom: 10px;\\n        padding-top: 10px;\\n      }}\\n      .footer {{\\n        clear: both;\\n        margin-top: 10px;\\n        text-align: center;\\n        width: 100%; \\n      }}\\n        .footer td,\\n        .footer p,\\n        .footer span,\\n        .footer a {{\\n          color: #999999;\\n          font-size: 12px;\\n          text-align: center; \\n      }}\\n      /* -------------------------------------\\n          TYPOGRAPHY\\n      ------------------------------------- */\\n      h1,\\n      h2,\\n      h3,\\n      h4 {{\\n        color: #000000;\\n        font-family: sans-serif;\\n        font-weight: 400;\\n        line-height: 1.4;\\n        margin: 0;\\n        margin-bottom: 30px; \\n      }}\\n      h1 {{\\n        font-size: 35px;\\n        font-weight: 300;\\n        text-align: center;\\n        text-transform: capitalize; \\n      }}\\n      p,\\n      ul,\\n      ol {{\\n        font-family: sans-serif;\\n        font-size: 14px;\\n        font-weight: normal;\\n        margin: 0;\\n        margin-bottom: 15px; \\n      }}\\n        p li,\\n        ul li,\\n        ol li {{\\n          list-style-position: inside;\\n          margin-left: 5px; \\n      }}\\n      a {{\\n        color: #3498db;\\n        text-decoration: underline; \\n      }}\\n      /* -------------------------------------\\n          BUTTONS\\n      ------------------------------------- */\\n      .btn {{\\n        box-sizing: border-box;\\n        width: 100%; }}\\n        .btn &gt; tbody &gt; tr &gt; td {{\\n          padding-bottom: 15px; }}\\n        .btn table {{\\n          width: auto; \\n      }}\\n        .btn table td {{\\n          background-color: #ffffff;\\n          border-radius: 5px;\\n          text-align: center; \\n      }}\\n        .btn a {{\\n          background-color: #ffffff;\\n          border: solid 1px #3498db;\\n          border-radius: 5px;\\n          box-sizing: border-box;\\n          color: #3498db;\\n          cursor: pointer;\\n          display: inline-block;\\n          font-size: 14px;\\n          font-weight: bold;\\n          margin: 0;\\n          padding: 12px 25px;\\n          text-decoration: none;\\n          text-transform: capitalize; \\n      }}\\n      .btn-primary table td {{\\n        background-color: #3498db; \\n      }}\\n      .btn-primary a {{\\n        background-color: #3498db;\\n        border-color: #3498db;\\n        color: #ffffff; \\n      }}\\n      /* -------------------------------------\\n          OTHER STYLES THAT MIGHT BE USEFUL\\n      ------------------------------------- */\\n      .last {{\\n        margin-bottom: 0; \\n      }}\\n      .first {{\\n        margin-top: 0; \\n      }}\\n      .align-center {{\\n        text-align: center; \\n      }}\\n      .align-right {{\\n        text-align: right; \\n      }}\\n      .align-left {{\\n        text-align: left; \\n      }}\\n      .clear {{\\n        clear: both; \\n      }}\\n      .mt0 {{\\n        margin-top: 0; \\n      }}\\n      .mb0 {{\\n        margin-bottom: 0; \\n      }}\\n      .preheader {{\\n        color: transparent;\\n        display: none;\\n        height: 0;\\n        max-height: 0;\\n        max-width: 0;\\n        opacity: 0;\\n        overflow: hidden;\\n        mso-hide: all;\\n        visibility: hidden;\\n        width: 0; \\n      }}\\n      .powered-by a {{\\n        text-decoration: none; \\n      }}\\n      hr {{\\n        border: 0;\\n        border-bottom: 1px solid #f6f6f6;\\n        margin: 20px 0; \\n      }}\\n      /* -------------------------------------\\n          RESPONSIVE AND MOBILE FRIENDLY STYLES\\n      ------------------------------------- */\\n      @media only screen and (max-width: 620px) {{\\n        table[class=body] h1 {{\\n          font-size: 28px !important;\\n          margin-bottom: 10px !important; \\n        }}\\n        table[class=body] p,\\n        table[class=body] ul,\\n        table[class=body] ol,\\n        table[class=body] td,\\n        table[class=body] span,\\n        table[class=body] a {{\\n          font-size: 16px !important; \\n        }}\\n        table[class=body] .wrapper,\\n        table[class=body] .article {{\\n          padding: 10px !important; \\n        }}\\n        table[class=body] .content {{\\n          padding: 0 !important; \\n        }}\\n        table[class=body] .container {{\\n          padding: 0 !important;\\n          width: 100% !important; \\n        }}\\n        table[class=body] .main {{\\n          border-left-width: 0 !important;\\n          border-radius: 0 !important;\\n          border-right-width: 0 !important; \\n        }}\\n        table[class=body] .btn table {{\\n          width: 100% !important; \\n        }}\\n        table[class=body] .btn a {{\\n          width: 100% !important; \\n        }}\\n        table[class=body] .img-responsive {{\\n          height: auto !important;\\n          max-width: 100% !important;\\n          width: auto !important; \\n        }}\\n      }}\\n      /* -------------------------------------\\n          PRESERVE THESE STYLES IN THE HEAD\\n      ------------------------------------- */\\n      @media all {{\\n        .ExternalClass {{\\n          width: 100%; \\n        }}\\n        .ExternalClass,\\n        .ExternalClass p,\\n        .ExternalClass span,\\n        .ExternalClass font,\\n        .ExternalClass td,\\n        .ExternalClass div {{\\n          line-height: 100%; \\n        }}\\n        .apple-link a {{\\n          color: inherit !important;\\n          font-family: inherit !important;\\n          font-size: inherit !important;\\n          font-weight: inherit !important;\\n          line-height: inherit !important;\\n          text-decoration: none !important; \\n        }}\\n        #MessageViewBody a {{\\n          color: inherit;\\n          text-decoration: none;\\n          font-size: inherit;\\n          font-family: inherit;\\n          font-weight: inherit;\\n          line-height: inherit;\\n        }}\\n        .btn-primary table td:hover {{\\n          background-color: #34495e !important; \\n        }}\\n        .btn-primary a:hover {{\\n          background-color: #34495e !important;\\n          border-color: #34495e !important; \\n        }} \\n      }}\\n    &lt;/style&gt;\\n  &lt;/head&gt;\\n  &lt;body class=\\\"\\\"&gt;\\n    &lt;table role=\\\"presentation\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\" class=\\\"body\\\"&gt;\\n      &lt;tr&gt;\\n        &lt;td&gt;&amp;nbsp;&lt;/td&gt;\\n        &lt;td class=\\\"container\\\"&gt;\\n          &lt;div class=\\\"content\\\"&gt;\\n\\n            &lt;!-- START CENTERED WHITE CONTAINER --&gt;\\n            &lt;table role=\\\"presentation\\\" class=\\\"main\\\"&gt;\\n\\n              &lt;!-- START MAIN CONTENT AREA --&gt;\\n              &lt;tr&gt;\\n                &lt;td class=\\\"wrapper\\\"&gt;\\n                  &lt;table role=\\\"presentation\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"&gt;\\n                    &lt;tr&gt;\\n                      &lt;td&gt;\\n                        &lt;p&gt;Hello,&lt;/p&gt;\\n                        &lt;p&gt;{1}&lt;/p&gt;\\n                        &lt;p&gt;Regards,&lt;/p&gt;\\n\\t\\t\\t\\t\\t\\t&lt;p&gt;Cyber Security Team&lt;/p&gt;\\n                      &lt;/td&gt;\\n                    &lt;/tr&gt;\\n                  &lt;/table&gt;\\n                &lt;/td&gt;\\n              &lt;/tr&gt;\\n\\n            &lt;!-- END MAIN CONTENT AREA --&gt;\\n            &lt;/table&gt;\\n            &lt;!-- END CENTERED WHITE CONTAINER --&gt;\\n\\n            &lt;!-- START FOOTER --&gt;\\n            &lt;div class=\\\"footer\\\"&gt;\\n              &lt;table role=\\\"presentation\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"&gt;\\n                &lt;tr&gt;\\n                  &lt;td class=\\\"content-block\\\"&gt;\\n                    &lt;span class=\\\"apple-link\\\"&gt;IBM US&lt;/span&gt;\\n                  &lt;/td&gt;\\n                &lt;/tr&gt;\\n                &lt;tr&gt;\\n                  &lt;td class=\\\"content-block powered-by\\\"&gt;\\n                    Powered by &lt;a href=\\\"https://www.ibm.com/products/qradar-soar\\\" target=\\\"_blank\\\"&gt;IBM SOAR&lt;/a&gt;.\\n                  &lt;/td&gt;\\n                &lt;/tr&gt;\\n              &lt;/table&gt;\\n            &lt;/div&gt;\\n            &lt;!-- END FOOTER --&gt;\\n\\n          &lt;/div&gt;\\n        &lt;/td&gt;\\n        &lt;td&gt;&amp;nbsp;&lt;/td&gt;\\n      &lt;/tr&gt;\\n    &lt;/table&gt;\\n  &lt;/body&gt;\\n&lt;/html&gt;\\n\\\"\\\"\\\".format(subject, playbook.inputs.mail_body.content)\\nelif playbook.inputs.mail_template_select:\\n  inputs.mail_template_label = playbook.inputs.mail_template_label\\nelse:\\n  helper.fail(\\\"Please provide either a template or a messgae in the Body field.\\\")\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"outbound_email_results\"}</resilient:function></extensionElements><incoming>Flow_0gxfhzb</incoming><outgoing>Flow_1yaw3vu</outgoing></serviceTask><sequenceFlow id=\"Flow_0gxfhzb\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/><scriptTask id=\"ScriptTask_2\" name=\"Save Outbound Email Results\"><extensionElements><resilient:script uuid=\"7744a945-4634-43eb-8558-a3658c865f03\"/></extensionElements><incoming>Flow_1yaw3vu</incoming><outgoing>Flow_1n7vfe6</outgoing><script>script</script></scriptTask><sequenceFlow id=\"Flow_1yaw3vu\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_1n7vfe6</incoming></endEvent><sequenceFlow id=\"Flow_1n7vfe6\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_1n7vfe6\" id=\"Flow_1n7vfe6_di\"><omgdi:waypoint x=\"721\" y=\"502\"/><omgdi:waypoint x=\"721\" y=\"634\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1yaw3vu\" id=\"Flow_1yaw3vu_di\"><omgdi:waypoint x=\"721\" y=\"302\"/><omgdi:waypoint x=\"721\" y=\"418\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0gxfhzb\" id=\"Flow_0gxfhzb_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"218\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"181.4\" x=\"630\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"218\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"418\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"634\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1698039196942, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "description": {"format": "text", "content": "Send an HTML-formatted email containing Resilient Incident Details in the email body and incident attachments.  A note containing the email details is posted to the incident."}, "display_name": "Send Email (PB)", "export_key": "send_email_pb", "field_type_handle": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "fields_type": {"actions": [], "display_name": "Send Email (PB)", "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "fields": {"mail_attachments": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_attachments", "hide_notification": false, "id": 2179, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_attachments", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Attachments", "tooltip": "comma separated list of attachments for '*' for all", "type_id": 1224, "uuid": "b9ea231e-323f-40a7-aadd-51483c966228", "values": []}, "mail_body": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_body", "hide_notification": false, "id": 2180, "input_type": "textarea", "internal": false, "is_tracked": false, "name": "mail_body", "operation_perms": {}, "operations": [], "placeholder": "If not using a template, place message here.", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Message body", "tooltip": "", "type_id": 1224, "uuid": "ce7682b7-33ea-4dda-ad50-a348a0cfc29b", "values": []}, "mail_cc": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_cc", "hide_notification": false, "id": 2181, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_cc", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "CC", "tooltip": "", "type_id": 1224, "uuid": "bd828e2e-5bd4-4569-b6eb-aa1d7db92097", "values": []}, "mail_importance": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_importance", "hide_notification": false, "id": 2182, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_importance", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Importance", "tooltip": "", "type_id": 1224, "uuid": "360cb032-af01-43e3-b57e-9d94a4128707", "values": [{"default": false, "enabled": true, "hidden": false, "label": "high", "properties": null, "uuid": "2d271905-83c9-41fc-b971-b3ee95391bed", "value": 1125}, {"default": true, "enabled": true, "hidden": false, "label": "normal", "properties": null, "uuid": "bafa604a-f999-427b-bb01-596eb44bd256", "value": 1126}, {"default": false, "enabled": true, "hidden": false, "label": "low", "properties": null, "uuid": "3e40d36e-a054-4085-9b7a-b2db5766f3b7", "value": 1127}]}, "mail_in_reply_to": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_in_reply_to", "hide_notification": false, "id": 2183, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_in_reply_to", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Use in-reply-to", "tooltip": "Use the message_id of the original email associated with this incident", "type_id": 1224, "uuid": "7adc68f8-a30d-42f5-9dd7-8481e089f11d", "values": []}, "mail_message_id": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_message_id", "hide_notification": false, "id": 2184, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_message_id", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Generate message-id", "tooltip": "generate a message id for this message", "type_id": 1224, "uuid": "9603dceb-1517-4033-8e6c-bf151e0e7047", "values": []}, "mail_subject": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_subject", "hide_notification": false, "id": 2185, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_subject", "operation_perms": {}, "operations": [], "placeholder": "Empty subject will default to workflow script", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Subject", "tooltip": "", "type_id": 1224, "uuid": "0df1adfa-f0d3-409b-afcb-532100a73d39", "values": []}, "mail_template_select": {"allow_default_value": false, "blank_option": true, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2/mail_template_select", "hide_notification": false, "id": 2186, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_template_select", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Template label", "tooltip": "", "type_id": 1224, "uuid": "8b2664de-981e-4000-903b-28106b5ab6b9", "values": [{"default": false, "enabled": true, "hidden": false, "label": "TemplateName1", "properties": null, "uuid": "49f16095-d63f-46f3-9b35-426bceaf9f55", "value": 1128}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName2", "properties": null, "uuid": "6dd8c42b-b12d-42b9-a8b3-2ba0112bdb12", "value": 1129}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName3", "properties": null, "uuid": "245a9745-cb6c-4a83-b6db-b539339fce48", "value": 1130}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName4", "properties": null, "uuid": "d8afa931-97a3-4548-92d6-9aed3a399571", "value": 1131}]}}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "uuid": "42fbea69-e9e0-434b-8be0-3f950fba659c"}, "has_logical_errors": false, "id": 179, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1698039325129, "local_scripts": [], "manual_settings": {"activation_conditions": {"conditions": [{"evaluation_id": null, "field_name": "artifact.type", "method": "in", "type": null, "value": ["Email Sender", "Email Recipient"]}], "logic_type": "all"}, "view_items": [{"content": "bd828e2e-5bd4-4569-b6eb-aa1d7db92097", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "0df1adfa-f0d3-409b-afcb-532100a73d39", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "ce7682b7-33ea-4dda-ad50-a348a0cfc29b", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "b9ea231e-323f-40a7-aadd-51483c966228", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "9603dceb-1517-4033-8e6c-bf151e0e7047", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "7adc68f8-a30d-42f5-9dd7-8481e089f11d", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "360cb032-af01-43e3-b57e-9d94a4128707", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "8b2664de-981e-4000-903b-28106b5ab6b9", "element": "field_uuid", "field_type": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "show_if": null, "show_link_header": false, "step_label": null}]}, "name": "send_email_pb", "object_type": "artifact", "status": "draft", "tag": {"display_name": "Playbook_e07483e5-f077-4297-b8eb-10f9ed3fbbe2", "id": 232, "name": "playbook_e07483e5_f077_4297_b8eb_10f9ed3fbbe2", "type": "playbook", "uuid": "bee268f8-58f9-4946-b16d-0f552d1e6485"}, "tags": [], "type": "default", "uuid": "e07483e5-f077-4297-b8eb-10f9ed3fbbe2", "version": 5}, {"activation_type": "manual", "content": {"content_version": 8, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854\" isExecutable=\"true\" name=\"playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_1eva8rw</outgoing></startEvent><serviceTask id=\"ServiceTask_1\" name=\"Outbound Email: Send Email 2\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"bb874b84-b405-40ba-abed-5f7c594f2a99\">{\"inputs\":{\"9f9dde5a-65a6-4e39-81f5-53242747b03b\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"5df194d5-7f42-494b-8bf0-219d6ffc56ee\"}},\"e09789bf-057c-4914-9877-455fb11e3f4d\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"fdbcda16-d6f2-48d1-86d7-804e25890bc1\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"a4bfd9f7-f924-4289-8bb2-fd2e3c577eb4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"124e74e9-a891-442a-b257-7d79b0eeed45\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"3864ba99-ae8c-4926-9b76-9e8e691696f5\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"d343f80b-4760-4f4a-b492-bf85dfc29261\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"c6b538ef-a2e0-49b9-abe3-4a45339db160\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"823bffa7-4f34-4eda-8ba2-7a714d236ad7\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"1f86c63b-9f1e-46e5-a865-66fff55a1af4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"dde2204d-ab55-4817-98de-2013158e7687\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"77ebe14e-2028-4f38-b66e-c3566fdf1425\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"09f822a2-50a3-4556-8af0-e86ad8b072ea\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"e8fa561a-aea1-42f7-8b9e-4615ff4046fa\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}}},\"pre_processing_script\":\"import hashlib\\nimport time\\n\\nMESSAGE_ID_DOMAIN = \\\"&lt;::system.fqdn.com::&gt;\\\"\\nsender_email = '&lt;::sender_email@domain.com::&gt;'\\n\\nsubject = \\\"{0} (ID: {1})\\\".format(incident.name, incident.id) if not playbook.inputs.mail_subject else playbook.inputs.mail_subject + ' (ID: {})'.format(incident.id)\\n\\ninputs.mail_to = playbook.inputs.mail_to\\ninputs.mail_cc = playbook.inputs.mail_cc\\ninputs.mail_encryption_recipients = None\\ninputs.mail_attachments = playbook.inputs.mail_attachments\\ninputs.mail_incident_id = incident.id\\ninputs.mail_from = sender_email\\ninputs.mail_subject = subject\\ninputs.mail_importance = playbook.inputs.mail_importance if playbook.inputs.mail_importance else 'normal'\\n\\nif playbook.inputs.mail_message_id:\\n  # generate a message-id\\n  seed_value = str(int(time.time()*1000))\\n  uuid_hash = hashlib.md5(seed_value.encode()).hexdigest()\\n  msg_id = \\\"{}-{}-{}-{}-{}\\\".format(uuid_hash[0:8], uuid_hash[8:12], uuid_hash[12:16], uuid_hash[16:20], uuid_hash[20:])\\n  inputs.mail_message_id = \\\"{}@{}\\\".format(msg_id, MESSAGE_ID_DOMAIN)\\n  \\nif playbook.inputs.mail_in_reply_to and incident.properties.email_message_id:\\n  inputs.mail_in_reply_to = incident.properties.email_message_id\\n\\nif playbook.inputs.mail_body.content:\\n  inputs.mail_inline_template = \\\"\\\"\\\"&lt;!doctype html&gt;\\n&lt;html&gt;\\n  &lt;head&gt;\\n    &lt;meta name=\\\"viewport\\\" content=\\\"width=device-width\\\" /&gt;\\n    &lt;meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=UTF-8\\\" /&gt;\\n    &lt;title&gt;{0}&lt;/title&gt;\\n    &lt;style&gt;\\n      /* -------------------------------------\\n          GLOBAL RESETS\\n      ------------------------------------- */\\n      \\n      /*All the styling goes here*/\\n      \\n      img {{\\n        border: none;\\n        -ms-interpolation-mode: bicubic;\\n        max-width: 100%; \\n      }}\\n      body {{\\n        background-color: #f6f6f6;\\n        font-family: sans-serif;\\n        -webkit-font-smoothing: antialiased;\\n        font-size: 14px;\\n        line-height: 1.4;\\n        margin: 0;\\n        padding: 0;\\n        -ms-text-size-adjust: 100%;\\n        -webkit-text-size-adjust: 100%; \\n      }}\\n      table {{\\n        border-collapse: separate;\\n        mso-table-lspace: 0pt;\\n        mso-table-rspace: 0pt;\\n        width: 100%; }}\\n        table td {{\\n          font-family: sans-serif;\\n          font-size: 14px;\\n          vertical-align: top; \\n      }}\\n      /* -------------------------------------\\n          BODY &amp; CONTAINER\\n      ------------------------------------- */\\n      .body {{\\n        background-color: #f6f6f6;\\n        width: 100%; \\n      }}\\n      /* Set a max-width, and make it display as block so it will automatically stretch to that width, but will also shrink down on a phone or something */\\n      .container {{\\n        display: block;\\n        margin: 0 auto !important;\\n        /* makes it centered */\\n        max-width: 580px;\\n        padding: 10px;\\n        width: 580px; \\n      }}\\n      /* This should also be a block element, so that it will fill 100% of the .container */\\n      .content {{\\n        box-sizing: border-box;\\n        display: block;\\n        margin: 0 auto;\\n        max-width: 580px;\\n        padding: 10px; \\n      }}\\n      /* -------------------------------------\\n          HEADER, FOOTER, MAIN\\n      ------------------------------------- */\\n      .main {{\\n        background: #ffffff;\\n        border-radius: 3px;\\n        width: 100%; \\n      }}\\n      .wrapper {{\\n        box-sizing: border-box;\\n        padding: 20px; \\n      }}\\n      .content-block {{\\n        padding-bottom: 10px;\\n        padding-top: 10px;\\n      }}\\n      .footer {{\\n        clear: both;\\n        margin-top: 10px;\\n        text-align: center;\\n        width: 100%; \\n      }}\\n        .footer td,\\n        .footer p,\\n        .footer span,\\n        .footer a {{\\n          color: #999999;\\n          font-size: 12px;\\n          text-align: center; \\n      }}\\n      /* -------------------------------------\\n          TYPOGRAPHY\\n      ------------------------------------- */\\n      h1,\\n      h2,\\n      h3,\\n      h4 {{\\n        color: #000000;\\n        font-family: sans-serif;\\n        font-weight: 400;\\n        line-height: 1.4;\\n        margin: 0;\\n        margin-bottom: 30px; \\n      }}\\n      h1 {{\\n        font-size: 35px;\\n        font-weight: 300;\\n        text-align: center;\\n        text-transform: capitalize; \\n      }}\\n      p,\\n      ul,\\n      ol {{\\n        font-family: sans-serif;\\n        font-size: 14px;\\n        font-weight: normal;\\n        margin: 0;\\n        margin-bottom: 15px; \\n      }}\\n        p li,\\n        ul li,\\n        ol li {{\\n          list-style-position: inside;\\n          margin-left: 5px; \\n      }}\\n      a {{\\n        color: #3498db;\\n        text-decoration: underline; \\n      }}\\n      /* -------------------------------------\\n          BUTTONS\\n      ------------------------------------- */\\n      .btn {{\\n        box-sizing: border-box;\\n        width: 100%; }}\\n        .btn &gt; tbody &gt; tr &gt; td {{\\n          padding-bottom: 15px; }}\\n        .btn table {{\\n          width: auto; \\n      }}\\n        .btn table td {{\\n          background-color: #ffffff;\\n          border-radius: 5px;\\n          text-align: center; \\n      }}\\n        .btn a {{\\n          background-color: #ffffff;\\n          border: solid 1px #3498db;\\n          border-radius: 5px;\\n          box-sizing: border-box;\\n          color: #3498db;\\n          cursor: pointer;\\n          display: inline-block;\\n          font-size: 14px;\\n          font-weight: bold;\\n          margin: 0;\\n          padding: 12px 25px;\\n          text-decoration: none;\\n          text-transform: capitalize; \\n      }}\\n      .btn-primary table td {{\\n        background-color: #3498db; \\n      }}\\n      .btn-primary a {{\\n        background-color: #3498db;\\n        border-color: #3498db;\\n        color: #ffffff; \\n      }}\\n      /* -------------------------------------\\n          OTHER STYLES THAT MIGHT BE USEFUL\\n      ------------------------------------- */\\n      .last {{\\n        margin-bottom: 0; \\n      }}\\n      .first {{\\n        margin-top: 0; \\n      }}\\n      .align-center {{\\n        text-align: center; \\n      }}\\n      .align-right {{\\n        text-align: right; \\n      }}\\n      .align-left {{\\n        text-align: left; \\n      }}\\n      .clear {{\\n        clear: both; \\n      }}\\n      .mt0 {{\\n        margin-top: 0; \\n      }}\\n      .mb0 {{\\n        margin-bottom: 0; \\n      }}\\n      .preheader {{\\n        color: transparent;\\n        display: none;\\n        height: 0;\\n        max-height: 0;\\n        max-width: 0;\\n        opacity: 0;\\n        overflow: hidden;\\n        mso-hide: all;\\n        visibility: hidden;\\n        width: 0; \\n      }}\\n      .powered-by a {{\\n        text-decoration: none; \\n      }}\\n      hr {{\\n        border: 0;\\n        border-bottom: 1px solid #f6f6f6;\\n        margin: 20px 0; \\n      }}\\n      /* -------------------------------------\\n          RESPONSIVE AND MOBILE FRIENDLY STYLES\\n      ------------------------------------- */\\n      @media only screen and (max-width: 620px) {{\\n        table[class=body] h1 {{\\n          font-size: 28px !important;\\n          margin-bottom: 10px !important; \\n        }}\\n        table[class=body] p,\\n        table[class=body] ul,\\n        table[class=body] ol,\\n        table[class=body] td,\\n        table[class=body] span,\\n        table[class=body] a {{\\n          font-size: 16px !important; \\n        }}\\n        table[class=body] .wrapper,\\n        table[class=body] .article {{\\n          padding: 10px !important; \\n        }}\\n        table[class=body] .content {{\\n          padding: 0 !important; \\n        }}\\n        table[class=body] .container {{\\n          padding: 0 !important;\\n          width: 100% !important; \\n        }}\\n        table[class=body] .main {{\\n          border-left-width: 0 !important;\\n          border-radius: 0 !important;\\n          border-right-width: 0 !important; \\n        }}\\n        table[class=body] .btn table {{\\n          width: 100% !important; \\n        }}\\n        table[class=body] .btn a {{\\n          width: 100% !important; \\n        }}\\n        table[class=body] .img-responsive {{\\n          height: auto !important;\\n          max-width: 100% !important;\\n          width: auto !important; \\n        }}\\n      }}\\n      /* -------------------------------------\\n          PRESERVE THESE STYLES IN THE HEAD\\n      ------------------------------------- */\\n      @media all {{\\n        .ExternalClass {{\\n          width: 100%; \\n        }}\\n        .ExternalClass,\\n        .ExternalClass p,\\n        .ExternalClass span,\\n        .ExternalClass font,\\n        .ExternalClass td,\\n        .ExternalClass div {{\\n          line-height: 100%; \\n        }}\\n        .apple-link a {{\\n          color: inherit !important;\\n          font-family: inherit !important;\\n          font-size: inherit !important;\\n          font-weight: inherit !important;\\n          line-height: inherit !important;\\n          text-decoration: none !important; \\n        }}\\n        #MessageViewBody a {{\\n          color: inherit;\\n          text-decoration: none;\\n          font-size: inherit;\\n          font-family: inherit;\\n          font-weight: inherit;\\n          line-height: inherit;\\n        }}\\n        .btn-primary table td:hover {{\\n          background-color: #34495e !important; \\n        }}\\n        .btn-primary a:hover {{\\n          background-color: #34495e !important;\\n          border-color: #34495e !important; \\n        }} \\n      }}\\n    &lt;/style&gt;\\n  &lt;/head&gt;\\n  &lt;body class=\\\"\\\"&gt;\\n    &lt;table role=\\\"presentation\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\" class=\\\"body\\\"&gt;\\n      &lt;tr&gt;\\n        &lt;td&gt;&amp;nbsp;&lt;/td&gt;\\n        &lt;td class=\\\"container\\\"&gt;\\n          &lt;div class=\\\"content\\\"&gt;\\n\\n            &lt;!-- START CENTERED WHITE CONTAINER --&gt;\\n            &lt;table role=\\\"presentation\\\" class=\\\"main\\\"&gt;\\n\\n              &lt;!-- START MAIN CONTENT AREA --&gt;\\n              &lt;tr&gt;\\n                &lt;td class=\\\"wrapper\\\"&gt;\\n                  &lt;table role=\\\"presentation\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"&gt;\\n                    &lt;tr&gt;\\n                      &lt;td&gt;\\n                        &lt;p&gt;Hello,&lt;/p&gt;\\n                        &lt;p&gt;{1}&lt;/p&gt;\\n                        &lt;p&gt;Regards,&lt;/p&gt;\\n\\t\\t\\t\\t\\t\\t&lt;p&gt;Cyber Security Team&lt;/p&gt;\\n                      &lt;/td&gt;\\n                    &lt;/tr&gt;\\n                  &lt;/table&gt;\\n                &lt;/td&gt;\\n              &lt;/tr&gt;\\n\\n            &lt;!-- END MAIN CONTENT AREA --&gt;\\n            &lt;/table&gt;\\n            &lt;!-- END CENTERED WHITE CONTAINER --&gt;\\n\\n            &lt;!-- START FOOTER --&gt;\\n            &lt;div class=\\\"footer\\\"&gt;\\n              &lt;table role=\\\"presentation\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"&gt;\\n                &lt;tr&gt;\\n                  &lt;td class=\\\"content-block\\\"&gt;\\n                    &lt;span class=\\\"apple-link\\\"&gt;IBM US&lt;/span&gt;\\n                  &lt;/td&gt;\\n                &lt;/tr&gt;\\n                &lt;tr&gt;\\n                  &lt;td class=\\\"content-block powered-by\\\"&gt;\\n                    Powered by &lt;a href=\\\"https://www.ibm.com/products/qradar-soar\\\" target=\\\"_blank\\\"&gt;IBM SOAR&lt;/a&gt;.\\n                  &lt;/td&gt;\\n                &lt;/tr&gt;\\n              &lt;/table&gt;\\n            &lt;/div&gt;\\n            &lt;!-- END FOOTER --&gt;\\n\\n          &lt;/div&gt;\\n        &lt;/td&gt;\\n        &lt;td&gt;&amp;nbsp;&lt;/td&gt;\\n      &lt;/tr&gt;\\n    &lt;/table&gt;\\n  &lt;/body&gt;\\n&lt;/html&gt;\\n\\\"\\\"\\\".format(subject, playbook.inputs.mail_body.content)\\nelif playbook.inputs.mail_template_select:\\n  inputs.mail_template_label = playbook.inputs.mail_template_select\\nelse:\\n  helper.fail(\\\"Please provide either a template or a messgae in the Body field.\\\")\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"outbound_email_results\"}</resilient:function></extensionElements><incoming>Flow_1eva8rw</incoming><outgoing>Flow_0ulw1h7</outgoing></serviceTask><sequenceFlow id=\"Flow_1eva8rw\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/><scriptTask id=\"ScriptTask_2\" name=\"Save Outbound Email Results\"><extensionElements><resilient:script uuid=\"7744a945-4634-43eb-8558-a3658c865f03\"/></extensionElements><incoming>Flow_0ulw1h7</incoming><outgoing>Flow_10rqudw</outgoing><script>script</script></scriptTask><sequenceFlow id=\"Flow_0ulw1h7\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_10rqudw</incoming></endEvent><sequenceFlow id=\"Flow_10rqudw\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_10rqudw\" id=\"Flow_10rqudw_di\"><omgdi:waypoint x=\"721\" y=\"512\"/><omgdi:waypoint x=\"721\" y=\"624\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_0ulw1h7\" id=\"Flow_0ulw1h7_di\"><omgdi:waypoint x=\"721\" y=\"312\"/><omgdi:waypoint x=\"721\" y=\"428\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1eva8rw\" id=\"Flow_1eva8rw_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"228\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"187.083\" x=\"627\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"228\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"428\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"624\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1698039210261, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "description": {"format": "text", "content": "Send an HTML-formatted email containing Resilient Incident Details in the email body and incident attachments.  A note containing the email details is posted to the incident."}, "display_name": "Send Incident Email (PB)", "export_key": "send_incident_email_pb", "field_type_handle": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "fields_type": {"actions": [], "display_name": "Send Incident Email (PB)", "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "fields": {"mail_attachments": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_attachments", "hide_notification": false, "id": 2187, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_attachments", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Attachments", "tooltip": "comma separated list of attachments for '*' for all", "type_id": 1225, "uuid": "8469758e-ecf0-4301-bdce-dfb196911948", "values": []}, "mail_body": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_body", "hide_notification": false, "id": 2188, "input_type": "textarea", "internal": false, "is_tracked": false, "name": "mail_body", "operation_perms": {}, "operations": [], "placeholder": "If not using a template, place message here.", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Message body", "tooltip": "", "type_id": 1225, "uuid": "f746ad6c-1330-4fc6-8691-e77e7a794b50", "values": []}, "mail_cc": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_cc", "hide_notification": false, "id": 2189, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_cc", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "CC", "tooltip": "", "type_id": 1225, "uuid": "37ff36b7-e4d9-4dc2-9e49-6d8a971e8d14", "values": []}, "mail_importance": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_importance", "hide_notification": false, "id": 2190, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_importance", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Importance", "tooltip": "", "type_id": 1225, "uuid": "ad562782-d697-4fc4-a84f-5c4e87aff76a", "values": [{"default": false, "enabled": true, "hidden": false, "label": "high", "properties": null, "uuid": "f6d47535-fb9e-4992-8539-35d7dddc886d", "value": 1132}, {"default": true, "enabled": true, "hidden": false, "label": "normal", "properties": null, "uuid": "449a6237-01ef-4d98-afb0-104ca334d28f", "value": 1133}, {"default": false, "enabled": true, "hidden": false, "label": "low", "properties": null, "uuid": "95b2d474-029c-485a-9b79-f5234f9427c2", "value": 1134}]}, "mail_in_reply_to": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_in_reply_to", "hide_notification": false, "id": 2191, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_in_reply_to", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Use in-reply-to", "tooltip": "Use the message_id of the original email associated with this incident", "type_id": 1225, "uuid": "3595c32a-a66c-48a5-ada9-859c9b42b73d", "values": []}, "mail_message_id": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_message_id", "hide_notification": false, "id": 2192, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_message_id", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Generate message-id", "tooltip": "generate a message id for this message", "type_id": 1225, "uuid": "7ac328d4-78ca-46f2-ae4b-5027bd603692", "values": []}, "mail_subject": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_subject", "hide_notification": false, "id": 2193, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_subject", "operation_perms": {}, "operations": [], "placeholder": "Empty subject will default to workflow script", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Subject", "tooltip": "", "type_id": 1225, "uuid": "1d4061b1-94a7-4c1d-9a50-bcb242a5255c", "values": []}, "mail_template_select": {"allow_default_value": false, "blank_option": true, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_template_select", "hide_notification": false, "id": 2194, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_template_select", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Template label", "tooltip": "", "type_id": 1225, "uuid": "11a09ef9-7b29-49c4-a65c-379409a4787f", "values": [{"default": false, "enabled": true, "hidden": false, "label": "TemplateName1", "properties": null, "uuid": "983393f3-0fc7-4c28-8556-0e3266b70f8a", "value": 1135}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName2", "properties": null, "uuid": "a2765e5e-6802-4e45-baa4-50acd13e1f6c", "value": 1136}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName3", "properties": null, "uuid": "d086737c-5a08-4ace-b24a-3ac53e80760a", "value": 1137}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName4", "properties": null, "uuid": "d320666b-8a03-45ba-8dcd-34e1aa14e3a7", "value": 1138}]}, "mail_to": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854/mail_to", "hide_notification": false, "id": 2195, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_to", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "required": "always", "rich_text": false, "tags": [], "templates": [], "text": "To", "tooltip": "", "type_id": 1225, "uuid": "1f23f515-d896-44ca-b2e1-4620a18a1aca", "values": []}}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "uuid": "2ab94037-9a78-44ff-ad82-f25805e7591e"}, "has_logical_errors": false, "id": 180, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1698039602945, "local_scripts": [], "manual_settings": {"activation_conditions": {"conditions": [], "logic_type": "all"}, "view_items": [{"content": "1f23f515-d896-44ca-b2e1-4620a18a1aca", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "37ff36b7-e4d9-4dc2-9e49-6d8a971e8d14", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "1d4061b1-94a7-4c1d-9a50-bcb242a5255c", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "f746ad6c-1330-4fc6-8691-e77e7a794b50", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "8469758e-ecf0-4301-bdce-dfb196911948", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "7ac328d4-78ca-46f2-ae4b-5027bd603692", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "3595c32a-a66c-48a5-ada9-859c9b42b73d", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "ad562782-d697-4fc4-a84f-5c4e87aff76a", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "11a09ef9-7b29-49c4-a65c-379409a4787f", "element": "field_uuid", "field_type": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "show_if": null, "show_link_header": false, "step_label": null}]}, "name": "send_incident_email_pb", "object_type": "incident", "status": "draft", "tag": {"display_name": "Playbook_53a9be53-dc16-43ae-b4a6-d6c22fdc5854", "id": 233, "name": "playbook_53a9be53_dc16_43ae_b4a6_d6c22fdc5854", "type": "playbook", "uuid": "5e5c6045-ebff-40f4-a29d-fbf82a9fabf2"}, "tags": [], "type": "default", "uuid": "53a9be53-dc16-43ae-b4a6-d6c22fdc5854", "version": 5}, {"activation_type": "manual", "content": {"content_version": 4, "xml": "<?xml version=\"1.0\" encoding=\"UTF-8\"?><definitions xmlns=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" xmlns:omgdc=\"http://www.omg.org/spec/DD/20100524/DC\" xmlns:omgdi=\"http://www.omg.org/spec/DD/20100524/DI\" xmlns:resilient=\"http://resilient.ibm.com/bpmn\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" targetNamespace=\"http://www.camunda.org/test\"><process id=\"playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2\" isExecutable=\"true\" name=\"playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2\"><documentation/><startEvent id=\"StartEvent_155asxm\"><outgoing>Flow_1bcji4x</outgoing></startEvent><serviceTask id=\"ServiceTask_1\" name=\"Outbound Email: Send Email 2\" resilient:type=\"function\"><extensionElements><resilient:function uuid=\"bb874b84-b405-40ba-abed-5f7c594f2a99\">{\"inputs\":{\"9f9dde5a-65a6-4e39-81f5-53242747b03b\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"select_value\":\"5df194d5-7f42-494b-8bf0-219d6ffc56ee\"}},\"e09789bf-057c-4914-9877-455fb11e3f4d\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"fdbcda16-d6f2-48d1-86d7-804e25890bc1\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"a4bfd9f7-f924-4289-8bb2-fd2e3c577eb4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"124e74e9-a891-442a-b257-7d79b0eeed45\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"3864ba99-ae8c-4926-9b76-9e8e691696f5\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"d343f80b-4760-4f4a-b492-bf85dfc29261\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"c6b538ef-a2e0-49b9-abe3-4a45339db160\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"823bffa7-4f34-4eda-8ba2-7a714d236ad7\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"1f86c63b-9f1e-46e5-a865-66fff55a1af4\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"dde2204d-ab55-4817-98de-2013158e7687\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"77ebe14e-2028-4f38-b66e-c3566fdf1425\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"09f822a2-50a3-4556-8af0-e86ad8b072ea\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}},\"e8fa561a-aea1-42f7-8b9e-4615ff4046fa\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[]}},\"d0ad610c-53ad-4288-a506-c638df53b4d3\":{\"input_type\":\"static\",\"static_input\":{\"multiselect_value\":[],\"text_value\":\"\"}}},\"pre_processing_script\":\"import hashlib\\nimport time\\nfrom datetime import datetime\\n\\nMESSAGE_ID_DOMAIN = \\\"&lt;::system.fqdn.com::&gt;\\\"\\nsender_email = '&lt;::sender_email@domain.com::&gt;'\\n\\nsubject = \\\"{0} [Task: {1}] (ID: {2})\\\".format(incident.name, task.name, incident.id)\\n\\ncreation_date = datetime.fromtimestamp( incident.create_date/1000)\\ntype_ids = u\\\", \\\".join(incident.incident_type_ids)\\nsev_code = u\\\"{}\\\".format(incident.severity_code)\\ncurrent_plan = u\\\"{}\\\".format(incident.plan_status)\\n\\ninputs.mail_to = playbook.inputs.mail_to\\ninputs.mail_cc = playbook.inputs.mail_cc\\ninputs.mail_encryption_recipients = None\\ninputs.mail_attachments = playbook.inputs.mail_attachments\\ninputs.mail_incident_id = incident.id\\ninputs.mail_from = sender_email\\ninputs.mail_subject = subject\\ninputs.mail_importance = playbook.inputs.mail_importance if playbook.inputs.mail_importance else 'normal'\\n\\nif playbook.inputs.mail_message_id:\\n  # generate a message-id\\n  seed_value = str(int(time.time()*1000))\\n  uuid_hash = hashlib.md5(seed_value.encode()).hexdigest()\\n  msg_id = \\\"{}-{}-{}-{}-{}\\\".format(uuid_hash[0:8], uuid_hash[8:12], uuid_hash[12:16], uuid_hash[16:20], uuid_hash[20:])\\n  inputs.mail_message_id = \\\"{}@{}\\\".format(msg_id, MESSAGE_ID_DOMAIN)\\n  \\nif playbook.inputs.mail_in_reply_to and incident.properties.email_message_id:\\n  inputs.mail_in_reply_to = incident.properties.email_message_id\\n\\nif playbook.inputs.mail_body.content:\\n  inputs.mail_inline_template = \\\"\\\"\\\"&lt;!doctype html&gt;\\n&lt;html&gt;\\n  &lt;head&gt;\\n    &lt;meta name=\\\"viewport\\\" content=\\\"width=device-width\\\" /&gt;\\n    &lt;meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=UTF-8\\\" /&gt;\\n    &lt;title&gt;{0}&lt;/title&gt;\\n    &lt;style&gt;\\n      /* -------------------------------------\\n          GLOBAL RESETS\\n      ------------------------------------- */\\n      \\n      /*All the styling goes here*/\\n      \\n      img {{\\n        border: none;\\n        -ms-interpolation-mode: bicubic;\\n        max-width: 100%; \\n      }}\\n      body {{\\n        background-color: #f6f6f6;\\n        font-family: sans-serif;\\n        -webkit-font-smoothing: antialiased;\\n        font-size: 14px;\\n        line-height: 1.4;\\n        margin: 0;\\n        padding: 0;\\n        -ms-text-size-adjust: 100%;\\n        -webkit-text-size-adjust: 100%; \\n      }}\\n      table {{\\n        border-collapse: separate;\\n        mso-table-lspace: 0pt;\\n        mso-table-rspace: 0pt;\\n        width: 100%; }}\\n        table td {{\\n          font-family: sans-serif;\\n          font-size: 14px;\\n          vertical-align: top; \\n      }}\\n      /* -------------------------------------\\n          BODY &amp; CONTAINER\\n      ------------------------------------- */\\n      .body {{\\n        background-color: #f6f6f6;\\n        width: 100%; \\n      }}\\n      /* Set a max-width, and make it display as block so it will automatically stretch to that width, but will also shrink down on a phone or something */\\n      .container {{\\n        display: block;\\n        margin: 0 auto !important;\\n        /* makes it centered */\\n        max-width: 580px;\\n        padding: 10px;\\n        width: 580px; \\n      }}\\n      /* This should also be a block element, so that it will fill 100% of the .container */\\n      .content {{\\n        box-sizing: border-box;\\n        display: block;\\n        margin: 0 auto;\\n        max-width: 580px;\\n        padding: 10px; \\n      }}\\n      /* -------------------------------------\\n          HEADER, FOOTER, MAIN\\n      ------------------------------------- */\\n      .main {{\\n        background: #ffffff;\\n        border-radius: 3px;\\n        width: 100%; \\n      }}\\n      .wrapper {{\\n        box-sizing: border-box;\\n        padding: 20px; \\n      }}\\n      .content-block {{\\n        padding-bottom: 10px;\\n        padding-top: 10px;\\n      }}\\n      .footer {{\\n        clear: both;\\n        margin-top: 10px;\\n        text-align: center;\\n        width: 100%; \\n      }}\\n        .footer td,\\n        .footer p,\\n        .footer span,\\n        .footer a {{\\n          color: #999999;\\n          font-size: 12px;\\n          text-align: center; \\n      }}\\n      /* -------------------------------------\\n          TYPOGRAPHY\\n      ------------------------------------- */\\n      h1,\\n      h2,\\n      h3,\\n      h4 {{\\n        color: #000000;\\n        font-family: sans-serif;\\n        font-weight: 400;\\n        line-height: 1.4;\\n        margin: 0;\\n        margin-bottom: 30px; \\n      }}\\n      h1 {{\\n        font-size: 35px;\\n        font-weight: 300;\\n        text-align: center;\\n        text-transform: capitalize; \\n      }}\\n      p,\\n      ul,\\n      ol {{\\n        font-family: sans-serif;\\n        font-size: 14px;\\n        font-weight: normal;\\n        margin: 0;\\n        margin-bottom: 15px; \\n      }}\\n        p li,\\n        ul li,\\n        ol li {{\\n          list-style-position: inside;\\n          margin-left: 5px; \\n      }}\\n      a {{\\n        color: #3498db;\\n        text-decoration: underline; \\n      }}\\n      /* -------------------------------------\\n          BUTTONS\\n      ------------------------------------- */\\n      .btn {{\\n        box-sizing: border-box;\\n        width: 100%; }}\\n        .btn &gt; tbody &gt; tr &gt; td {{\\n          padding-bottom: 15px; }}\\n        .btn table {{\\n          width: auto; \\n      }}\\n        .btn table td {{\\n          background-color: #ffffff;\\n          border-radius: 5px;\\n          text-align: center; \\n      }}\\n        .btn a {{\\n          background-color: #ffffff;\\n          border: solid 1px #3498db;\\n          border-radius: 5px;\\n          box-sizing: border-box;\\n          color: #3498db;\\n          cursor: pointer;\\n          display: inline-block;\\n          font-size: 14px;\\n          font-weight: bold;\\n          margin: 0;\\n          padding: 12px 25px;\\n          text-decoration: none;\\n          text-transform: capitalize; \\n      }}\\n      .btn-primary table td {{\\n        background-color: #3498db; \\n      }}\\n      .btn-primary a {{\\n        background-color: #3498db;\\n        border-color: #3498db;\\n        color: #ffffff; \\n      }}\\n      /* -------------------------------------\\n          OTHER STYLES THAT MIGHT BE USEFUL\\n      ------------------------------------- */\\n      .last {{\\n        margin-bottom: 0; \\n      }}\\n      .first {{\\n        margin-top: 0; \\n      }}\\n      .align-center {{\\n        text-align: center; \\n      }}\\n      .align-right {{\\n        text-align: right; \\n      }}\\n      .align-left {{\\n        text-align: left; \\n      }}\\n      .clear {{\\n        clear: both; \\n      }}\\n      .mt0 {{\\n        margin-top: 0; \\n      }}\\n      .mb0 {{\\n        margin-bottom: 0; \\n      }}\\n      .preheader {{\\n        color: transparent;\\n        display: none;\\n        height: 0;\\n        max-height: 0;\\n        max-width: 0;\\n        opacity: 0;\\n        overflow: hidden;\\n        mso-hide: all;\\n        visibility: hidden;\\n        width: 0; \\n      }}\\n      .powered-by a {{\\n        text-decoration: none; \\n      }}\\n      hr {{\\n        border: 0;\\n        border-bottom: 1px solid #f6f6f6;\\n        margin: 20px 0; \\n      }}\\n      /* -------------------------------------\\n          RESPONSIVE AND MOBILE FRIENDLY STYLES\\n      ------------------------------------- */\\n      @media only screen and (max-width: 620px) {{\\n        table[class=body] h1 {{\\n          font-size: 28px !important;\\n          margin-bottom: 10px !important; \\n        }}\\n        table[class=body] p,\\n        table[class=body] ul,\\n        table[class=body] ol,\\n        table[class=body] td,\\n        table[class=body] span,\\n        table[class=body] a {{\\n          font-size: 16px !important; \\n        }}\\n        table[class=body] .wrapper,\\n        table[class=body] .article {{\\n          padding: 10px !important; \\n        }}\\n        table[class=body] .content {{\\n          padding: 0 !important; \\n        }}\\n        table[class=body] .container {{\\n          padding: 0 !important;\\n          width: 100% !important; \\n        }}\\n        table[class=body] .main {{\\n          border-left-width: 0 !important;\\n          border-radius: 0 !important;\\n          border-right-width: 0 !important; \\n        }}\\n        table[class=body] .btn table {{\\n          width: 100% !important; \\n        }}\\n        table[class=body] .btn a {{\\n          width: 100% !important; \\n        }}\\n        table[class=body] .img-responsive {{\\n          height: auto !important;\\n          max-width: 100% !important;\\n          width: auto !important; \\n        }}\\n      }}\\n      /* -------------------------------------\\n          PRESERVE THESE STYLES IN THE HEAD\\n      ------------------------------------- */\\n      @media all {{\\n        .ExternalClass {{\\n          width: 100%; \\n        }}\\n        .ExternalClass,\\n        .ExternalClass p,\\n        .ExternalClass span,\\n        .ExternalClass font,\\n        .ExternalClass td,\\n        .ExternalClass div {{\\n          line-height: 100%; \\n        }}\\n        .apple-link a {{\\n          color: inherit !important;\\n          font-family: inherit !important;\\n          font-size: inherit !important;\\n          font-weight: inherit !important;\\n          line-height: inherit !important;\\n          text-decoration: none !important; \\n        }}\\n        #MessageViewBody a {{\\n          color: inherit;\\n          text-decoration: none;\\n          font-size: inherit;\\n          font-family: inherit;\\n          font-weight: inherit;\\n          line-height: inherit;\\n        }}\\n        .btn-primary table td:hover {{\\n          background-color: #34495e !important; \\n        }}\\n        .btn-primary a:hover {{\\n          background-color: #34495e !important;\\n          border-color: #34495e !important; \\n        }} \\n      }}\\n    &lt;/style&gt;\\n  &lt;/head&gt;\\n  &lt;body class=\\\"\\\"&gt;\\n    &lt;table role=\\\"presentation\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\" class=\\\"body\\\"&gt;\\n      &lt;tr&gt;\\n        &lt;td&gt;&amp;nbsp;&lt;/td&gt;\\n        &lt;td class=\\\"container\\\"&gt;\\n          &lt;div class=\\\"content\\\"&gt;\\n\\n            &lt;!-- START CENTERED WHITE CONTAINER --&gt;\\n            &lt;table role=\\\"presentation\\\" class=\\\"main\\\"&gt;\\n\\n              &lt;!-- START MAIN CONTENT AREA --&gt;\\n              &lt;tr&gt;\\n                &lt;td class=\\\"wrapper\\\"&gt;\\n                  &lt;table role=\\\"presentation\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"&gt;\\n                    &lt;tr&gt;\\n                      &lt;td&gt;\\n                        &lt;h2&gt;Incident Summary&lt;/h2&gt;\\n                          Severity Code: {1}\\n                          &lt;br&gt;\\n                          Plan Status: {2}\\n                          &lt;br&gt;\\n                          Created: {3}\\n                          &lt;br&gt;\\n                          Incident Type: {4}\\n                          &lt;br&gt;\\n                          Incident Link: &lt;a target='_blank' href='{{{{ template_helper.generate_incident_url({6}) }}}}'&gt;{6}&lt;/a&gt;\\n                          &lt;br&gt;\\n                          Task: &lt;a target='_blank' href='{{{{ template_helper.generate_task_url({6},{7}) }}}}'&gt;{5}&lt;/a&gt;\\n                          &lt;br&gt;\\n                          Instructions: \\n                          &lt;br&gt;\\n                          {8}\\n                      &lt;/td&gt;\\n                    &lt;/tr&gt;\\n                  &lt;/table&gt;\\n                &lt;/td&gt;\\n              &lt;/tr&gt;\\n\\n            &lt;!-- END MAIN CONTENT AREA --&gt;\\n            &lt;/table&gt;\\n            &lt;!-- END CENTERED WHITE CONTAINER --&gt;\\n\\n            &lt;!-- START FOOTER --&gt;\\n            &lt;div class=\\\"footer\\\"&gt;\\n              &lt;table role=\\\"presentation\\\" border=\\\"0\\\" cellpadding=\\\"0\\\" cellspacing=\\\"0\\\"&gt;\\n                &lt;tr&gt;\\n                  &lt;td class=\\\"content-block\\\"&gt;\\n                    &lt;span class=\\\"apple-link\\\"&gt;IBM US&lt;/span&gt;\\n                  &lt;/td&gt;\\n                &lt;/tr&gt;\\n                &lt;tr&gt;\\n                  &lt;td class=\\\"content-block powered-by\\\"&gt;\\n                    Powered by &lt;a href=\\\"https://www.ibm.com/products/qradar-soar\\\" target=\\\"_blank\\\"&gt;IBM SOAR&lt;/a&gt;.\\n                  &lt;/td&gt;\\n                &lt;/tr&gt;\\n              &lt;/table&gt;\\n            &lt;/div&gt;\\n            &lt;!-- END FOOTER --&gt;\\n\\n          &lt;/div&gt;\\n        &lt;/td&gt;\\n        &lt;td&gt;&amp;nbsp;&lt;/td&gt;\\n      &lt;/tr&gt;\\n    &lt;/table&gt;\\n  &lt;/body&gt;\\n&lt;/html&gt;\\n\\\"\\\"\\\".format(subject, sev_code, current_plan, creation_date, type_ids, task.name, incident.id, task.id, task.instructions.get(\\\"content\\\") if task.instructions else '-')\\nelif playbook.inputs.mail_template_select:\\n  inputs.mail_template_label = playbook.inputs.mail_template_select\\nelse:\\n  helper.fail(\\\"Please provide either a template or a messgae in the Body field.\\\")\\n\",\"pre_processing_script_language\":\"python3\",\"result_name\":\"outbound_email_results\"}</resilient:function></extensionElements><incoming>Flow_1bcji4x</incoming><outgoing>Flow_1c97lz8</outgoing></serviceTask><sequenceFlow id=\"Flow_1bcji4x\" sourceRef=\"StartEvent_155asxm\" targetRef=\"ServiceTask_1\"/><scriptTask id=\"ScriptTask_2\" name=\"Save Outbound Email Results\"><extensionElements><resilient:script uuid=\"7744a945-4634-43eb-8558-a3658c865f03\"/></extensionElements><incoming>Flow_1c97lz8</incoming><outgoing>Flow_0bzx0c5</outgoing><script>script</script></scriptTask><sequenceFlow id=\"Flow_1c97lz8\" sourceRef=\"ServiceTask_1\" targetRef=\"ScriptTask_2\"/><endEvent id=\"EndPoint_3\" resilient:documentation=\"End point\"><incoming>Flow_0bzx0c5</incoming></endEvent><sequenceFlow id=\"Flow_0bzx0c5\" sourceRef=\"ScriptTask_2\" targetRef=\"EndPoint_3\"/></process><bpmndi:BPMNDiagram id=\"BPMNDiagram_1\"><bpmndi:BPMNPlane bpmnElement=\"playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2\" id=\"BPMNPlane_1\"><bpmndi:BPMNEdge bpmnElement=\"Flow_0bzx0c5\" id=\"Flow_0bzx0c5_di\"><omgdi:waypoint x=\"721\" y=\"462\"/><omgdi:waypoint x=\"721\" y=\"544\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1c97lz8\" id=\"Flow_1c97lz8_di\"><omgdi:waypoint x=\"721\" y=\"292\"/><omgdi:waypoint x=\"721\" y=\"378\"/></bpmndi:BPMNEdge><bpmndi:BPMNEdge bpmnElement=\"Flow_1bcji4x\" id=\"Flow_1bcji4x_di\"><omgdi:waypoint x=\"721\" y=\"117\"/><omgdi:waypoint x=\"721\" y=\"208\"/></bpmndi:BPMNEdge><bpmndi:BPMNShape bpmnElement=\"StartEvent_155asxm\" id=\"StartEvent_155asxm_di\"><omgdc:Bounds height=\"52\" width=\"161.48329999999999\" x=\"640\" y=\"65\"/><bpmndi:BPMNLabel><omgdc:Bounds height=\"0\" width=\"90\" x=\"616\" y=\"100\"/></bpmndi:BPMNLabel></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ServiceTask_1\" id=\"ServiceTask_1_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"208\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"ScriptTask_2\" id=\"ScriptTask_2_di\"><omgdc:Bounds height=\"84\" width=\"196\" x=\"623\" y=\"378\"/></bpmndi:BPMNShape><bpmndi:BPMNShape bpmnElement=\"EndPoint_3\" id=\"EndPoint_3_di\"><omgdc:Bounds height=\"52\" width=\"132.15\" x=\"655\" y=\"544\"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></definitions>"}, "create_date": 1698039236516, "creator_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "deployment_id": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2", "description": {"format": "text", "content": "Send email based on a task with optional attachments"}, "display_name": "Send Task Status (PB)", "export_key": "send_task_status_pb", "field_type_handle": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2", "fields_type": {"actions": [], "display_name": "Send Task Status (PB)", "export_key": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2", "fields": {"mail_attachments": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2/mail_attachments", "hide_notification": false, "id": 2203, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_attachments", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Attachments", "tooltip": "comma separated list of attachments for '*' for all", "type_id": 1227, "uuid": "22b64094-be8c-4f2a-b822-901aa03e93c1", "values": []}, "mail_cc": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2/mail_cc", "hide_notification": false, "id": 2204, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_cc", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "CC", "tooltip": "", "type_id": 1227, "uuid": "a50da7cf-320f-4952-b124-4cddeaa034eb", "values": []}, "mail_importance": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2/mail_importance", "hide_notification": false, "id": 2205, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_importance", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Importance", "tooltip": "", "type_id": 1227, "uuid": "ea3a4362-96f1-4dff-a1e6-f109c37394ae", "values": [{"default": false, "enabled": true, "hidden": false, "label": "high", "properties": null, "uuid": "a68fbd3d-9a89-47fe-85d2-8831938e417d", "value": 1146}, {"default": true, "enabled": true, "hidden": false, "label": "normal", "properties": null, "uuid": "94901cca-6a7b-4268-85fd-5d7ee80ead83", "value": 1147}, {"default": false, "enabled": true, "hidden": false, "label": "low", "properties": null, "uuid": "137201ac-4ed8-45a8-8575-0bf27ac87691", "value": 1148}]}, "mail_in_reply_to": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2/mail_in_reply_to", "hide_notification": false, "id": 2206, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_in_reply_to", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Use in-reply-to", "tooltip": "Use the message_id of the original email associated with this incident", "type_id": 1227, "uuid": "db9ef5f4-26fb-4e84-bd38-c745c4dc1ad2", "values": []}, "mail_message_id": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2/mail_message_id", "hide_notification": false, "id": 2207, "input_type": "boolean", "internal": false, "is_tracked": false, "name": "mail_message_id", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Generate message-id", "tooltip": "generate a message id for this message", "type_id": 1227, "uuid": "b4fb5225-7cae-4125-ac95-318e3cfb4374", "values": []}, "mail_template_select": {"allow_default_value": false, "blank_option": true, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2/mail_template_select", "hide_notification": false, "id": 2208, "input_type": "select", "internal": false, "is_tracked": false, "name": "mail_template_select", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "Template label", "tooltip": "", "type_id": 1227, "uuid": "bbec7a5e-a947-4a4e-abed-166e556f8de4", "values": [{"default": false, "enabled": true, "hidden": false, "label": "TemplateName1", "properties": null, "uuid": "d884a4c6-b267-424a-95e3-f3ffb7ee51e5", "value": 1149}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName2", "properties": null, "uuid": "f0abbe64-c456-4c0d-8b26-8044c468066f", "value": 1150}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName3", "properties": null, "uuid": "eb452b25-ef8e-42dd-8d17-959244f36b31", "value": 1151}, {"default": false, "enabled": true, "hidden": false, "label": "TemplateName4", "properties": null, "uuid": "d4974e5b-7f31-4f42-b948-9bce30f7624f", "value": 1152}]}, "mail_to": {"allow_default_value": false, "blank_option": false, "calculated": false, "changeable": true, "chosen": false, "default_chosen_by_server": false, "deprecated": false, "export_key": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2/mail_to", "hide_notification": false, "id": 2209, "input_type": "text", "internal": false, "is_tracked": false, "name": "mail_to", "operation_perms": {}, "operations": [], "placeholder": "", "prefix": null, "read_only": false, "rich_text": false, "tags": [], "templates": [], "text": "To", "tooltip": "", "type_id": 1227, "uuid": "30725019-94af-4fec-a4eb-25d67922a069", "values": []}}, "for_actions": false, "for_custom_fields": false, "for_notifications": false, "for_workflows": false, "id": null, "parent_types": ["__playbook"], "properties": {"can_create": false, "can_destroy": false, "for_who": []}, "scripts": [], "tags": [], "type_id": 28, "type_name": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2", "uuid": "ed13b16e-2f3e-41e6-9dac-cf04b6fbe290"}, "has_logical_errors": false, "id": 182, "is_deleted": false, "is_locked": false, "last_modified_principal": {"display_name": "John Doe", "id": 1, "name": "john_doe@company.com", "type": "user"}, "last_modified_time": 1698039556116, "local_scripts": [], "manual_settings": {"activation_conditions": {"conditions": [], "logic_type": "all"}, "view_items": [{"content": "30725019-94af-4fec-a4eb-25d67922a069", "element": "field_uuid", "field_type": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "a50da7cf-320f-4952-b124-4cddeaa034eb", "element": "field_uuid", "field_type": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "22b64094-be8c-4f2a-b822-901aa03e93c1", "element": "field_uuid", "field_type": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "b4fb5225-7cae-4125-ac95-318e3cfb4374", "element": "field_uuid", "field_type": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "db9ef5f4-26fb-4e84-bd38-c745c4dc1ad2", "element": "field_uuid", "field_type": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "ea3a4362-96f1-4dff-a1e6-f109c37394ae", "element": "field_uuid", "field_type": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2", "show_if": null, "show_link_header": false, "step_label": null}, {"content": "bbec7a5e-a947-4a4e-abed-166e556f8de4", "element": "field_uuid", "field_type": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2", "show_if": null, "show_link_header": false, "step_label": null}]}, "name": "send_task_status_pb", "object_type": "task", "status": "draft", "tag": {"display_name": "Playbook_439fb474-5adf-4d61-b5b3-cce1a3acb6f2", "id": 235, "name": "playbook_439fb474_5adf_4d61_b5b3_cce1a3acb6f2", "type": "playbook", "uuid": "61bc0281-08d4-484b-95fe-112f7fddc84e"}, "tags": [], "type": "default", "uuid": "439fb474-5adf-4d61-b5b3-cce1a3acb6f2", "version": 5}], "regulators": null, "roles": [], "scripts": [{"actions": [], "created_date": 1691476466448, "description": "Email Parsing script to apply responses from outbound emails back to incidents for conversation tracking.", "enabled": false, "export_key": "Conversations Email Parser", "id": 113, "language": "python3", "last_modified_by": "john_doe@company.com", "last_modified_time": 1691476466471, "name": "Conversations Email Parser", "object_type": "__emailmessage", "playbook_handle": null, "programmatic_name": "conversations_email_parser", "script_text": "import re\nfrom datetime import datetime\n\n\n# Create Functions for handling data.\ndef readable_date(res_date_time):\n    ep_date_time = res_date_time / 1000.0\n    readable_date_time = datetime.fromtimestamp(ep_date_time).strftime('%Y-%m-%d %H:%M:%S')\n    return(readable_date_time)\n\n\n# Parses out email information.\nemail_headers = emailmessage.headers\nemail_sender = emailmessage.sender\nemail_to = emailmessage.to\nemail_cc = emailmessage.cc\nemail_subject = emailmessage.subject\nemail_sent = emailmessage.sent_date\nemail_received = emailmessage.received_date\nemail_body = emailmessage.body\nemail_attachments = emailmessage.attachments\n\n\n# Establish Incident Association.\nid_regex = re.compile(r'\\(ID: (\\d+)\\)')\nincident_id = re.findall(id_regex, email_subject)\n\nif incident_id:\n    query_builder.equals(fields.incident.id, int(incident_id[0]))\n    query = query_builder.build()\n    incidents = helper.findIncidents(query)\n    emailmessage.associateWithIncident(incidents[0])\n    \nelse:\n    emailmessage.createAssociatedIncident(email_subject,'Tier 1 Analysts')\n    # Add Additional Artifacts from Email.\n    for recipient in email_to + email_cc:\n        incident.addArtifact('Email Recipient', recipient.address, \"Email Recipient Received by SOAR\")\n    incident.addArtifact('Email Sender', email_sender.address, \"Email Sender Received by SOAR\")\n    if email_sender.name:\n        incident.addArtifact('Email Sender Name', email_sender.name, \"Email Sender Received by SOAR\")\n    incident.addArtifact('Email Subject', email_subject, \"Email Subject Received by SOAR\")\n\n\n# Define Sender, To, and From in a email output fashion.\nif email_sender.get('name') and email_sender.get('name') != email_sender.address:\n    sender = \"{}: <{}>\".format(email_sender.name, email_sender.address)\nelse:\n    sender = email_sender.address\n\nif email_to:\n    to = ''\n    for recipient_to in email_to:\n        if recipient_to.get('name') and recipient_to.get('name') != recipient_to.address:\n            to = to + \"{}: <{}>\\n\".format(name=recipient_to.name, email=recipient_to.address)\n        else:\n            to = to + \"{}\\n\".format(recipient_to.address)\nelse:\n    to = 'None'\n\nif email_cc:\n    cc = ''\n    for recipient_cc in email_cc:\n        if recipient_cc.get('name') and recipient_cc.get('name') != recipient_cc.address:\n            cc = cc + \"{}: <{}>\\n\".format(recipient_cc.name,recipient_cc.address)\n        else:\n            cc = cc + \"{}\\n\".format(recipient_cc.address)\nelse:\n    cc = 'None'\n\n\n# Parse Out Attachments.\nattachments_list = []\nif email_attachments:\n    for attachment in email_attachments:\n        if not attachment.inline:\n            incident.addEmailAttachment(attachment.id)\n            attachments_list.append(attachment.suggested_filename)\n            incident.addArtifact('Email Attachment Name', attachment.suggested_filename, \"Name of Attachment received in Email.\")\n\n\n\n# Generate a new Row for Email Conversation.\nnewRow = incident.addRow('email_conversations')\nnewRow['date_sent'] = email_received\nnewRow['status'] = 'success'\nnewRow['source'] = 'inbound'\nnewRow['inbound_id'] = emailmessage.id\nnewRow['from'] = sender\nnewRow['recipients'] = \"To: {}\\nCC: {}\".format(to, cc)\nnewRow['subject'] = email_subject\nnewRow['body'] = email_body['content'].split('From: SOAR')[0]\nnewRow['attachments'] = \",\\n\".join(attachments_list)\nnewRow['message_id'] = email_headers.get('Message-ID')[0][1:-1]\n\n\n\n# Apply the Email as a Note.\nnote = \"Email Received On: {}\\nSender: {}\\nRecipient(s): {}CC: {}\\nSubject: {}\\n\\n\".format(readable_date(email_received),sender,to,cc,email_subject) + email_body['content'].split('From: SOAR')[0]\nrich_note = helper.createRichText(note)\n\nincident.addNote(rich_note)\n", "tags": [], "uuid": "352b9e98-e69d-47f2-9d04-fd174d6e96f9"}, {"actions": [], "created_date": 1691420986120, "description": "Save outbound email results in the Email Conversations datatable", "enabled": false, "export_key": "Save Outbound Email Results", "id": 104, "language": "python3", "last_modified_by": "john_doe@company.com", "last_modified_time": 1691420986210, "name": "Save Outbound Email Results", "object_type": "incident", "playbook_handle": null, "programmatic_name": "save_outbound_email_results", "script_text": "import time\n\ntry:\n  e_results = workflow.properties.outbound_email_results\nexcept:\n  try:\n    e_results = playbook.functions.results.outbound_email_results\n  except:\n    helper.fail(\"unable to read outbound_email_results property\")\n\nif e_results:\n  row = incident.addRow('email_conversations')\n  row['status'] = \"success\" if e_results.get('success') else \"failure: {}\".format(e_results.get('reason'))\n  \n  row['date_sent'] = int(time.time()*1000)\n  row['source'] = \"outbound\"\n  row['recipients'] = helper.createRichText(\"To: {}<br>Cc: {}<br>Bcc: {}\".format(e_results.get('inputs', {}).get('mail_to'), e_results.get('inputs', {}).get('mail_cc', ''), e_results.get('inputs', {}).get('mail_bcc', '')))\n  row['from'] = e_results.get('content', {}).get('mail_from') if e_results.get('content', {}).get('mail_from') else e_results.get('inputs', {}).get('mail_from')\n  row['subject'] = e_results.get('inputs', {}).get('mail_subject')\n  row['body'] = e_results.get('content', {}).get('mail_body')\n  row['attachments'] = e_results.get('inputs', {}).get('mail_attachments')\n  row['importance'] = e_results.get('inputs', {}).get('mail_importance')\n  row['in_reply_to'] = e_results.get('inputs', {}).get('mail_in_reply_to')\n  row['message_id'] = e_results.get('inputs', {}).get('mail_message_id')\nelse:\n  incident.addNote(\"workflow/playbook properties 'outbound_email_results' not found\")\n  ", "tags": [], "uuid": "7744a945-4634-43eb-8558-a3658c865f03"}], "server_version": {"build_number": 8131, "major": 46, "minor": 0, "version": "46.0.8131"}, "tags": [], "task_order": [], "timeframes": null, "types": [], "workflows": [], "workspaces": []}